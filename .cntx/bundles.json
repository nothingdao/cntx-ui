{
  "master": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"master\" generated=\"2025-06-18T12:10:52.664Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"44\">\n    <cntx:file path=\"README.md\" ext=\".md\">\n      <cntx:meta size=\"4970\" modified=\"2025-06-18T11:45:07.370Z\" />\n      <cntx:content><![CDATA[# cntx-ui\n\nMinimal file bundling and tagging tool for AI development with web interface.\n\n## Features\n\n- File bundling and organization for AI development workflows\n- Web-based UI for managing bundles and configurations\n- Hidden files management\n- Cursor rules integration\n- WebSocket-based real-time updates\n- CLI tools for automation\n\n## Installation\n\n### Global Installation (Recommended)\n\n```bash\nnpm install -g cntx-ui\n```\n\n### Local Development Installation\n\n```bash\ngit clone https://github.com/nothingdao/cntx-ui.git\ncd cntx-ui\nnpm install\n```\n\n## Usage\n\n### Initialize a Project\n\n```bash\n# Initialize cntx-ui in your project\ncntx-ui init\n\n# Start the web interface\ncntx-ui watch\n\n# Visit http://localhost:3333 to access the web UI\n```\n\n### CLI Commands\n\n```bash\n# Generate bundles\ncntx-ui bundle <name>\n\n# Check project status\ncntx-ui status\n\n# Start web server on custom port\ncntx-ui watch [port]\n```\n\n## Development\n\n### Prerequisites\n\n- Node.js >= 18.0.0\n- npm\n\n### Setup Development Environment\n\n1. **Clone and install dependencies:**\n   ```bash\n   git clone https://github.com/nothingdao/cntx-ui.git\n   cd cntx-ui\n   npm install\n   ```\n\n2. **Install web dependencies:**\n   ```bash\n   cd web\n   npm install\n   cd ..\n   ```\n\n### Development Workflow\n\n#### Running in Development Mode\n\n1. **Start the backend server:**\n   ```bash\n   npm run dev\n   ```\n\n2. **Start the frontend development server:**\n   ```bash\n   npm run dev:web\n   ```\n   \n   The web interface will be available at `http://localhost:5173` (Vite dev server)\n\n#### Building the Project\n\n1. **Build web interface only:**\n   ```bash\n   npm run build:web\n   ```\n\n2. **Build entire project:**\n   ```bash\n   npm run build\n   ```\n\n3. **Automated build with validation:**\n   ```bash\n   ./build.sh\n   ```\n\n### Project Structure\n\n```\ncntx-ui/\n├── bin/                    # CLI executable\n├── web/                    # React frontend\n│   ├── src/\n│   │   ├── components/     # React components\n│   │   ├── hooks/          # Custom hooks\n│   │   ├── utils/          # Utility functions\n│   │   └── lib/            # Libraries and configurations\n│   ├── dist/               # Built frontend (generated)\n│   └── package.json        # Frontend dependencies\n├── server.js               # WebSocket server\n├── package.json            # Main package configuration\n├── build.sh                # Build automation script\n└── test-local.sh           # Local testing script\n```\n\n### Available Scripts\n\n| Script | Description |\n|--------|-------------|\n| `npm run dev` | Start backend server |\n| `npm run dev:web` | Start frontend dev server |\n| `npm run build` | Build entire project |\n| `npm run build:web` | Build frontend only |\n| `npm test:local` | Install and test package locally |\n\n## Testing\n\n### Local Testing\n\n1. **Run automated test suite:**\n   ```bash\n   ./test-local.sh\n   ```\n\n2. **Manual testing:**\n   ```bash\n   # Build and pack\n   npm run build\n   npm pack\n   \n   # Install globally for testing\n   npm install -g ./cntx-ui-*.tgz\n   \n   # Test in a new project\n   mkdir test-project && cd test-project\n   cntx-ui init\n   cntx-ui watch\n   ```\n\n### Test Coverage\n\nThe test suite covers:\n- Project initialization\n- Bundle generation\n- Web server functionality\n- API endpoints\n- File management operations\n\n## Publishing\n\n### Prerequisites for Publishing\n\n- npm account with publish permissions\n- Clean git working directory\n- All tests passing\n\n### Publishing Steps\n\n1. **Update version:**\n   ```bash\n   npm version patch  # or minor/major\n   ```\n\n2. **Build and validate:**\n   ```bash\n   ./build.sh\n   ```\n\n3. **Test locally:**\n   ```bash\n   ./test-local.sh\n   ```\n\n4. **Publish to npm:**\n   ```bash\n   # Stable release\n   npm publish\n   \n   # Beta release\n   npm publish --tag beta\n   ```\n\n### Automated Publishing Workflow\n\nUse the build script for a complete workflow:\n\n```bash\n./build.sh\n# Follow prompts for local testing\n# If tests pass, run: npm publish\n```\n\n## Configuration\n\n### Environment Variables\n\n- `PORT` - Override default server port (default: 3333)\n- `NODE_ENV` - Set environment (development/production)\n\n### Project Configuration\n\ncntx-ui creates these files in your project:\n- `.cntx/config.json` - Main configuration\n- `.cntxignore` - Files to ignore\n- `.cursorrules` - Cursor editor rules\n\n## Contributing\n\n1. Fork the repository\n2. Create a feature branch\n3. Make changes following the existing code style\n4. Run tests: `./test-local.sh`\n5. Submit a pull request\n\n## Technology Stack\n\n- **Backend:** Node.js, WebSocket (ws)\n- **Frontend:** React 19, TypeScript, Vite\n- **UI:** Tailwind CSS, Radix UI\n- **State Management:** TanStack Query\n- **Build Tools:** Vite, TypeScript compiler\n\n## License\n\nMIT\n\n## Support\n\n- GitHub Issues: [Report bugs or request features](https://github.com/nothingdao/cntx-ui/issues)\n- Documentation: Check the web interface for detailed usage guides\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"bin/cntx-ui.js\" ext=\".js\">\n      <cntx:meta size=\"1617\" modified=\"2025-06-18T12:08:35.960Z\" />\n      <cntx:content><![CDATA[#!/usr/bin/env node\n\nimport { startServer, startMCPServer, generateBundle, initConfig, getStatus } from '../server.js';\n\nconst args = process.argv.slice(2);\nconst command = args[0] || 'watch';\n\n// Graceful shutdown\nprocess.on('SIGINT', () => {\n  console.log('\\n👋 Shutting down cntx-ui...');\n  process.exit(0);\n});\n\nswitch (command) {\n  case 'watch':\n    const port = parseInt(args[1]) || 3333;\n    startServer({ port });\n    break;\n\n  case 'mcp':\n    // MCP server mode - runs on stdio\n    startMCPServer({ cwd: process.cwd() });\n    break;\n\n  case 'bundle':\n    const bundleName = args[1] || 'master';\n    try {\n      generateBundle(bundleName);\n      console.log(`✅ Bundle '${bundleName}' generated`);\n    } catch (e) {\n      console.error(`❌ Bundle '${bundleName}' not found`);\n    }\n    break;\n\n  case 'init':\n    initConfig();\n    break;\n\n  case 'status':\n    getStatus();\n    break;\n\n  default:\n    console.log(`cntx-ui v2.0.3\n        \nUsage:\n  cntx-ui init                Initialize configuration\n  cntx-ui watch [port]        Start web server (default port: 3333)\n  cntx-ui mcp                 Start MCP server (stdio transport)\n  cntx-ui bundle [name]       Generate specific bundle (default: master)\n  cntx-ui status              Show current status\n  \nExamples:\n  cntx-ui init\n  cntx-ui watch 8080\n  cntx-ui mcp\n  cntx-ui bundle api\n\nMCP Usage:\n  The MCP server provides AI-accessible bundle management:\n  - Resources: Access bundles and files via cntx:// URIs\n  - Tools: List bundles, generate bundles, get project status\n  - Integration: Use with Claude Desktop, Cursor, or other MCP clients`);\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"build.sh\" ext=\".sh\">\n      <cntx:meta size=\"2029\" modified=\"2025-06-07T02:04:41.966Z\" />\n      <cntx:content><![CDATA[#!/bin/bash\n\n# build.sh - Script to build and test cntx-ui with web interface\n\nset -e  # Exit on any error\n\necho \"🏗️  Building cntx-ui with web interface...\"\n\n# Check if we're in the right directory\nif [ ! -f \"package.json\" ] || [ ! -d \"web\" ]; then\n    echo \"❌ Error: Please run this script from the cntx-ui root directory\"\n    exit 1\nfi\n\n# Clean previous builds\necho \"🧹 Cleaning previous builds...\"\nrm -rf web/dist\nrm -rf *.tgz\n\n# Install root dependencies\necho \"📦 Installing root dependencies...\"\nnpm install\n\n# Build web interface\necho \"🌐 Building web interface...\"\ncd web\nnpm install\nnpm run build\ncd ..\n\n# Verify build\nif [ ! -d \"web/dist\" ]; then\n    echo \"❌ Error: Web build failed - dist directory not found\"\n    exit 1\nfi\n\necho \"✅ Web interface built successfully\"\necho \"📁 Files in web/dist:\"\nls -la web/dist/\n\n# Test build locally\necho \"🧪 Testing local build...\"\nnpm pack\n\n# Get the package file name\nPACKAGE_FILE=$(ls cntx-ui-*.tgz | head -n 1)\n\nif [ -z \"$PACKAGE_FILE\" ]; then\n    echo \"❌ Error: Package file not found\"\n    exit 1\nfi\n\necho \"📦 Created package: $PACKAGE_FILE\"\necho \"📏 Package size: $(du -h $PACKAGE_FILE | cut -f1)\"\n\n# Optional: Test install locally\nread -p \"🤔 Test install locally? (y/N): \" -n 1 -r\necho\nif [[ $REPLY =~ ^[Yy]$ ]]; then\n    echo \"🔧 Installing locally for testing...\"\n    npm install -g ./$PACKAGE_FILE\n    \n    echo \"✅ Installed! Test with:\"\n    echo \"   mkdir test-project && cd test-project\"\n    echo \"   cntx-ui init\"\n    echo \"   cntx-ui watch\"\n    echo \"   # Then visit http://localhost:3333\"\nfi\n\necho \"\"\necho \"🎉 Build complete!\"\necho \"\"\necho \"📋 Next steps:\"\necho \"   1. Test the package locally (if not done above)\"\necho \"   2. If everything works, publish with: npm publish\"\necho \"   3. Or publish as beta: npm publish --tag beta\"\necho \"\"\necho \"🔍 To test in another project:\"\necho \"   mkdir /tmp/test-project && cd /tmp/test-project\"\necho \"   npm install -g $PWD/$PACKAGE_FILE\"\necho \"   cntx-ui init && cntx-ui watch\"\necho \"\"\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"lib/mcp-server.js\" ext=\".js\">\n      <cntx:meta size=\"10398\" modified=\"2025-06-18T12:07:07.104Z\" />\n      <cntx:content><![CDATA[import { readFileSync } from 'fs';\nimport { join, relative } from 'path';\n\nexport class MCPServer {\n  constructor(cntxServer) {\n    this.cntxServer = cntxServer;\n    this.clientCapabilities = null;\n    this.serverInfo = {\n      name: 'cntx-ui',\n      version: '2.0.3'\n    };\n  }\n\n  // JSON-RPC 2.0 message handler\n  async handleMessage(message) {\n    try {\n      const request = typeof message === 'string' ? JSON.parse(message) : message;\n      \n      // Handle JSON-RPC 2.0 format\n      if (!request.jsonrpc || request.jsonrpc !== '2.0') {\n        return this.createErrorResponse(null, -32600, 'Invalid Request');\n      }\n\n      const response = await this.routeRequest(request);\n      return response;\n    } catch (error) {\n      return this.createErrorResponse(null, -32700, 'Parse error');\n    }\n  }\n\n  async routeRequest(request) {\n    const { method, params, id } = request;\n\n    try {\n      switch (method) {\n        case 'initialize':\n          return this.handleInitialize(params, id);\n        \n        case 'initialized':\n          return null; // No response needed for notification\n        \n        case 'resources/list':\n          return this.handleListResources(id);\n        \n        case 'resources/read':\n          return this.handleReadResource(params, id);\n        \n        case 'tools/list':\n          return this.handleListTools(id);\n        \n        case 'tools/call':\n          return this.handleCallTool(params, id);\n        \n        default:\n          return this.createErrorResponse(id, -32601, 'Method not found');\n      }\n    } catch (error) {\n      return this.createErrorResponse(id, -32603, 'Internal error', error.message);\n    }\n  }\n\n  // Initialize MCP session\n  handleInitialize(params, id) {\n    this.clientCapabilities = params?.capabilities || {};\n    \n    return this.createSuccessResponse(id, {\n      protocolVersion: '2024-11-05',\n      capabilities: {\n        resources: {\n          subscribe: true,\n          listChanged: true\n        },\n        tools: {}\n      },\n      serverInfo: this.serverInfo\n    });\n  }\n\n  // List available resources (bundles)\n  handleListResources(id) {\n    const resources = [];\n    \n    this.cntxServer.bundles.forEach((bundle, name) => {\n      resources.push({\n        uri: `cntx://bundle/${name}`,\n        name: `Bundle: ${name}`,\n        description: `File bundle containing ${bundle.files.length} files`,\n        mimeType: 'application/xml'\n      });\n    });\n\n    // Add individual file resources\n    const allFiles = this.cntxServer.getAllFiles();\n    allFiles.slice(0, 100).forEach((filePath) => { // Limit to first 100 files\n      resources.push({\n        uri: `cntx://file/${filePath}`,\n        name: `File: ${filePath}`,\n        description: `Individual file: ${filePath}`,\n        mimeType: this.getMimeType(filePath)\n      });\n    });\n\n    return this.createSuccessResponse(id, {\n      resources\n    });\n  }\n\n  // Read a specific resource\n  handleReadResource(params, id) {\n    const { uri } = params;\n    \n    if (!uri || !uri.startsWith('cntx://')) {\n      return this.createErrorResponse(id, -32602, 'Invalid URI');\n    }\n\n    try {\n      if (uri.startsWith('cntx://bundle/')) {\n        const bundleName = uri.replace('cntx://bundle/', '');\n        const bundle = this.cntxServer.bundles.get(bundleName);\n        \n        if (!bundle) {\n          return this.createErrorResponse(id, -32602, 'Bundle not found');\n        }\n\n        return this.createSuccessResponse(id, {\n          contents: [{\n            uri,\n            mimeType: 'application/xml',\n            text: bundle.content\n          }]\n        });\n      } else if (uri.startsWith('cntx://file/')) {\n        const filePath = uri.replace('cntx://file/', '');\n        const fullPath = join(this.cntxServer.CWD, filePath);\n        \n        try {\n          const content = readFileSync(fullPath, 'utf8');\n          return this.createSuccessResponse(id, {\n            contents: [{\n              uri,\n              mimeType: this.getMimeType(filePath),\n              text: content\n            }]\n          });\n        } catch (error) {\n          return this.createErrorResponse(id, -32602, 'File not found');\n        }\n      }\n\n      return this.createErrorResponse(id, -32602, 'Invalid resource URI');\n    } catch (error) {\n      return this.createErrorResponse(id, -32603, 'Internal error reading resource');\n    }\n  }\n\n  // List available tools\n  handleListTools(id) {\n    const tools = [\n      {\n        name: 'list_bundles',\n        description: 'List all available file bundles',\n        inputSchema: {\n          type: 'object',\n          properties: {},\n          required: []\n        }\n      },\n      {\n        name: 'get_bundle',\n        description: 'Get the content of a specific bundle',\n        inputSchema: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Name of the bundle to retrieve'\n            }\n          },\n          required: ['name']\n        }\n      },\n      {\n        name: 'generate_bundle',\n        description: 'Regenerate a specific bundle',\n        inputSchema: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Name of the bundle to regenerate'\n            }\n          },\n          required: ['name']\n        }\n      },\n      {\n        name: 'get_file_tree',\n        description: 'Get the project file tree',\n        inputSchema: {\n          type: 'object',\n          properties: {},\n          required: []\n        }\n      },\n      {\n        name: 'get_project_status',\n        description: 'Get current project status and bundle information',\n        inputSchema: {\n          type: 'object',\n          properties: {},\n          required: []\n        }\n      }\n    ];\n\n    return this.createSuccessResponse(id, { tools });\n  }\n\n  // Handle tool execution\n  async handleCallTool(params, id) {\n    const { name, arguments: args = {} } = params;\n\n    try {\n      switch (name) {\n        case 'list_bundles':\n          return this.toolListBundles(id);\n        \n        case 'get_bundle':\n          return this.toolGetBundle(args, id);\n        \n        case 'generate_bundle':\n          return this.toolGenerateBundle(args, id);\n        \n        case 'get_file_tree':\n          return this.toolGetFileTree(id);\n        \n        case 'get_project_status':\n          return this.toolGetProjectStatus(id);\n        \n        default:\n          return this.createErrorResponse(id, -32602, 'Unknown tool');\n      }\n    } catch (error) {\n      return this.createErrorResponse(id, -32603, 'Tool execution failed', error.message);\n    }\n  }\n\n  // Tool implementations\n  toolListBundles(id) {\n    const bundles = [];\n    this.cntxServer.bundles.forEach((bundle, name) => {\n      bundles.push({\n        name,\n        fileCount: bundle.files.length,\n        size: bundle.size,\n        lastGenerated: bundle.lastGenerated,\n        changed: bundle.changed,\n        patterns: bundle.patterns\n      });\n    });\n\n    return this.createSuccessResponse(id, {\n      content: [{\n        type: 'text',\n        text: `Available bundles:\\n${bundles.map(b => \n          `• ${b.name}: ${b.fileCount} files (${(b.size / 1024).toFixed(1)}KB) ${b.changed ? '[CHANGED]' : '[SYNCED]'}`\n        ).join('\\n')}`\n      }]\n    });\n  }\n\n  toolGetBundle(args, id) {\n    const { name } = args;\n    const bundle = this.cntxServer.bundles.get(name);\n    \n    if (!bundle) {\n      return this.createErrorResponse(id, -32602, `Bundle '${name}' not found`);\n    }\n\n    return this.createSuccessResponse(id, {\n      content: [{\n        type: 'text',\n        text: bundle.content\n      }]\n    });\n  }\n\n  toolGenerateBundle(args, id) {\n    const { name } = args;\n    \n    if (!this.cntxServer.bundles.has(name)) {\n      return this.createErrorResponse(id, -32602, `Bundle '${name}' not found`);\n    }\n\n    this.cntxServer.generateBundle(name);\n    this.cntxServer.saveBundleStates();\n    \n    const bundle = this.cntxServer.bundles.get(name);\n    \n    return this.createSuccessResponse(id, {\n      content: [{\n        type: 'text',\n        text: `Bundle '${name}' regenerated successfully. Contains ${bundle.files.length} files (${(bundle.size / 1024).toFixed(1)}KB).`\n      }]\n    });\n  }\n\n  toolGetFileTree(id) {\n    const fileTree = this.cntxServer.getFileTree();\n    const treeText = fileTree.map(file => \n      `${file.path} (${(file.size / 1024).toFixed(1)}KB)`\n    ).join('\\n');\n\n    return this.createSuccessResponse(id, {\n      content: [{\n        type: 'text',\n        text: `Project file tree:\\n${treeText}`\n      }]\n    });\n  }\n\n  toolGetProjectStatus(id) {\n    const bundleCount = this.cntxServer.bundles.size;\n    const changedBundles = Array.from(this.cntxServer.bundles.entries())\n      .filter(([_, bundle]) => bundle.changed)\n      .map(([name, _]) => name);\n\n    const statusText = `Project Status:\nWorking Directory: ${relative(process.cwd(), this.cntxServer.CWD)}\nTotal Bundles: ${bundleCount}\nChanged Bundles: ${changedBundles.length > 0 ? changedBundles.join(', ') : 'None'}\n\nBundle Details:\n${Array.from(this.cntxServer.bundles.entries()).map(([name, bundle]) => \n  `• ${name}: ${bundle.files.length} files, ${(bundle.size / 1024).toFixed(1)}KB ${bundle.changed ? '[CHANGED]' : '[SYNCED]'}`\n).join('\\n')}`;\n\n    return this.createSuccessResponse(id, {\n      content: [{\n        type: 'text',\n        text: statusText\n      }]\n    });\n  }\n\n  // Helper methods\n  getMimeType(filePath) {\n    const ext = filePath.split('.').pop()?.toLowerCase();\n    const mimeTypes = {\n      'js': 'application/javascript',\n      'jsx': 'application/javascript',\n      'ts': 'application/typescript',\n      'tsx': 'application/typescript',\n      'json': 'application/json',\n      'xml': 'application/xml',\n      'html': 'text/html',\n      'css': 'text/css',\n      'md': 'text/markdown',\n      'txt': 'text/plain',\n      'py': 'text/x-python',\n      'java': 'text/x-java',\n      'c': 'text/x-c',\n      'cpp': 'text/x-c++',\n      'php': 'text/x-php'\n    };\n    return mimeTypes[ext] || 'text/plain';\n  }\n\n  createSuccessResponse(id, result) {\n    return {\n      jsonrpc: '2.0',\n      id,\n      result\n    };\n  }\n\n  createErrorResponse(id, code, message, data = null) {\n    const error = { code, message };\n    if (data) error.data = data;\n    \n    return {\n      jsonrpc: '2.0',\n      id,\n      error\n    };\n  }\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"lib/mcp-transport.js\" ext=\".js\">\n      <cntx:meta size=\"2604\" modified=\"2025-06-18T12:07:34.791Z\" />\n      <cntx:content><![CDATA[import { MCPServer } from './mcp-server.js';\n\nexport class MCPTransport {\n  constructor(cntxServer) {\n    this.mcpServer = new MCPServer(cntxServer);\n    this.buffer = '';\n  }\n\n  // Start stdio transport\n  start() {\n    console.error('🚀 MCP server starting on stdio transport');\n    \n    // Handle incoming messages from stdin\n    process.stdin.on('data', (data) => {\n      this.handleIncomingData(data.toString());\n    });\n\n    // Handle process cleanup\n    process.on('SIGINT', () => {\n      console.error('📡 MCP server shutting down');\n      process.exit(0);\n    });\n\n    process.on('SIGTERM', () => {\n      console.error('📡 MCP server shutting down');\n      process.exit(0);\n    });\n\n    // Set stdin to raw mode for proper JSON-RPC communication\n    process.stdin.setEncoding('utf8');\n    \n    console.error('✅ MCP server ready for JSON-RPC messages');\n  }\n\n  // Handle incoming data and parse JSON-RPC messages\n  async handleIncomingData(data) {\n    this.buffer += data;\n    \n    // Split by newlines to handle multiple messages\n    const lines = this.buffer.split('\\n');\n    this.buffer = lines.pop() || ''; // Keep incomplete line in buffer\n\n    for (const line of lines) {\n      if (line.trim()) {\n        try {\n          const message = JSON.parse(line.trim());\n          await this.processMessage(message);\n        } catch (error) {\n          console.error('❌ Failed to parse JSON-RPC message:', error.message);\n          this.sendError(null, -32700, 'Parse error');\n        }\n      }\n    }\n  }\n\n  // Process a single JSON-RPC message\n  async processMessage(message) {\n    try {\n      const response = await this.mcpServer.handleMessage(message);\n      \n      // Only send response if not null (notifications don't need responses)\n      if (response !== null) {\n        this.sendMessage(response);\n      }\n    } catch (error) {\n      console.error('❌ Error processing message:', error.message);\n      this.sendError(message.id || null, -32603, 'Internal error');\n    }\n  }\n\n  // Send a message via stdout\n  sendMessage(message) {\n    const messageStr = JSON.stringify(message);\n    process.stdout.write(messageStr + '\\n');\n  }\n\n  // Send an error response\n  sendError(id, code, message, data = null) {\n    const error = { code, message };\n    if (data) error.data = data;\n    \n    const response = {\n      jsonrpc: '2.0',\n      id,\n      error\n    };\n    \n    this.sendMessage(response);\n  }\n}\n\n// Factory function to start MCP transport\nexport function startMCPTransport(cntxServer) {\n  const transport = new MCPTransport(cntxServer);\n  transport.start();\n  return transport;\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"mcp-config-example.json\" ext=\".json\">\n      <cntx:meta size=\"129\" modified=\"2025-06-18T12:09:04.597Z\" />\n      <cntx:content><![CDATA[{\n  \"mcpServers\": {\n    \"cntx-ui\": {\n      \"command\": \"cntx-ui\",\n      \"args\": [\"mcp\"],\n      \"cwd\": \"{{projectDir}}\"\n    }\n  }\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"package.json\" ext=\".json\">\n      <cntx:meta size=\"1018\" modified=\"2025-06-18T12:09:54.744Z\" />\n      <cntx:content><![CDATA[{\n  \"name\": \"cntx-ui\",\n  \"type\": \"module\",\n  \"version\": \"2.0.3\",\n  \"description\": \"Minimal file bundling and tagging tool for AI development\",\n  \"keywords\": [\n    \"ai\",\n    \"bundling\",\n    \"file-management\",\n    \"development-tools\",\n    \"codebase\"\n  ],\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/nothingdao/cntx-ui.git\"\n  },\n  \"author\": \"whaleen\",\n  \"license\": \"MIT\",\n  \"bin\": {\n    \"cntx-ui\": \"./bin/cntx-ui.js\"\n  },\n  \"files\": [\n    \"bin/cntx-ui.js\",\n    \"server.js\",\n    \"lib/\",\n    \"README.md\",\n    \"web/dist\",\n    \"mcp-config-example.json\"\n  ],\n  \"engines\": {\n    \"node\": \">=18.0.0\"\n  },\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"cd web && npm install && npm run build\",\n    \"build:web\": \"cd web && npm install && npm run build\",\n    \"dev:web\": \"cd web && npm run dev\",\n    \"prebuild\": \"npm run build:web\",\n    \"prepublishOnly\": \"npm run build:web\",\n    \"test:local\": \"npm pack && npm install -g ./cntx-ui-2.0.0.tgz\"\n  },\n  \"dependencies\": {\n    \"ws\": \"^8.13.0\"\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"package.json.bak\" ext=\".bak\">\n      <cntx:meta size=\"964\" modified=\"2025-06-07T02:02:55.488Z\" />\n      <cntx:content><![CDATA[{\n  \"name\": \"cntx-ui\",\n  \"type\": \"module\",\n  \"version\": \"2.0.0\",\n  \"description\": \"Minimal file bundling and tagging tool for AI development\",\n  \"keywords\": [\n    \"ai\",\n    \"bundling\",\n    \"file-management\",\n    \"development-tools\",\n    \"codebase\"\n  ],\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/nothingdao/cntx-ui.git\"\n  },\n  \"author\": \"whaleen\",\n  \"license\": \"MIT\",\n  \"bin\": {\n    \"cntx-ui\": \"./bin/cntx-ui.js\"\n  },\n  \"files\": [\n    \"bin\",\n    \"server.js\",\n    \"web/dist\",\n    \"README.md\"\n  ],\n  \"engines\": {\n    \"node\": \">=18.0.0\"\n  },\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"cd web && npm install && npm run build\",\n    \"build:web\": \"cd web && npm install && npm run build\",\n    \"dev:web\": \"cd web && npm run dev\",\n    \"prebuild\": \"npm run build:web\",\n    \"prepublishOnly\": \"npm run build:web\",\n    \"test:local\": \"npm pack && npm install -g ./cntx-ui-2.0.0.tgz\"\n  },\n  \"dependencies\": {\n    \"ws\": \"^8.13.0\"\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"server.js\" ext=\".js\">\n      <cntx:meta size=\"46772\" modified=\"2025-06-18T12:08:01.149Z\" />\n      <cntx:content><![CDATA[import { readFileSync, writeFileSync, existsSync, mkdirSync, watch, readdirSync, statSync } from 'fs';\nimport { join, dirname, relative, extname } from 'path';\nimport { createServer } from 'http';\nimport { WebSocketServer } from 'ws';\nimport { fileURLToPath } from 'url';\nimport path from 'path';\nimport { startMCPTransport } from './lib/mcp-transport.js';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\nfunction getContentType(filePath) {\n  const ext = path.extname(filePath).toLowerCase();\n  const contentTypes = {\n    '.html': 'text/html',\n    '.js': 'application/javascript',\n    '.css': 'text/css',\n    '.json': 'application/json',\n    '.png': 'image/png',\n    '.jpg': 'image/jpeg',\n    '.gif': 'image/gif',\n    '.svg': 'image/svg+xml',\n    '.ico': 'image/x-icon'\n  };\n  return contentTypes[ext] || 'text/plain';\n}\n\nexport class CntxServer {\n  constructor(cwd = process.cwd()) {\n    this.CWD = cwd;\n    this.CNTX_DIR = join(cwd, '.cntx');\n    this.CONFIG_FILE = join(this.CNTX_DIR, 'config.json');\n    this.BUNDLES_FILE = join(this.CNTX_DIR, 'bundles.json');\n    this.HIDDEN_FILES_CONFIG = join(this.CNTX_DIR, 'hidden-files.json');\n    this.IGNORE_FILE = join(cwd, '.cntxignore');\n    this.CURSOR_RULES_FILE = join(cwd, '.cursorrules');\n\n    this.bundles = new Map();\n    this.ignorePatterns = [];\n    this.watchers = [];\n    this.clients = new Set();\n    this.isScanning = false;\n\n    this.hiddenFilesConfig = {\n      globalHidden: [], // Files hidden across all bundles\n      bundleSpecific: {}, // Files hidden per bundle: { bundleName: [filePaths] }\n      userIgnorePatterns: [], // User-added ignore patterns\n      disabledSystemPatterns: [] // System patterns the user disabled\n    };\n  }\n\n  init() {\n    if (!existsSync(this.CNTX_DIR)) mkdirSync(this.CNTX_DIR, { recursive: true });\n    this.loadConfig();\n    this.loadHiddenFilesConfig();\n    this.loadIgnorePatterns();\n    this.loadBundleStates();\n    this.startWatching();\n    this.generateAllBundles();\n  }\n\n  loadConfig() {\n    // Clear existing bundles to ensure deleted ones are removed\n    this.bundles.clear();\n\n    if (existsSync(this.CONFIG_FILE)) {\n      const config = JSON.parse(readFileSync(this.CONFIG_FILE, 'utf8'));\n      Object.entries(config.bundles || {}).forEach(([name, patterns]) => {\n        this.bundles.set(name, {\n          patterns: Array.isArray(patterns) ? patterns : [patterns],\n          files: [],\n          content: '',\n          changed: false,\n          lastGenerated: null,\n          size: 0\n        });\n      });\n    }\n\n    if (!this.bundles.has('master')) {\n      this.bundles.set('master', {\n        patterns: ['**/*'],\n        files: [],\n        content: '',\n        changed: false,\n        lastGenerated: null,\n        size: 0\n      });\n    }\n  }\n\n  loadHiddenFilesConfig() {\n    if (existsSync(this.HIDDEN_FILES_CONFIG)) {\n      try {\n        const config = JSON.parse(readFileSync(this.HIDDEN_FILES_CONFIG, 'utf8'));\n        this.hiddenFilesConfig = { ...this.hiddenFilesConfig, ...config };\n      } catch (e) {\n        console.warn('Could not load hidden files config:', e.message);\n      }\n    }\n  }\n\n  saveHiddenFilesConfig() {\n    try {\n      writeFileSync(this.HIDDEN_FILES_CONFIG, JSON.stringify(this.hiddenFilesConfig, null, 2));\n    } catch (e) {\n      console.error('Failed to save hidden files config:', e.message);\n    }\n  }\n\n  isFileHidden(filePath, bundleName = null) {\n    // Check global hidden files\n    if (this.hiddenFilesConfig.globalHidden.includes(filePath)) {\n      return true;\n    }\n\n    // Check bundle-specific hidden files\n    if (bundleName && this.hiddenFilesConfig.bundleSpecific[bundleName]) {\n      return this.hiddenFilesConfig.bundleSpecific[bundleName].includes(filePath);\n    }\n\n    return false;\n  }\n\n  toggleFileVisibility(filePath, bundleName = null, forceHide = null) {\n    if (bundleName) {\n      // Bundle-specific hiding\n      if (!this.hiddenFilesConfig.bundleSpecific[bundleName]) {\n        this.hiddenFilesConfig.bundleSpecific[bundleName] = [];\n      }\n\n      const bundleHidden = this.hiddenFilesConfig.bundleSpecific[bundleName];\n      const isCurrentlyHidden = bundleHidden.includes(filePath);\n\n      if (forceHide === null) {\n        // Toggle current state\n        if (isCurrentlyHidden) {\n          this.hiddenFilesConfig.bundleSpecific[bundleName] = bundleHidden.filter(f => f !== filePath);\n        } else {\n          bundleHidden.push(filePath);\n        }\n      } else {\n        // Force to specific state\n        if (forceHide && !isCurrentlyHidden) {\n          bundleHidden.push(filePath);\n        } else if (!forceHide && isCurrentlyHidden) {\n          this.hiddenFilesConfig.bundleSpecific[bundleName] = bundleHidden.filter(f => f !== filePath);\n        }\n      }\n    } else {\n      // Global hiding\n      const isCurrentlyHidden = this.hiddenFilesConfig.globalHidden.includes(filePath);\n\n      if (forceHide === null) {\n        // Toggle current state\n        if (isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden = this.hiddenFilesConfig.globalHidden.filter(f => f !== filePath);\n        } else {\n          this.hiddenFilesConfig.globalHidden.push(filePath);\n        }\n      } else {\n        // Force to specific state\n        if (forceHide && !isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden.push(filePath);\n        } else if (!forceHide && isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden = this.hiddenFilesConfig.globalHidden.filter(f => f !== filePath);\n        }\n      }\n    }\n\n    this.saveHiddenFilesConfig();\n  }\n\n  bulkToggleFileVisibility(filePaths, bundleName = null, forceHide = null) {\n    filePaths.forEach(filePath => {\n      this.toggleFileVisibility(filePath, bundleName, forceHide);\n    });\n  }\n\n  addUserIgnorePattern(pattern) {\n    if (!this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)) {\n      this.hiddenFilesConfig.userIgnorePatterns.push(pattern);\n      this.saveHiddenFilesConfig();\n      this.loadIgnorePatterns();\n      this.generateAllBundles();\n      return true;\n    }\n    return false;\n  }\n\n  removeUserIgnorePattern(pattern) {\n    const index = this.hiddenFilesConfig.userIgnorePatterns.indexOf(pattern);\n    if (index > -1) {\n      this.hiddenFilesConfig.userIgnorePatterns.splice(index, 1);\n      this.saveHiddenFilesConfig();\n      this.loadIgnorePatterns();\n      this.generateAllBundles();\n      return true;\n    }\n    return false;\n  }\n\n  toggleSystemIgnorePattern(pattern) {\n    const index = this.hiddenFilesConfig.disabledSystemPatterns.indexOf(pattern);\n    if (index > -1) {\n      // Re-enable the pattern\n      this.hiddenFilesConfig.disabledSystemPatterns.splice(index, 1);\n    } else {\n      // Disable the pattern\n      this.hiddenFilesConfig.disabledSystemPatterns.push(pattern);\n    }\n\n    this.saveHiddenFilesConfig();\n    this.loadIgnorePatterns();\n    this.generateAllBundles();\n  }\n\n  loadIgnorePatterns() {\n    const systemPatterns = [\n      '**/.git/**',\n      '**/node_modules/**',\n      '**/.cntx/**'\n    ];\n\n    // Read from .cntxignore file\n    let filePatterns = [];\n    if (existsSync(this.IGNORE_FILE)) {\n      filePatterns = readFileSync(this.IGNORE_FILE, 'utf8')\n        .split('\\n')\n        .map(line => line.trim())\n        .filter(line => line && !line.startsWith('#'));\n    }\n\n    // Combine all patterns\n    this.ignorePatterns = [\n      // System patterns (filtered by disabled list)\n      ...systemPatterns.filter(pattern =>\n        !this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n      ),\n      // File patterns\n      ...filePatterns.filter(pattern =>\n        !systemPatterns.includes(pattern) &&\n        !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n      ),\n      // User-added patterns\n      ...this.hiddenFilesConfig.userIgnorePatterns\n    ];\n\n    // Update .cntxignore file with current patterns\n    const allPatterns = [\n      '# System patterns',\n      ...systemPatterns.map(pattern =>\n        this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n          ? `# ${pattern}`\n          : pattern\n      ),\n      '',\n      '# User patterns',\n      ...this.hiddenFilesConfig.userIgnorePatterns,\n      '',\n      '# File-specific patterns (edit manually)',\n      ...filePatterns.filter(pattern =>\n        !systemPatterns.includes(pattern) &&\n        !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n      )\n    ];\n\n    writeFileSync(this.IGNORE_FILE, allPatterns.join('\\n'));\n  }\n\n  loadBundleStates() {\n    if (existsSync(this.BUNDLES_FILE)) {\n      try {\n        const savedBundles = JSON.parse(readFileSync(this.BUNDLES_FILE, 'utf8'));\n        Object.entries(savedBundles).forEach(([name, data]) => {\n          if (this.bundles.has(name)) {\n            const bundle = this.bundles.get(name);\n            bundle.content = data.content || '';\n            bundle.lastGenerated = data.lastGenerated;\n            bundle.size = data.size || 0;\n          }\n        });\n      } catch (e) {\n        console.warn('Could not load bundle states:', e.message);\n      }\n    }\n  }\n\n  saveBundleStates() {\n    const bundleStates = {};\n    this.bundles.forEach((bundle, name) => {\n      bundleStates[name] = {\n        content: bundle.content,\n        lastGenerated: bundle.lastGenerated,\n        size: bundle.size\n      };\n    });\n    writeFileSync(this.BUNDLES_FILE, JSON.stringify(bundleStates, null, 2));\n  }\n\n  // Cursor Rules Methods\n  loadCursorRules() {\n    if (existsSync(this.CURSOR_RULES_FILE)) {\n      return readFileSync(this.CURSOR_RULES_FILE, 'utf8');\n    }\n    return this.getDefaultCursorRules();\n  }\n\n  getDefaultCursorRules() {\n    // Get project info for context\n    let projectInfo = { name: 'unknown', description: '', type: 'general' };\n    const pkgPath = join(this.CWD, 'package.json');\n\n    if (existsSync(pkgPath)) {\n      try {\n        const pkg = JSON.parse(readFileSync(pkgPath, 'utf8'));\n        projectInfo = {\n          name: pkg.name || 'unknown',\n          description: pkg.description || '',\n          type: this.detectProjectType(pkg)\n        };\n      } catch (e) {\n        // Use defaults\n      }\n    }\n\n    return this.generateCursorRulesTemplate(projectInfo);\n  }\n\n  detectProjectType(pkg) {\n    const deps = { ...pkg.dependencies, ...pkg.devDependencies };\n\n    if (deps.react || deps['@types/react']) return 'react';\n    if (deps.vue || deps['@vue/cli']) return 'vue';\n    if (deps.angular || deps['@angular/core']) return 'angular';\n    if (deps.express || deps.fastify || deps.koa) return 'node';\n    if (deps.next || deps.nuxt || deps.gatsby) return 'fullstack';\n    if (deps.typescript || deps['@types/node']) return 'typescript';\n    if (pkg.type === 'module' || deps.vite || deps.webpack) return 'modern-js';\n\n    return 'general';\n  }\n\n  generateCursorRulesTemplate(projectInfo) {\n    const bundlesList = Array.from(this.bundles.keys()).join(', ');\n\n    const templates = {\n      react: `# ${projectInfo.name} - React Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Type**: React Application\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Style\n- Use TypeScript for all new components\n- Prefer functional components with hooks\n- Use Tailwind CSS for styling\n- Follow React best practices and hooks rules\n\n### File Organization\n- Components in \\`src/components/\\`\n- Custom hooks in \\`src/hooks/\\`\n- Utilities in \\`src/lib/\\`\n- Types in \\`src/types/\\`\n\n### Naming Conventions\n- PascalCase for components\n- camelCase for functions and variables\n- kebab-case for files and folders\n- Use descriptive, meaningful names\n\n### Bundle Context\nThis project uses cntx-ui for file bundling. Current bundles: ${bundlesList}\n- **ui**: React components and styles\n- **api**: API routes and utilities  \n- **config**: Configuration files\n- **docs**: Documentation\n\n### AI Assistant Instructions\n- When suggesting code changes, consider the current bundle structure\n- Prioritize TypeScript and modern React patterns\n- Suggest Tailwind classes for styling\n- Keep components focused and reusable\n- Always include proper TypeScript types\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`,\n\n      node: `# ${projectInfo.name} - Node.js Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Type**: Node.js Backend\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Style\n- Use ES modules (import/export)\n- TypeScript preferred for type safety\n- Follow Node.js best practices\n- Use async/await over promises\n\n### File Organization\n- Routes in \\`src/routes/\\`\n- Middleware in \\`src/middleware/\\`\n- Models in \\`src/models/\\`\n- Utilities in \\`src/utils/\\`\n\n### Bundle Context\nThis project uses cntx-ui for file bundling. Current bundles: ${bundlesList}\n- **api**: Core API logic and routes\n- **config**: Environment and configuration\n- **docs**: API documentation\n\n### AI Assistant Instructions\n- Focus on scalable backend architecture\n- Suggest proper error handling\n- Consider security best practices\n- Optimize for performance and maintainability\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`,\n\n      general: `# ${projectInfo.name} - Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Quality\n- Write clean, readable code\n- Follow consistent naming conventions\n- Add comments for complex logic\n- Maintain proper file organization\n\n### Bundle Management\nThis project uses cntx-ui for intelligent file bundling. Current bundles: ${bundlesList}\n- **master**: Complete project overview\n- **config**: Configuration and setup files\n- **docs**: Documentation and README files\n\n### AI Assistant Instructions\n- When helping with code, consider the project structure\n- Suggest improvements for maintainability\n- Follow established patterns in the codebase\n- Help optimize bundle configurations when needed\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`\n    };\n\n    return templates[projectInfo.type] || templates.general;\n  }\n\n  saveCursorRules(content) {\n    writeFileSync(this.CURSOR_RULES_FILE, content, 'utf8');\n  }\n\n  shouldIgnoreFile(filePath) {\n    const relativePath = relative(this.CWD, filePath).replace(/\\\\\\\\/g, '/');\n\n    // Hard-coded critical ignores\n    if (relativePath.startsWith('node_modules/')) return true;\n    if (relativePath.startsWith('.git/')) return true;\n    if (relativePath.startsWith('.cntx/')) return true;\n\n    return this.ignorePatterns.some(pattern => this.matchesPattern(relativePath, pattern));\n  }\n\n  matchesPattern(path, pattern) {\n    if (pattern === '**/*') return true;\n    if (pattern === '*') return !path.includes('/');\n    if (pattern === path) return true;\n\n    let regexPattern = pattern\n      .replace(/\\\\/g, '/')\n      .replace(/\\./g, '\\\\.')\n      .replace(/\\?/g, '.');\n\n    regexPattern = regexPattern.replace(/\\*\\*/g, 'DOUBLESTAR');\n    regexPattern = regexPattern.replace(/\\*/g, '[^/]*');\n    regexPattern = regexPattern.replace(/DOUBLESTAR/g, '.*');\n\n    try {\n      const regex = new RegExp('^' + regexPattern + '$');\n      return regex.test(path);\n    } catch (e) {\n      console.log(`Regex error for pattern \"${pattern}\": ${e.message}`);\n      return false;\n    }\n  }\n\n  shouldIgnoreAnything(itemName, fullPath) {\n    // DIRECTORY NAME IGNORES (anywhere in the project)\n    const badDirectories = [\n      'node_modules',\n      '.git',\n      '.svn',\n      '.hg',\n      'vendor',\n      '__pycache__',\n      '.pytest_cache',\n      '.venv',\n      'venv',\n      'env',\n      '.env',\n      'dist',\n      'build',\n      'out',\n      '.next',\n      '.nuxt',\n      'coverage',\n      '.nyc_output',\n      '.cache',\n      '.parcel-cache',\n      '.vercel',\n      '.netlify',\n      'tmp',\n      'temp',\n      '.tmp',\n      '.temp',\n      'logs',\n      '*.egg-info',\n      '.cntx'\n    ];\n\n    if (badDirectories.includes(itemName)) {\n      return true;\n    }\n\n    // FILE EXTENSION IGNORES\n    const badExtensions = [\n      // Logs\n      '.log', '.logs',\n      // OS files\n      '.DS_Store', '.Thumbs.db', 'desktop.ini',\n      // Editor files\n      '.vscode', '.idea', '*.swp', '*.swo', '*~',\n      // Media files (large and useless for AI)\n      '.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp', '.svg',\n      '.mp4', '.avi', '.mov', '.wmv', '.flv', '.webm', '.mkv',\n      '.mp3', '.wav', '.flac', '.aac', '.ogg', '.wma',\n      '.pdf', '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx',\n      '.zip', '.tar', '.gz', '.rar', '.7z', '.bz2',\n      '.exe', '.dll', '.so', '.dylib', '.app', '.dmg', '.pkg',\n      // Cache/temp files\n      '.cache', '.tmp', '.temp', '.lock',\n      // Compiled files\n      '.pyc', '.pyo', '.class', '.o', '.obj', '.a', '.lib'\n    ];\n\n    const fileExt = extname(itemName).toLowerCase();\n    if (badExtensions.includes(fileExt)) {\n      return true;\n    }\n\n    // FILE NAME PATTERNS\n    const badFilePatterns = [\n      /^\\..*/, // Hidden files starting with .\n      /.*\\.lock$/, // Lock files\n      /.*\\.min\\.js$/, // Minified JS\n      /.*\\.min\\.css$/, // Minified CSS\n      /.*\\.map$/, // Source maps\n      /package-lock\\.json$/,\n      /yarn\\.lock$/,\n      /pnpm-lock\\.yaml$/,\n      /Thumbs\\.db$/,\n      /\\.DS_Store$/\n    ];\n\n    if (badFilePatterns.some(pattern => pattern.test(itemName))) {\n      return true;\n    }\n\n    // PATH-BASED IGNORES (from your .cntxignore)\n    return this.ignorePatterns.some(pattern => this.matchesPattern(fullPath, pattern));\n  }\n\n  getAllFiles(dir = this.CWD, files = []) {\n    try {\n      const items = readdirSync(dir);\n      for (const item of items) {\n        const fullPath = join(dir, item);\n        const relativePath = relative(this.CWD, fullPath).replace(/\\\\\\\\/g, '/');\n\n        // BULLETPROOF IGNORES - check directory/file names directly\n        const shouldIgnore = this.shouldIgnoreAnything(item, relativePath);\n\n        if (shouldIgnore) {\n          continue; // Don't even log it, just skip\n        }\n\n        const stat = statSync(fullPath);\n        if (stat.isDirectory()) {\n          this.getAllFiles(fullPath, files);\n        } else {\n          files.push(relativePath);\n        }\n      }\n    } catch (e) {\n      // Skip directories we can't read\n    }\n\n    return files;\n  }\n\n  startWatching() {\n    const watcher = watch(this.CWD, { recursive: true }, (eventType, filename) => {\n      if (filename && !this.isScanning) {\n        const fullPath = join(this.CWD, filename);\n        if (!this.shouldIgnoreFile(fullPath)) {\n          console.log(`File ${eventType}: ${filename}`);\n          this.markBundlesChanged(filename.replace(/\\\\\\\\/g, '/'));\n          this.broadcastUpdate();\n        }\n      }\n    });\n    this.watchers.push(watcher);\n  }\n\n  getFileTree() {\n    const allFiles = this.getAllFiles();\n    const fileData = allFiles.map(file => {\n      const fullPath = join(this.CWD, file);\n      try {\n        const stat = statSync(fullPath);\n        return {\n          path: file,\n          size: stat.size,\n          modified: stat.mtime\n        };\n      } catch (e) {\n        return {\n          path: file,\n          size: 0,\n          modified: new Date()\n        };\n      }\n    });\n    return fileData;\n  }\n\n  markBundlesChanged(filename) {\n    this.bundles.forEach((bundle, name) => {\n      if (bundle.patterns.some(pattern => this.matchesPattern(filename, pattern))) {\n        bundle.changed = true;\n      }\n    });\n  }\n\n  generateAllBundles() {\n    this.isScanning = true;\n    console.log('Scanning files and generating bundles...');\n\n    this.bundles.forEach((bundle, name) => {\n      this.generateBundle(name);\n    });\n\n    this.saveBundleStates();\n    this.isScanning = false;\n    console.log('Bundle generation complete');\n  }\n\n  generateBundle(name) {\n    const bundle = this.bundles.get(name);\n    if (!bundle) return;\n\n    console.log(`Generating bundle: ${name}`);\n    const allFiles = this.getAllFiles();\n\n    // Filter files by bundle patterns\n    let bundleFiles = allFiles.filter(file =>\n      bundle.patterns.some(pattern => this.matchesPattern(file, pattern))\n    );\n\n    // Remove hidden files\n    bundleFiles = bundleFiles.filter(file => !this.isFileHidden(file, name));\n\n    bundle.files = bundleFiles;\n    bundle.content = this.generateBundleXML(name, bundle.files);\n    bundle.changed = false;\n    bundle.lastGenerated = new Date().toISOString();\n    bundle.size = Buffer.byteLength(bundle.content, 'utf8');\n\n    console.log(`Generated bundle '${name}' with ${bundle.files.length} files (${(bundle.size / 1024).toFixed(1)}kb)`);\n  }\n\n  generateBundleXML(bundleName, files) {\n    let xml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"${bundleName}\" generated=\"${new Date().toISOString()}\">\n`;\n\n    const pkgPath = join(this.CWD, 'package.json');\n    if (existsSync(pkgPath)) {\n      try {\n        const pkg = JSON.parse(readFileSync(pkgPath, 'utf8'));\n        xml += `  <cntx:project>\n    <cntx:name>${this.escapeXml(pkg.name || 'unknown')}</cntx:name>\n    <cntx:version>${pkg.version || '0.0.0'}</cntx:version>\n`;\n        if (pkg.description) xml += `    <cntx:description>${this.escapeXml(pkg.description)}</cntx:description>\n`;\n        xml += `  </cntx:project>\n`;\n      } catch (e) {\n        xml += `  <cntx:project><cntx:error>Could not parse package.json</cntx:error></cntx:project>\n`;\n      }\n    }\n\n    xml += `  <cntx:files count=\"${files.length}\">\n`;\n\n    files.forEach(file => {\n      const fullPath = join(this.CWD, file);\n      xml += `    <cntx:file path=\"${file}\" ext=\"${extname(file)}\">\n`;\n\n      try {\n        const stat = statSync(fullPath);\n        const content = readFileSync(fullPath, 'utf8');\n        xml += `      <cntx:meta size=\"${stat.size}\" modified=\"${stat.mtime.toISOString()}\" />\n      <cntx:content><![CDATA[${content}]]></cntx:content>\n`;\n      } catch (e) {\n        xml += `      <cntx:error>Could not read file: ${e.message}</cntx:error>\n`;\n      }\n\n      xml += `    </cntx:file>\n`;\n    });\n\n    xml += `  </cntx:files>\n</cntx:bundle>`;\n    return xml;\n  }\n\n  escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;');\n  }\n\n  getFileStats(filePath) {\n    try {\n      const fullPath = join(this.CWD, filePath);\n      const stat = statSync(fullPath);\n      return {\n        size: stat.size,\n        mtime: stat.mtime\n      };\n    } catch (e) {\n      return {\n        size: 0,\n        mtime: new Date()\n      };\n    }\n  }\n\n  getFileListWithVisibility(bundleName = null) {\n    const allFiles = this.getAllFiles();\n\n    return allFiles.map(filePath => {\n      const fileStats = this.getFileStats(filePath);\n      const isGloballyHidden = this.hiddenFilesConfig.globalHidden.includes(filePath);\n      const bundleHidden = bundleName ? this.isFileHidden(filePath, bundleName) : false;\n\n      // Determine which bundles this file appears in\n      const inBundles = [];\n      this.bundles.forEach((bundle, name) => {\n        const matchesPattern = bundle.patterns.some(pattern => this.matchesPattern(filePath, pattern));\n        const notHidden = !this.isFileHidden(filePath, name);\n        if (matchesPattern && notHidden) {\n          inBundles.push(name);\n        }\n      });\n\n      return {\n        path: filePath,\n        size: fileStats.size,\n        modified: fileStats.mtime,\n        visible: !isGloballyHidden && !bundleHidden,\n        globallyHidden: isGloballyHidden,\n        bundleHidden: bundleHidden,\n        inBundles: inBundles,\n        matchesIgnorePattern: this.shouldIgnoreFile(join(this.CWD, filePath))\n      };\n    });\n  }\n\n  startServer(port = 3333) {\n    const server = createServer((req, res) => {\n      const url = new URL(req.url, `http://localhost:${port}`);\n\n      // CORS headers for ALL requests - MUST be first\n      res.setHeader('Access-Control-Allow-Origin', '*');\n      res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\n      res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n      res.setHeader('Access-Control-Max-Age', '86400');\n\n      // Handle preflight OPTIONS requests\n      if (req.method === 'OPTIONS') {\n        res.writeHead(200);\n        res.end();\n        return;\n      }\n\n      // Serve static files for web interface\n      if (url.pathname === '/' || url.pathname.startsWith('/assets/') || url.pathname.endsWith('.js') || url.pathname.endsWith('.css') || url.pathname.endsWith('.ico')) {\n        const webDistPath = path.join(__dirname, 'web', 'dist');\n\n        if (url.pathname === '/') {\n          // Serve index.html for root\n          const indexPath = path.join(webDistPath, 'index.html');\n          if (existsSync(indexPath)) {\n            try {\n              const content = readFileSync(indexPath, 'utf8');\n              res.writeHead(200, { 'Content-Type': 'text/html' });\n              res.end(content);\n              return;\n            } catch (e) {\n              console.error('Error serving index.html:', e);\n            }\n          }\n\n          // Fallback if no web interface built\n          res.writeHead(200, { 'Content-Type': 'text/html' });\n          res.end(`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <title>cntx-ui Server</title>\n              <style>\n                body { font-family: system-ui, sans-serif; margin: 40px; }\n                .container { max-width: 600px; }\n                .api-link { background: #f5f5f5; padding: 10px; border-radius: 5px; margin: 10px 0; }\n                code { background: #f0f0f0; padding: 2px 5px; border-radius: 3px; }\n              </style>\n            </head>\n            <body>\n              <div class=\"container\">\n                <h1>🚀 cntx-ui Server Running</h1>\n                <p>Your cntx-ui server is running successfully!</p>\n                \n                <h2>Available APIs:</h2>\n                <div class=\"api-link\">\n                  <strong>Bundles:</strong> <a href=\"/api/bundles\">/api/bundles</a>\n                </div>\n                <div class=\"api-link\">\n                  <strong>Configuration:</strong> <a href=\"/api/config\">/api/config</a>\n                </div>\n                <div class=\"api-link\">\n                  <strong>Files:</strong> <a href=\"/api/files\">/api/files</a>\n                </div>\n                \n                <h2>Web Interface:</h2>\n                <p>The web interface is not available because it wasn't built when this package was published.</p>\n                <p>To enable the web interface, the package maintainer needs to run:</p>\n                <pre><code>cd web && npm install && npm run build</code></pre>\n                \n                <h2>CLI Usage:</h2>\n                <p>You can still use all CLI commands:</p>\n                <ul>\n                  <li><code>cntx-ui status</code> - Check current status</li>\n                  <li><code>cntx-ui bundle master</code> - Generate specific bundle</li>\n                  <li><code>cntx-ui init</code> - Initialize configuration</li>\n                </ul>\n              </div>\n            </body>\n          </html>\n        `);\n          return;\n        } else {\n          // Serve other static assets\n          const filePath = path.join(webDistPath, url.pathname);\n          if (existsSync(filePath)) {\n            try {\n              const content = readFileSync(filePath);\n              const contentType = getContentType(filePath);\n              res.writeHead(200, { 'Content-Type': contentType });\n              res.end(content);\n              return;\n            } catch (e) {\n              console.error('Error serving static file:', e);\n            }\n          }\n        }\n      }\n\n      // API Routes\n      if (url.pathname === '/api/bundles') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const bundleData = Array.from(this.bundles.entries()).map(([name, bundle]) => ({\n          name,\n          changed: bundle.changed,\n          fileCount: bundle.files.length,\n          content: bundle.content.substring(0, 5000) + (bundle.content.length > 5000 ? '...' : ''),\n          files: bundle.files,\n          lastGenerated: bundle.lastGenerated,\n          size: bundle.size\n        }));\n        res.end(JSON.stringify(bundleData));\n\n      } else if (url.pathname.startsWith('/api/bundles/')) {\n        const bundleName = url.pathname.split('/').pop();\n        const bundle = this.bundles.get(bundleName);\n        if (bundle) {\n          res.writeHead(200, { 'Content-Type': 'application/xml' });\n          res.end(bundle.content);\n        } else {\n          res.writeHead(404);\n          res.end('Bundle not found');\n        }\n\n      } else if (url.pathname.startsWith('/api/regenerate/')) {\n        const bundleName = url.pathname.split('/').pop();\n        if (this.bundles.has(bundleName)) {\n          this.generateBundle(bundleName);\n          this.saveBundleStates();\n          this.broadcastUpdate();\n          res.writeHead(200);\n          res.end('OK');\n        } else {\n          res.writeHead(404);\n          res.end('Bundle not found');\n        }\n\n      } else if (url.pathname === '/api/files') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const fileTree = this.getFileTree();\n        res.end(JSON.stringify(fileTree));\n\n      } else if (url.pathname === '/api/config') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          if (existsSync(this.CONFIG_FILE)) {\n            const config = readFileSync(this.CONFIG_FILE, 'utf8');\n            res.end(config);\n          } else {\n            const defaultConfig = {\n              bundles: {\n                master: ['**/*'],\n                api: ['src/api.js'],\n                ui: ['src/component.jsx', 'src/*.jsx'],\n                config: ['package.json', 'package-lock.json', '*.config.*'],\n                docs: ['README.md', '*.md']\n              }\n            };\n            res.end(JSON.stringify(defaultConfig));\n          }\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              console.log('🔍 Received config save request');\n              const config = JSON.parse(body);\n              console.log('📝 Config to save:', JSON.stringify(config, null, 2));\n\n              // Ensure .cntx directory exists\n              if (!existsSync(this.CNTX_DIR)) {\n                console.log('📁 Creating .cntx directory...');\n                mkdirSync(this.CNTX_DIR, { recursive: true });\n              }\n\n              // Write config file\n              console.log('💾 Writing config to:', this.CONFIG_FILE);\n              writeFileSync(this.CONFIG_FILE, JSON.stringify(config, null, 2));\n              console.log('✅ Config file written successfully');\n\n              // Reload configuration\n              this.loadConfig();\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'text/plain' });\n              res.end('OK');\n              console.log('✅ Config save response sent');\n\n            } catch (e) {\n              console.error('❌ Config save error:', e);\n              res.writeHead(400, { 'Content-Type': 'text/plain' });\n              res.end(`Error: ${e.message}`);\n            }\n          });\n\n          req.on('error', (err) => {\n            console.error('❌ Request error:', err);\n            if (!res.headersSent) {\n              res.writeHead(500, { 'Content-Type': 'text/plain' });\n              res.end('Internal Server Error');\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/cursor-rules') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'text/plain' });\n          const rules = this.loadCursorRules();\n          res.end(rules);\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { content } = JSON.parse(body);\n              this.saveCursorRules(content);\n              res.writeHead(200);\n              res.end('OK');\n            } catch (e) {\n              res.writeHead(400);\n              res.end('Invalid request');\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/cursor-rules/templates') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const templates = {\n          react: this.generateCursorRulesTemplate({ name: 'My React App', description: 'React application', type: 'react' }),\n          node: this.generateCursorRulesTemplate({ name: 'My Node App', description: 'Node.js backend', type: 'node' }),\n          general: this.generateCursorRulesTemplate({ name: 'My Project', description: 'General project', type: 'general' })\n        };\n        res.end(JSON.stringify(templates));\n\n      } else if (url.pathname === '/api/test-pattern') {\n        if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { pattern } = JSON.parse(body);\n              const allFiles = this.getAllFiles();\n              const matchingFiles = allFiles.filter(file =>\n                this.matchesPattern(file, pattern)\n              );\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify(matchingFiles));\n            } catch (e) {\n              res.writeHead(400);\n              res.end('Invalid request');\n            }\n          });\n        } else {\n          res.writeHead(405);\n          res.end('Method not allowed');\n        }\n\n      } else if (url.pathname === '/api/hidden-files') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          const stats = {\n            totalFiles: this.getAllFiles().length,\n            globallyHidden: this.hiddenFilesConfig.globalHidden.length,\n            bundleSpecificHidden: this.hiddenFilesConfig.bundleSpecific,\n            ignorePatterns: {\n              system: [\n                { pattern: '**/.git/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/.git/**') },\n                { pattern: '**/node_modules/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/node_modules/**') },\n                { pattern: '**/.cntx/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/.cntx/**') }\n              ],\n              user: this.hiddenFilesConfig.userIgnorePatterns,\n              disabled: this.hiddenFilesConfig.disabledSystemPatterns\n            }\n          };\n          res.end(JSON.stringify(stats));\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { action, filePath, filePaths, bundleName, forceHide } = JSON.parse(body);\n\n              if (action === 'toggle' && filePath) {\n                this.toggleFileVisibility(filePath, bundleName, forceHide);\n              } else if (action === 'bulk-toggle' && filePaths) {\n                this.bulkToggleFileVisibility(filePaths, bundleName, forceHide);\n              }\n\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success: true }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/files-with-visibility') {\n        const bundleName = url.searchParams.get('bundle');\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const files = this.getFileListWithVisibility(bundleName);\n        res.end(JSON.stringify(files));\n\n      } else if (url.pathname === '/api/ignore-patterns') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n\n          // Read file patterns\n          let filePatterns = [];\n          if (existsSync(this.IGNORE_FILE)) {\n            filePatterns = readFileSync(this.IGNORE_FILE, 'utf8')\n              .split('\\n')\n              .map(line => line.trim())\n              .filter(line => line && !line.startsWith('#'));\n          }\n\n          const systemPatterns = ['**/.git/**', '**/node_modules/**', '**/.cntx/**'];\n\n          const patterns = {\n            system: systemPatterns.map(pattern => ({\n              pattern,\n              active: !this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n            })),\n            user: this.hiddenFilesConfig.userIgnorePatterns.map(pattern => ({ pattern, active: true })),\n            file: filePatterns.filter(pattern =>\n              !systemPatterns.includes(pattern) &&\n              !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n            ).map(pattern => ({ pattern, active: true }))\n          };\n          res.end(JSON.stringify(patterns));\n\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { action, pattern } = JSON.parse(body);\n              let success = false;\n\n              switch (action) {\n                case 'add':\n                  success = this.addUserIgnorePattern(pattern);\n                  break;\n                case 'remove':\n                  success = this.removeUserIgnorePattern(pattern);\n                  break;\n                case 'toggle-system':\n                  this.toggleSystemIgnorePattern(pattern);\n                  success = true;\n                  break;\n              }\n\n              this.broadcastUpdate();\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/bundle-visibility-stats') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const stats = {};\n\n        this.bundles.forEach((bundle, bundleName) => {\n          const allFiles = this.getAllFiles();\n          const matchingFiles = allFiles.filter(file =>\n            bundle.patterns.some(pattern => this.matchesPattern(file, pattern))\n          );\n\n          const visibleFiles = matchingFiles.filter(file => !this.isFileHidden(file, bundleName));\n          const hiddenFiles = matchingFiles.length - visibleFiles.length;\n\n          stats[bundleName] = {\n            total: matchingFiles.length,\n            visible: visibleFiles.length,\n            hidden: hiddenFiles,\n            patterns: bundle.patterns\n          };\n        });\n\n        res.end(JSON.stringify(stats));\n\n      } else if (url.pathname === '/api/reset-hidden-files') {\n        if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { scope, bundleName } = JSON.parse(body);\n\n              if (scope === 'global') {\n                this.hiddenFilesConfig.globalHidden = [];\n              } else if (scope === 'bundle' && bundleName) {\n                delete this.hiddenFilesConfig.bundleSpecific[bundleName];\n              } else if (scope === 'all') {\n                this.hiddenFilesConfig.globalHidden = [];\n                this.hiddenFilesConfig.bundleSpecific = {};\n              }\n\n              this.saveHiddenFilesConfig();\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success: true }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else {\n        res.writeHead(404);\n        res.end('Not found');\n      }\n    });\n\n    const wss = new WebSocketServer({ server });\n    wss.on('connection', (ws) => {\n      this.clients.add(ws);\n      ws.on('close', () => this.clients.delete(ws));\n      this.sendUpdate(ws);\n    });\n\n    server.listen(port, () => {\n      console.log(`🚀 cntx-ui API running at http://localhost:${port}`);\n      console.log(`📁 Watching: ${this.CWD}`);\n      console.log(`📦 Bundles: ${Array.from(this.bundles.keys()).join(', ')}`);\n    });\n\n    return server;\n  }\n\n  broadcastUpdate() {\n    this.clients.forEach(client => this.sendUpdate(client));\n  }\n\n  sendUpdate(client) {\n    if (client.readyState === 1) {\n      const bundleData = Array.from(this.bundles.entries()).map(([name, bundle]) => ({\n        name,\n        changed: bundle.changed,\n        fileCount: bundle.files.length,\n        content: bundle.content.substring(0, 2000) + (bundle.content.length > 2000 ? '...' : ''),\n        files: bundle.files,\n        lastGenerated: bundle.lastGenerated,\n        size: bundle.size\n      }));\n      client.send(JSON.stringify(bundleData));\n    }\n  }\n\n  cleanup() {\n    this.watchers.forEach(watcher => watcher.close());\n    this.saveBundleStates();\n  }\n}\n\nexport function startServer(options = {}) {\n  const server = new CntxServer(options.cwd);\n  server.init();\n  return server.startServer(options.port);\n}\n\nexport function startMCPServer(options = {}) {\n  const server = new CntxServer(options.cwd);\n  server.init();\n  startMCPTransport(server);\n  return server;\n}\n\nexport function generateBundle(name = 'master', cwd = process.cwd()) {\n  const server = new CntxServer(cwd);\n  server.init();\n  server.generateBundle(name);\n  server.saveBundleStates();\n}\n\nexport function initConfig(cwd = process.cwd()) {\n  console.log('🚀 Starting initConfig...');\n  console.log('📂 Working directory:', cwd);\n\n  const server = new CntxServer(cwd);\n  console.log('📁 CNTX_DIR:', server.CNTX_DIR);\n  console.log('📄 CONFIG_FILE path:', server.CONFIG_FILE);\n\n  const defaultConfig = {\n    bundles: {\n      master: ['**/*']\n    }\n  };\n\n  try {\n    // Create .cntx directory\n    console.log('🔍 Checking if .cntx directory exists...');\n    if (!existsSync(server.CNTX_DIR)) {\n      console.log('📁 Creating .cntx directory...');\n      mkdirSync(server.CNTX_DIR, { recursive: true });\n      console.log('✅ .cntx directory created');\n    } else {\n      console.log('✅ .cntx directory already exists');\n    }\n\n    // List directory contents before writing config\n    console.log('📋 Directory contents before writing config:');\n    const beforeFiles = readdirSync(server.CNTX_DIR);\n    console.log('Files:', beforeFiles);\n\n    // Write config.json\n    console.log('📝 Writing config.json...');\n    console.log('📄 Config content:', JSON.stringify(defaultConfig, null, 2));\n    console.log('📍 Writing to path:', server.CONFIG_FILE);\n\n    writeFileSync(server.CONFIG_FILE, JSON.stringify(defaultConfig, null, 2));\n    console.log('✅ writeFileSync completed');\n\n    // Verify file was created\n    console.log('🔍 Checking if config.json exists...');\n    const configExists = existsSync(server.CONFIG_FILE);\n    console.log('Config exists?', configExists);\n\n    if (configExists) {\n      const configContent = readFileSync(server.CONFIG_FILE, 'utf8');\n      console.log('✅ Config file created successfully');\n      console.log('📖 Config content:', configContent);\n    } else {\n      console.log('❌ Config file was NOT created');\n    }\n\n    // List directory contents after writing config\n    console.log('📋 Directory contents after writing config:');\n    const afterFiles = readdirSync(server.CNTX_DIR);\n    console.log('Files:', afterFiles);\n\n  } catch (error) {\n    console.error('❌ Error in initConfig:', error);\n    console.error('Stack trace:', error.stack);\n    throw error;\n  }\n\n  // Create cursor rules if they don't exist\n  try {\n    if (!existsSync(server.CURSOR_RULES_FILE)) {\n      console.log('📋 Creating cursor rules...');\n      const cursorRules = server.getDefaultCursorRules();\n      server.saveCursorRules(cursorRules);\n      console.log(`📋 Created ${relative(cwd, server.CURSOR_RULES_FILE)} with project-specific rules`);\n    }\n  } catch (error) {\n    console.error('❌ Error creating cursor rules:', error);\n  }\n\n  console.log('✅ cntx-ui initialized');\n  console.log(`📝 Edit ${relative(cwd, server.CONFIG_FILE)} to customize bundles`);\n  console.log(`🚫 Edit ${relative(cwd, server.IGNORE_FILE)} to customize ignored files`);\n  console.log(`🤖 Edit ${relative(cwd, server.CURSOR_RULES_FILE)} to customize AI assistant rules`);\n  console.log(`🎯 Use AI to suggest bundle configurations: run 'cntx-ui bundle master' then use the setup guide`);\n}\n\nexport function getStatus(cwd = process.cwd()) {\n  const server = new CntxServer(cwd);\n  server.init();\n\n  console.log(`📁 Working directory: ${server.CWD}`);\n  console.log(`📦 Bundles configured: ${server.bundles.size}`);\n  server.bundles.forEach((bundle, name) => {\n    const status = bundle.changed ? '🔄 CHANGED' : '✅ SYNCED';\n    console.log(`  ${name}: ${bundle.files.length} files ${status}`);\n  });\n\n  const hasCursorRules = existsSync(server.CURSOR_RULES_FILE);\n  console.log(`🤖 Cursor rules: ${hasCursorRules ? '✅ Configured' : '❌ Not found'}`);\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"test-local.sh\" ext=\".sh\">\n      <cntx:meta size=\"2975\" modified=\"2025-06-07T02:05:09.889Z\" />\n      <cntx:content><![CDATA[#!/bin/bash\n\n# test-local.sh - Script to test cntx-ui locally before publishing\n\nset -e\n\necho \"🧪 Testing cntx-ui locally...\"\n\n# Create a temporary test directory\nTEST_DIR=\"/tmp/cntx-ui-test-$(date +%s)\"\necho \"📁 Creating test directory: $TEST_DIR\"\nmkdir -p \"$TEST_DIR\"\n\n# Create a simple test project\ncd \"$TEST_DIR\"\necho \"📝 Creating test project files...\"\n\n# Create package.json\ncat > package.json << 'EOF'\n{\n  \"name\": \"test-project\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"echo 'dev script'\"\n  }\n}\nEOF\n\n# Create some test files\nmkdir -p src/components src/api docs\necho \"export const hello = 'world'\" > src/index.js\necho \"export const Component = () => <div>Hello</div>\" > src/components/App.jsx\necho \"export const api = () => 'api'\" > src/api/routes.js\necho \"# Test Project\" > README.md\necho \"# Documentation\" > docs/guide.md\n\necho \"✅ Test project created with files:\"\nfind . -type f -name \"*.js\" -o -name \"*.jsx\" -o -name \"*.json\" -o -name \"*.md\" | sort\n\n# Initialize cntx-ui\necho \"🚀 Initializing cntx-ui...\"\ncntx-ui init\n\n# Check if files were created\necho \"🔍 Checking generated files...\"\nif [ -f \".cntx/config.json\" ]; then\n    echo \"✅ Config file created\"\n    cat .cntx/config.json\nelse\n    echo \"❌ Config file not created\"\n    exit 1\nfi\n\nif [ -f \".cntxignore\" ]; then\n    echo \"✅ Ignore file created\"\nelse\n    echo \"❌ Ignore file not created\"\n    exit 1\nfi\n\nif [ -f \".cursorrules\" ]; then\n    echo \"✅ Cursor rules created\"\nelse\n    echo \"❌ Cursor rules not created\"\n    exit 1\nfi\n\n# Test bundle generation\necho \"📦 Testing bundle generation...\"\ncntx-ui bundle master\n\nif [ -f \".cntx/bundles.json\" ]; then\n    echo \"✅ Bundles generated\"\nelse\n    echo \"❌ Bundles not generated\"\n    exit 1\nfi\n\n# Test status command\necho \"📊 Testing status command...\"\ncntx-ui status\n\n# Start server in background and test web interface\necho \"🌐 Testing web server...\"\necho \"Starting server on port 8899...\"\n\n# Kill any existing process on port 8899\nlsof -ti:8899 | xargs kill -9 2>/dev/null || true\n\n# Start server in background\ncntx-ui watch 8899 &\nSERVER_PID=$!\n\n# Wait for server to start\nsleep 3\n\n# Test API endpoints\necho \"🔌 Testing API endpoints...\"\n\n# Test bundles endpoint\nif curl -s http://localhost:8899/api/bundles > /dev/null; then\n    echo \"✅ API endpoint working\"\nelse\n    echo \"❌ API endpoint not working\"\n    kill $SERVER_PID 2>/dev/null\n    exit 1\nfi\n\n# Test web interface\nif curl -s http://localhost:8899/ | grep -q \"cntx-ui\"; then\n    echo \"✅ Web interface accessible\"\nelse\n    echo \"⚠️  Web interface not available (this is OK if web wasn't built)\"\nfi\n\n# Stop server\necho \"🛑 Stopping server...\"\nkill $SERVER_PID 2>/dev/null || true\n\n# Cleanup\necho \"🧹 Cleaning up...\"\ncd /\nrm -rf \"$TEST_DIR\"\n\necho \"\"\necho \"🎉 All tests passed!\"\necho \"✅ cntx-ui is working correctly\"\necho \"\"\necho \"🚀 Ready to publish!\"\necho \"   Run: npm publish\"\necho \"   Or: npm publish --tag beta\"\necho \"\"\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"test-mcp.js\" ext=\".js\">\n      <cntx:meta size=\"1059\" modified=\"2025-06-18T12:10:44.347Z\" />\n      <cntx:content><![CDATA[#!/usr/bin/env node\n\nimport { startMCPServer } from './server.js';\n\n// Test MCP server functionality\nconsole.log('🧪 Testing MCP server...');\n\ntry {\n  // Initialize a test server\n  const server = startMCPServer({ cwd: process.cwd() });\n  \n  // Test basic functionality\n  console.log('✅ MCP server initialized successfully');\n  console.log('📦 Bundles available:', Array.from(server.bundles.keys()));\n  console.log('📁 Working directory:', server.CWD);\n  \n  // Test JSON-RPC message handling\n  const testMessage = {\n    jsonrpc: '2.0',\n    id: 1,\n    method: 'initialize',\n    params: {\n      protocolVersion: '2024-11-05',\n      capabilities: {},\n      clientInfo: {\n        name: 'test-client',\n        version: '1.0.0'\n      }\n    }\n  };\n  \n  console.log('🔄 Testing JSON-RPC message handling...');\n  // The actual MCP server runs on stdio, this is just a structural test\n  console.log('✅ MCP server structure is valid');\n  \n  process.exit(0);\n} catch (error) {\n  console.error('❌ MCP server test failed:', error.message);\n  process.exit(1);\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/README.md\" ext=\".md\">\n      <cntx:meta size=\"1942\" modified=\"2025-06-06T22:55:53.329Z\" />\n      <cntx:content><![CDATA[# React + TypeScript + Vite\n\nThis template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.\n\nCurrently, two official plugins are available:\n\n- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) for Fast Refresh\n- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh\n\n## Expanding the ESLint configuration\n\nIf you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:\n\n```js\nexport default tseslint.config({\n  extends: [\n    // Remove ...tseslint.configs.recommended and replace with this\n    ...tseslint.configs.recommendedTypeChecked,\n    // Alternatively, use this for stricter rules\n    ...tseslint.configs.strictTypeChecked,\n    // Optionally, add this for stylistic rules\n    ...tseslint.configs.stylisticTypeChecked,\n  ],\n  languageOptions: {\n    // other options...\n    parserOptions: {\n      project: ['./tsconfig.node.json', './tsconfig.app.json'],\n      tsconfigRootDir: import.meta.dirname,\n    },\n  },\n})\n```\n\nYou can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:\n\n```js\n// eslint.config.js\nimport reactX from 'eslint-plugin-react-x'\nimport reactDom from 'eslint-plugin-react-dom'\n\nexport default tseslint.config({\n  plugins: {\n    // Add the react-x and react-dom plugins\n    'react-x': reactX,\n    'react-dom': reactDom,\n  },\n  rules: {\n    // other rules...\n    // Enable its recommended typescript rules\n    ...reactX.configs['recommended-typescript'].rules,\n    ...reactDom.configs.recommended.rules,\n  },\n})\n```\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/components.json\" ext=\".json\">\n      <cntx:meta size=\"423\" modified=\"2025-06-06T22:59:43.333Z\" />\n      <cntx:content><![CDATA[{\n  \"$schema\": \"https://ui.shadcn.com/schema.json\",\n  \"style\": \"new-york\",\n  \"rsc\": false,\n  \"tsx\": true,\n  \"tailwind\": {\n    \"config\": \"\",\n    \"css\": \"src/index.css\",\n    \"baseColor\": \"slate\",\n    \"cssVariables\": true,\n    \"prefix\": \"\"\n  },\n  \"aliases\": {\n    \"components\": \"@/components\",\n    \"utils\": \"@/lib/utils\",\n    \"ui\": \"@/components/ui\",\n    \"lib\": \"@/lib\",\n    \"hooks\": \"@/hooks\"\n  },\n  \"iconLibrary\": \"lucide\"\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/eslint.config.js\" ext=\".js\">\n      <cntx:meta size=\"734\" modified=\"2025-06-06T22:55:53.330Z\" />\n      <cntx:content><![CDATA[import js from '@eslint/js'\nimport globals from 'globals'\nimport reactHooks from 'eslint-plugin-react-hooks'\nimport reactRefresh from 'eslint-plugin-react-refresh'\nimport tseslint from 'typescript-eslint'\n\nexport default tseslint.config(\n  { ignores: ['dist'] },\n  {\n    extends: [js.configs.recommended, ...tseslint.configs.recommended],\n    files: ['**/*.{ts,tsx}'],\n    languageOptions: {\n      ecmaVersion: 2020,\n      globals: globals.browser,\n    },\n    plugins: {\n      'react-hooks': reactHooks,\n      'react-refresh': reactRefresh,\n    },\n    rules: {\n      ...reactHooks.configs.recommended.rules,\n      'react-refresh/only-export-components': [\n        'warn',\n        { allowConstantExport: true },\n      ],\n    },\n  },\n)\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/index.html\" ext=\".html\">\n      <cntx:meta size=\"366\" modified=\"2025-06-06T22:55:53.331Z\" />\n      <cntx:content><![CDATA[<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/vite.svg\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Vite + React + TS</title>\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/package.json\" ext=\".json\">\n      <cntx:meta size=\"1138\" modified=\"2025-06-07T01:37:11.847Z\" />\n      <cntx:content><![CDATA[{\n  \"name\": \"web\",\n  \"private\": true,\n  \"version\": \"0.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc -b && vite build\",\n    \"lint\": \"eslint .\",\n    \"preview\": \"vite preview\"\n  },\n  \"dependencies\": {\n    \"@radix-ui/react-label\": \"^2.1.7\",\n    \"@radix-ui/react-slot\": \"^1.2.3\",\n    \"@radix-ui/react-tabs\": \"^1.1.12\",\n    \"@tailwindcss/vite\": \"^4.1.8\",\n    \"@tanstack/react-query\": \"^5.80.6\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"lucide-react\": \"^0.513.0\",\n    \"next-themes\": \"^0.4.6\",\n    \"react\": \"^19.1.0\",\n    \"react-dom\": \"^19.1.0\",\n    \"sonner\": \"^2.0.5\",\n    \"tailwind-merge\": \"^3.3.0\",\n    \"tailwindcss\": \"^4.1.8\"\n  },\n  \"devDependencies\": {\n    \"@eslint/js\": \"^9.25.0\",\n    \"@types/node\": \"^22.15.30\",\n    \"@types/react\": \"^19.1.2\",\n    \"@types/react-dom\": \"^19.1.2\",\n    \"@vitejs/plugin-react\": \"^4.4.1\",\n    \"eslint\": \"^9.25.0\",\n    \"eslint-plugin-react-hooks\": \"^5.2.0\",\n    \"eslint-plugin-react-refresh\": \"^0.4.19\",\n    \"globals\": \"^16.0.0\",\n    \"tw-animate-css\": \"^1.3.4\",\n    \"typescript\": \"~5.8.3\",\n    \"typescript-eslint\": \"^8.30.1\",\n    \"vite\": \"^6.3.5\"\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/App.css\" ext=\".css\">\n      <cntx:meta size=\"606\" modified=\"2025-06-06T22:55:53.333Z\" />\n      <cntx:content><![CDATA[#root {\n  max-width: 1280px;\n  margin: 0 auto;\n  padding: 2rem;\n  text-align: center;\n}\n\n.logo {\n  height: 6em;\n  padding: 1.5em;\n  will-change: filter;\n  transition: filter 300ms;\n}\n.logo:hover {\n  filter: drop-shadow(0 0 2em #646cffaa);\n}\n.logo.react:hover {\n  filter: drop-shadow(0 0 2em #61dafbaa);\n}\n\n@keyframes logo-spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@media (prefers-reduced-motion: no-preference) {\n  a:nth-of-type(2) .logo {\n    animation: logo-spin infinite 20s linear;\n  }\n}\n\n.card {\n  padding: 2em;\n}\n\n.read-the-docs {\n  color: #888;\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/App.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"9042\" modified=\"2025-06-07T04:10:18.082Z\" />\n      <cntx:content><![CDATA[// web/src/App.tsx - Properly Fixed Layout Version\nimport { useEffect, useState } from 'react'\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query'\nimport { BundleList } from './components/BundleList'\nimport { FileTree } from './components/FileTree'\nimport { BundleConfig } from './components/BundleConfig'\nimport { CursorRulesManager } from './components/CursorRulesManager'\nimport { HiddenFilesManager } from './components/HiddenFilesManager'\nimport { SetupBanner, SetupChecklist, UsageGuidance, WorkflowInstructions, QuickCliReference } from './components/SetupComponents'\nimport SetupScreen from './components/SetupScreen'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './components/ui/tabs'\nimport { Card, CardHeader, CardTitle, CardContent } from './components/ui/card'\nimport { Button } from './components/ui/button'\nimport { Toaster } from 'sonner'\nimport { X, HelpCircle, Sparkles, EyeOff } from 'lucide-react'\n\nconst queryClient = new QueryClient()\n\nfunction App() {\n  const [connectionStatus, setConnectionStatus] = useState<'connecting' | 'connected' | 'disconnected'>('connecting')\n  const [showSetupScreen, setShowSetupScreen] = useState(false)\n  const [showHelp, setShowHelp] = useState(false)\n\n  useEffect(() => {\n    // WebSocket connection for real-time updates\n    const ws = new WebSocket('ws://localhost:3333')\n\n    ws.onopen = () => setConnectionStatus('connected')\n    ws.onclose = () => setConnectionStatus('disconnected')\n\n    return () => ws.close()\n  }, [])\n\n  // If setup screen is open, show it full screen\n  if (showSetupScreen) {\n    return (\n      <QueryClientProvider client={queryClient}>\n        <div className=\"relative\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setShowSetupScreen(false)}\n            className=\"absolute top-4 right-4 z-10\"\n          >\n            <X className=\"w-4 h-4\" />\n          </Button>\n          <SetupScreen />\n        </div>\n      </QueryClientProvider>\n    )\n  }\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <div className=\"min-h-screen bg-background text-foreground\">\n        <header className=\"border-b\">\n          <div className=\"container mx-auto px-4 py-4 flex justify-between items-center\">\n            <h1 className=\"text-2xl font-bold\">cntx-ui</h1>\n            <div className=\"flex items-center gap-4\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setShowHelp(!showHelp)}\n              >\n                <HelpCircle className=\"w-4 h-4 mr-1\" />\n                Help\n              </Button>\n              <div className=\"flex items-center gap-2\">\n                <div className={`w-2 h-2 rounded-full ${connectionStatus === 'connected' ? 'bg-green-500' :\n                  connectionStatus === 'connecting' ? 'bg-yellow-500' : 'bg-red-500'\n                  }`} />\n                <span className=\"text-sm text-muted-foreground\">\n                  {connectionStatus === 'connected' ? 'Connected • Watching files' :\n                    connectionStatus === 'connecting' ? 'Connecting...' : 'Disconnected'}\n                </span>\n              </div>\n            </div>\n          </div>\n        </header>\n\n        <main className=\"container mx-auto px-4 py-6\">\n          {/* Setup Banner - shows for first-time users */}\n          <SetupBanner onStartSetup={() => setShowSetupScreen(true)} />\n\n          {/* Fixed Layout using Flexbox instead of Grid */}\n          <div className=\"flex flex-col lg:flex-row gap-6\">\n            <Toaster position=\"top-right\" />\n\n            {/* Main Content - Flexible width */}\n            <div className=\"flex-1 min-w-0\">\n              <Tabs defaultValue=\"bundles\" className=\"space-y-6\">\n                <TabsList className=\"grid w-full grid-cols-5\">\n                  <TabsTrigger value=\"bundles\">Bundles</TabsTrigger>\n                  <TabsTrigger value=\"files\">Files</TabsTrigger>\n                  <TabsTrigger value=\"config\">Config</TabsTrigger>\n                  <TabsTrigger value=\"hidden\" className=\"flex items-center gap-1\">\n                    <EyeOff className=\"w-3 h-3\" />\n                    <span className=\"hidden sm:inline\">Hidden</span>\n                  </TabsTrigger>\n                  <TabsTrigger value=\"cursor\" className=\"flex items-center gap-1\">\n                    <Sparkles className=\"w-3 h-3\" />\n                    <span className=\"hidden sm:inline\">Cursor</span>\n                  </TabsTrigger>\n                </TabsList>\n\n                <TabsContent value=\"bundles\">\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>Bundle Management</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <BundleList />\n                    </CardContent>\n                  </Card>\n                </TabsContent>\n\n                <TabsContent value=\"files\">\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>File Explorer</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <FileTree />\n                    </CardContent>\n                  </Card>\n                </TabsContent>\n\n                <TabsContent value=\"config\">\n                  <BundleConfig />\n                </TabsContent>\n\n                <TabsContent value=\"hidden\">\n                  <HiddenFilesManager />\n                </TabsContent>\n\n                <TabsContent value=\"cursor\">\n                  <CursorRulesManager />\n                </TabsContent>\n              </Tabs>\n            </div>\n\n            {/* Sidebar - Fixed width on large screens */}\n            <div className=\"w-full lg:w-80 xl:w-96 flex-shrink-0 space-y-6\">\n              {/* Setup Status */}\n              <SetupChecklist onOpenFullSetup={() => setShowSetupScreen(true)} />\n\n              {/* Help Panel */}\n              {showHelp && (\n                <div className=\"space-y-4\">\n                  <UsageGuidance />\n                  <WorkflowInstructions />\n                  <QuickCliReference />\n\n                  {/* Hidden Files Quick Info */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <EyeOff className=\"w-4 h-4\" />\n                        File Visibility\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-2\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        Control which files appear in your bundles without changing ignore patterns.\n                      </p>\n                      <div className=\"text-xs space-y-1\">\n                        <div>• Hide debug/temp files from AI context</div>\n                        <div>• Create focused bundles for specific tasks</div>\n                        <div>• Bundle-specific or global hiding</div>\n                        <div>• Easy restore when needed</div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {/* Cursor Rules Quick Info */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <Sparkles className=\"w-4 h-4\" />\n                        AI Assistant\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-2\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        Cursor rules help AI assistants understand your project context and coding preferences.\n                      </p>\n                      <div className=\"text-xs space-y-1\">\n                        <div>• Project structure & bundles</div>\n                        <div>• Coding standards & style</div>\n                        <div>• Framework preferences</div>\n                        <div>• Team conventions</div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>Need More Help?</CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-3\">\n                      <Button\n                        variant=\"outline\"\n                        onClick={() => setShowSetupScreen(true)}\n                        className=\"w-full\"\n                      >\n                        Open Setup Guide\n                      </Button>\n                      <div className=\"text-sm text-muted-foreground\">\n                        For detailed setup instructions and troubleshooting.\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n              )}\n            </div>\n          </div>\n        </main>\n      </div>\n    </QueryClientProvider>\n  )\n}\n\nexport default App\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/BundleConfig.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"25321\" modified=\"2025-06-07T04:44:57.973Z\" />\n      <cntx:content><![CDATA[import { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Input } from './ui/input'\nimport { Badge } from './ui/badge'\nimport { Textarea } from './ui/textarea'\nimport { Trash2, Plus, Save, Eye, AlertTriangle, Settings, X } from 'lucide-react'\nimport { useButtonFeedback } from '../hooks/useButtonFeedback'\nimport { getButtonIcon, getButtonClassName } from '../utils/buttonHelpers'\nimport { toast } from 'sonner'\n\n// Extend Window interface for timeout\ndeclare global {\n  interface Window {\n    patternChangeTimeout?: NodeJS.Timeout\n  }\n}\n\ninterface BundleConfig {\n  bundles: Record<string, string[]>\n}\n\ninterface Bundle {\n  name: string\n  files: string[]\n  size: number\n}\n\nconst fetchConfig = async (): Promise<BundleConfig> => {\n  const response = await fetch('http://localhost:3333/api/config')\n  if (!response.ok) throw new Error('Failed to fetch config')\n  return response.json()\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nconst saveConfig = async (config: BundleConfig): Promise<void> => {\n  const response = await fetch('http://localhost:3333/api/config', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(config)\n  })\n  if (!response.ok) throw new Error('Failed to save config')\n}\n\nconst testPattern = async (pattern: string): Promise<string[]> => {\n  const response = await fetch('http://localhost:3333/api/test-pattern', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ pattern })\n  })\n  if (!response.ok) throw new Error('Failed to test pattern')\n  return response.json()\n}\n\nexport function BundleConfig() {\n  const queryClient = useQueryClient()\n  const [editingConfig, setEditingConfig] = useState<BundleConfig | null>(null)\n  const [testingPattern, setTestingPattern] = useState('')\n  const [testResults, setTestResults] = useState<string[]>([])\n  const [pasteConfigText, setPasteConfigText] = useState('')\n\n  // New bundle creation state\n  const [showAddBundle, setShowAddBundle] = useState(false)\n  const [newBundleName, setNewBundleName] = useState('')\n  const [newBundlePatterns, setNewBundlePatterns] = useState('**/*')\n\n  const { setButtonState, getButtonState, isLoading } = useButtonFeedback()\n\n  const { data: config, isLoading: configLoading } = useQuery({\n    queryKey: ['config'],\n    queryFn: fetchConfig\n  })\n\n  const { data: bundles } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000\n  })\n\n  const saveMutation = useMutation({\n    mutationFn: saveConfig,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      setEditingConfig(null)\n      setButtonState('save', 'success')\n      toast.success('Configuration saved successfully!')\n    },\n    onError: (error) => {\n      setButtonState('save', 'error')\n      toast.error(`Failed to save config: ${error.message}`)\n    }\n  })\n\n  useEffect(() => {\n    if (config && !editingConfig) {\n      setEditingConfig(config)\n    }\n  }, [config])\n\n  const handleSave = () => {\n    if (editingConfig) {\n      setButtonState('save', 'loading')\n      saveMutation.mutate(editingConfig)\n    }\n  }\n\n  const handleTestPattern = async () => {\n    if (!testingPattern.trim()) return\n\n    setButtonState('test', 'loading')\n    try {\n      const results = await testPattern(testingPattern)\n      setTestResults(results)\n      setButtonState('test', 'success')\n      toast.success(`Pattern matched ${results.length} files`)\n    } catch (error) {\n      console.error('Pattern test failed:', error)\n      setTestResults([])\n      setButtonState('test', 'error')\n      toast.error('Failed to test pattern')\n    }\n  }\n\n  const handlePasteConfig = async () => {\n    if (!pasteConfigText.trim()) return\n\n    setButtonState('paste', 'loading')\n    try {\n      const parsed = JSON.parse(pasteConfigText)\n      if (!parsed.bundles || typeof parsed.bundles !== 'object') {\n        throw new Error('Configuration must have a \"bundles\" object')\n      }\n\n      // Ensure master bundle exists\n      if (!parsed.bundles.master) {\n        parsed.bundles.master = ['**/*']\n      }\n\n      setEditingConfig({\n        bundles: Object.fromEntries(\n          Object.entries(parsed.bundles).map(([name, patterns]) => [\n            name,\n            Array.isArray(patterns) ? patterns : [patterns]\n          ])\n        )\n      })\n\n      const bundleCount = Object.keys(parsed.bundles).length\n      setPasteConfigText('')\n      setButtonState('paste', 'success')\n      toast.success(`Applied ${bundleCount} bundles successfully`)\n    } catch (error) {\n      setButtonState('paste', 'error')\n      toast.error(`Invalid configuration: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  // Handle adding new bundle - immediately save to system\n  const handleAddBundle = async () => {\n    if (!editingConfig || !newBundleName.trim()) return\n\n    const trimmedName = newBundleName.trim()\n\n    if (editingConfig.bundles[trimmedName]) {\n      toast.error(`Bundle \"${trimmedName}\" already exists`)\n      return\n    }\n\n    // Parse patterns (split by newlines, filter empty)\n    const patterns = newBundlePatterns\n      .split('\\n')\n      .map(p => p.trim())\n      .filter(p => p.length > 0)\n\n    if (patterns.length === 0) {\n      toast.error('At least one pattern is required')\n      return\n    }\n\n    const newConfig = {\n      ...editingConfig,\n      bundles: {\n        ...editingConfig.bundles,\n        [trimmedName]: patterns\n      }\n    }\n\n    try {\n      // Immediately save to system\n      setButtonState('create-bundle', 'loading')\n      await saveConfig(newConfig)\n\n      // Update local state\n      setEditingConfig(newConfig)\n\n      // Reset form\n      setNewBundleName('')\n      setNewBundlePatterns('**/*')\n      setShowAddBundle(false)\n\n      // Force refresh ALL bundle-related queries\n      await queryClient.invalidateQueries({ queryKey: ['config'] })\n      await queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      await queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n\n      // Also force refetch to ensure immediate update\n      queryClient.refetchQueries({ queryKey: ['bundles'] })\n\n      setButtonState('create-bundle', 'success')\n      toast.success(`Bundle \"${trimmedName}\" created and saved!`)\n    } catch (error) {\n      setButtonState('create-bundle', 'error')\n      toast.error(`Failed to create bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handleDeleteBundle = async (bundleName: string) => {\n    if (!editingConfig || bundleName === 'master') return\n    if (!confirm(`Delete bundle \"${bundleName}\"?`)) return\n\n    try {\n      setButtonState(`delete-${bundleName}`, 'loading')\n\n      // Create new config without the deleted bundle\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { [bundleName]: deleted, ...rest } = editingConfig.bundles\n      const newConfig = { ...editingConfig, bundles: rest }\n\n      // Immediately save to system\n      await saveConfig(newConfig)\n\n      // Update local state\n      setEditingConfig(newConfig)\n\n      // Wait a moment for server to process\n      await new Promise(resolve => setTimeout(resolve, 500))\n\n      // Force clear all cache and refetch\n      queryClient.removeQueries({ queryKey: ['bundles'] })\n      queryClient.removeQueries({ queryKey: ['config'] })\n      queryClient.removeQueries({ queryKey: ['bundle-visibility-stats'] })\n\n      // Force immediate refetch\n      await queryClient.refetchQueries({ queryKey: ['bundles'] })\n      await queryClient.refetchQueries({ queryKey: ['config'] })\n\n      setButtonState(`delete-${bundleName}`, 'success')\n      toast.success(`Bundle \"${bundleName}\" deleted successfully!`)\n    } catch (error) {\n      setButtonState(`delete-${bundleName}`, 'error')\n      toast.error(`Failed to delete bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handlePatternChange = async (bundleName: string, index: number, newPattern: string) => {\n    if (!editingConfig) return\n\n    const newPatterns = [...editingConfig.bundles[bundleName]]\n    newPatterns[index] = newPattern\n    const newConfig = {\n      ...editingConfig,\n      bundles: { ...editingConfig.bundles, [bundleName]: newPatterns }\n    }\n\n    setEditingConfig(newConfig)\n\n    // Debounced save - only save after user stops typing for 1 second\n    clearTimeout(window.patternChangeTimeout)\n    window.patternChangeTimeout = setTimeout(async () => {\n      try {\n        await saveConfig(newConfig)\n        queryClient.invalidateQueries({ queryKey: ['config'] })\n        queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      } catch (error) {\n        toast.error(`Failed to save pattern change: ${error instanceof Error ? error.message : 'Unknown error'}`)\n      }\n    }, 1000)\n  }\n\n  const handleAddPattern = async (bundleName: string) => {\n    if (!editingConfig) return\n\n    const newConfig = {\n      ...editingConfig,\n      bundles: {\n        ...editingConfig.bundles,\n        [bundleName]: [...editingConfig.bundles[bundleName], '']\n      }\n    }\n\n    try {\n      await saveConfig(newConfig)\n      setEditingConfig(newConfig)\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Pattern added')\n    } catch (error) {\n      toast.error(`Failed to add pattern: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handleRemovePattern = async (bundleName: string, index: number) => {\n    if (!editingConfig || editingConfig.bundles[bundleName].length === 1) return\n\n    const newPatterns = editingConfig.bundles[bundleName].filter((_, i) => i !== index)\n    const newConfig = {\n      ...editingConfig,\n      bundles: { ...editingConfig.bundles, [bundleName]: newPatterns }\n    }\n\n    try {\n      await saveConfig(newConfig)\n      setEditingConfig(newConfig)\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Pattern removed')\n    } catch (error) {\n      toast.error(`Failed to remove pattern: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const getBundleStats = (bundleName: string) => {\n    const bundle = bundles?.find(b => b.name === bundleName)\n    return bundle ? { files: bundle.files.length, size: bundle.size } : { files: 0, size: 0 }\n  }\n\n  const formatSize = (bytes: number) => {\n    if (bytes === 0) return '0 B'\n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n  }\n\n  if (configLoading) return <div>Loading configuration...</div>\n  if (!editingConfig) return <div>No configuration found</div>\n\n  const hasChanges = JSON.stringify(config) !== JSON.stringify(editingConfig)\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-lg font-semibold\">Bundle Configuration</h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Define patterns for each bundle. Use glob patterns like *.js, src/**/*.tsx, etc.\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setEditingConfig(config || null)}\n            disabled={!hasChanges}\n          >\n            Reset\n          </Button>\n          <Button\n            onClick={handleSave}\n            disabled={!hasChanges || isLoading('save')}\n            className={getButtonClassName(getButtonState('save'))}\n          >\n            {getButtonIcon(getButtonState('save'), <Save className=\"w-4 h-4\" />)}\n            <span className=\"ml-1\">Save Changes</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Paste Configuration */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Settings className=\"w-4 h-4\" />\n            Paste Bundle Configuration\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Textarea\n            placeholder=\"Paste bundle configuration JSON here...\"\n            value={pasteConfigText}\n            onChange={(e) => setPasteConfigText(e.target.value)}\n            className=\"min-h-32 font-mono text-sm\"\n          />\n          <div className=\"flex gap-2\">\n            <Button\n              onClick={handlePasteConfig}\n              disabled={!pasteConfigText.trim() || isLoading('paste')}\n              className={getButtonClassName(getButtonState('paste'))}\n            >\n              {getButtonIcon(getButtonState('paste'), <Settings className=\"w-4 h-4\" />)}\n              <span className=\"ml-1\">Apply Configuration</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => setPasteConfigText('')}\n              disabled={!pasteConfigText.trim()}\n            >\n              Clear\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Pattern Tester */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Eye className=\"w-4 h-4\" />\n            Pattern Tester\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-2\">\n            <Input\n              placeholder=\"Test a glob pattern (e.g., src/**/*.ts)\"\n              value={testingPattern}\n              onChange={(e) => setTestingPattern(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && handleTestPattern()}\n            />\n            <Button\n              onClick={handleTestPattern}\n              disabled={!testingPattern.trim() || isLoading('test')}\n              className={getButtonClassName(getButtonState('test'))}\n            >\n              {getButtonIcon(getButtonState('test'), <Eye className=\"w-4 h-4\" />)}\n              <span className=\"ml-1\">Test</span>\n            </Button>\n          </div>\n\n          {testResults.length > 0 && (\n            <div className=\"space-y-2\">\n              <div className=\"text-sm font-medium\">\n                Matches {testResults.length} files:\n              </div>\n              <div className=\"max-h-40 overflow-y-auto bg-muted p-3 rounded-md\">\n                {testResults.slice(0, 20).map((file, i) => (\n                  <div key={i} className=\"text-sm font-mono\">{file}</div>\n                ))}\n                {testResults.length > 20 && (\n                  <div className=\"text-sm text-muted-foreground\">\n                    ... and {testResults.length - 20} more files\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Bundle Enhancement Options - NEW SECTION */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Settings className=\"w-4 h-4\" />\n            Bundle Enhancement Options\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {/* Structure & Context */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-sm\">Structure & Context</h4>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Directory Tree</div>\n                    <div className=\"text-xs text-muted-foreground\">Include project structure overview</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+10%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">File Types</div>\n                    <div className=\"text-xs text-muted-foreground\">Auto-detect file purposes</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+5%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Dependencies</div>\n                    <div className=\"text-xs text-muted-foreground\">Import/export mapping</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+25%</Badge>\n                </label>\n              </div>\n            </div>\n\n            {/* AI Instructions */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-sm\">AI Instructions</h4>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" defaultChecked className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Bundle Purpose</div>\n                    <div className=\"text-xs text-muted-foreground\">What this bundle is for</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+2%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" defaultChecked className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Cursor Rules</div>\n                    <div className=\"text-xs text-muted-foreground\">Include .cursorrules content</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+15%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Custom Instructions</div>\n                    <div className=\"text-xs text-muted-foreground\">Bundle-specific AI guidance</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+5%</Badge>\n                </label>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-blue-50 p-3 rounded-md\">\n            <div className=\"text-sm text-blue-800\">\n              <strong>Coming Soon:</strong> These enhancement options will add rich context to your bundles,\n              making them more useful for AI agents. Enable features based on your needs vs. bundle size preferences.\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Bundle Configurations */}\n      <div className=\"space-y-4\">\n        {Object.entries(editingConfig.bundles).map(([bundleName, patterns]) => {\n          const stats = getBundleStats(bundleName)\n          const isLarge = stats.size > 10 * 1024 * 1024\n\n          return (\n            <Card key={bundleName} className={isLarge ? 'border-yellow-500' : ''}>\n              <CardHeader>\n                <div className=\"flex justify-between items-center\">\n                  <div className=\"flex items-center gap-3\">\n                    <CardTitle>{bundleName}</CardTitle>\n                    <Badge variant=\"outline\">\n                      {stats.files} files • {formatSize(stats.size)}\n                    </Badge>\n                    {isLarge && (\n                      <Badge variant=\"destructive\" className=\"flex items-center gap-1\">\n                        <AlertTriangle className=\"w-3 h-3\" />\n                        Large\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleAddPattern(bundleName)}\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                      Add Pattern\n                    </Button>\n                    {bundleName !== 'master' && (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteBundle(bundleName)}\n                        disabled={isLoading(`delete-${bundleName}`)}\n                        className={getButtonClassName(getButtonState(`delete-${bundleName}`))}\n                      >\n                        {getButtonIcon(getButtonState(`delete-${bundleName}`), <Trash2 className=\"w-4 h-4\" />)}\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {patterns.map((pattern, index) => (\n                  <div key={index} className=\"flex gap-2\">\n                    <Input\n                      value={pattern}\n                      onChange={(e) => handlePatternChange(bundleName, index, e.target.value)}\n                      placeholder=\"Glob pattern (e.g., src/**/*.ts)\"\n                      className=\"font-mono\"\n                    />\n                    {patterns.length > 1 && (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleRemovePattern(bundleName, index)}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    )}\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          )\n        })}\n      </div>\n\n      {/* Add New Bundle */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          {!showAddBundle ? (\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowAddBundle(true)}\n              className=\"w-full\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add New Bundle\n            </Button>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between items-center\">\n                <h3 className=\"text-lg font-medium\">Create New Bundle</h3>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => {\n                    setShowAddBundle(false)\n                    setNewBundleName('')\n                    setNewBundlePatterns('**/*')\n                  }}\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div>\n                  <label className=\"text-sm font-medium\">Bundle Name</label>\n                  <Input\n                    placeholder=\"e.g., frontend, backend, tests\"\n                    value={newBundleName}\n                    onChange={(e) => setNewBundleName(e.target.value)}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-medium\">Patterns (one per line)</label>\n                  <Textarea\n                    placeholder=\"src/components/**/*&#10;src/pages/**/*&#10;*.jsx\"\n                    value={newBundlePatterns}\n                    onChange={(e) => setNewBundlePatterns(e.target.value)}\n                    className=\"font-mono text-sm\"\n                    rows={4}\n                  />\n                  <div className=\"text-xs text-muted-foreground mt-1\">\n                    Examples: <code>src/**/*.ts</code>, <code>**/*.test.*</code>, <code>docs/**/*</code>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  onClick={handleAddBundle}\n                  disabled={!newBundleName.trim() || isLoading('create-bundle')}\n                  className={getButtonClassName(getButtonState('create-bundle'))}\n                >\n                  {getButtonIcon(getButtonState('create-bundle'), <Plus className=\"w-4 h-4\" />)}\n                  <span className=\"ml-1\">Create Bundle</span>\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setShowAddBundle(false)\n                    setNewBundleName('')\n                    setNewBundlePatterns('**/*')\n                  }}\n                  disabled={isLoading('create-bundle')}\n                >\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/BundleList.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"10870\" modified=\"2025-06-07T04:25:04.875Z\" />\n      <cntx:content><![CDATA[// web/src/components/BundleList.tsx\nimport { useQuery } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Copy, RefreshCw, ChevronDown, ChevronRight, Loader2, CheckCircle, AlertCircle, Download } from 'lucide-react'\nimport { useState } from 'react'\nimport { toast } from 'sonner'\n\ninterface Bundle {\n  name: string\n  changed: boolean\n  fileCount: number\n  content: string\n  files: string[]\n  lastGenerated: string\n  size: number\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nexport function BundleList() {\n  const { data: bundles, isLoading, refetch } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000,\n  })\n\n  const [expandedBundles, setExpandedBundles] = useState<Set<string>>(new Set())\n  const [loadingButtons, setLoadingButtons] = useState<Set<string>>(new Set())\n  const [successButtons, setSuccessButtons] = useState<Set<string>>(new Set())\n  const [errorButtons, setErrorButtons] = useState<Set<string>>(new Set())\n\n  const toggleExpanded = (bundleName: string) => {\n    const newExpanded = new Set(expandedBundles)\n    if (newExpanded.has(bundleName)) {\n      newExpanded.delete(bundleName)\n    } else {\n      newExpanded.add(bundleName)\n    }\n    setExpandedBundles(newExpanded)\n  }\n\n  const setButtonState = (key: string, state: 'loading' | 'success' | 'error' | 'idle') => {\n    setLoadingButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'loading') newSet.add(key)\n      else newSet.delete(key)\n      return newSet\n    })\n\n    setSuccessButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'success') {\n        newSet.add(key)\n        // Auto-clear success state after 2 seconds\n        setTimeout(() => setSuccessButtons(current => {\n          const updated = new Set(current)\n          updated.delete(key)\n          return updated\n        }), 2000)\n      } else {\n        newSet.delete(key)\n      }\n      return newSet\n    })\n\n    setErrorButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'error') {\n        newSet.add(key)\n        // Auto-clear error state after 3 seconds\n        setTimeout(() => setErrorButtons(current => {\n          const updated = new Set(current)\n          updated.delete(key)\n          return updated\n        }), 3000)\n      } else {\n        newSet.delete(key)\n      }\n      return newSet\n    })\n  }\n\n  const copyBundle = async (bundleName: string) => {\n    const key = `copy-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/bundles/${bundleName}`)\n      if (!response.ok) throw new Error('Failed to fetch bundle content')\n\n      const content = await response.text()\n      await navigator.clipboard.writeText(content)\n\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" copied to clipboard!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to copy bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const downloadBundle = async (bundleName: string) => {\n    const key = `download-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/bundles/${bundleName}`)\n      if (!response.ok) throw new Error('Failed to fetch bundle content')\n\n      const content = await response.text()\n      const blob = new Blob([content], { type: 'application/xml' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `${bundleName}-bundle.xml`\n      a.click()\n      URL.revokeObjectURL(url)\n\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" downloaded!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to download bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const regenerateBundle = async (bundleName: string) => {\n    const key = `regen-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/regenerate/${bundleName}`, {\n        method: 'POST'\n      })\n      if (!response.ok) throw new Error('Failed to regenerate bundle')\n\n      await refetch()\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" regenerated successfully!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to regenerate bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  if (isLoading) return <div>Loading bundles...</div>\n  if (!bundles) return <div>No bundles found</div>\n\n  return (\n    <div className=\"space-y-4\">\n      {bundles.map((bundle) => {\n        const copyKey = `copy-${bundle.name}`\n        const downloadKey = `download-${bundle.name}`\n        const regenKey = `regen-${bundle.name}`\n        const isCopyLoading = loadingButtons.has(copyKey)\n        const isDownloadLoading = loadingButtons.has(downloadKey)\n        const isRegenLoading = loadingButtons.has(regenKey)\n        const isCopySuccess = successButtons.has(copyKey)\n        const isDownloadSuccess = successButtons.has(downloadKey)\n        const isRegenSuccess = successButtons.has(regenKey)\n        const isCopyError = errorButtons.has(copyKey)\n        const isDownloadError = errorButtons.has(downloadKey)\n        const isRegenError = errorButtons.has(regenKey)\n\n        return (\n          <Card key={bundle.name} className={bundle.changed ? 'border-yellow-500' : ''}>\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  {bundle.name}\n                  <Badge variant={bundle.changed ? 'destructive' : 'secondary'}>\n                    {bundle.changed ? 'CHANGED' : 'SYNCED'}\n                  </Badge>\n                </CardTitle>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => regenerateBundle(bundle.name)}\n                    disabled={isRegenLoading}\n                    className={`transition-all duration-200 ${isRegenSuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isRegenError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isRegenLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isRegenLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isRegenSuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isRegenError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <RefreshCw className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Regenerate\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => copyBundle(bundle.name)}\n                    disabled={isCopyLoading}\n                    className={`transition-all duration-200 ${isCopySuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isCopyError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isCopyLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isCopyLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isCopySuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isCopyError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <Copy className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Copy XML\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => downloadBundle(bundle.name)}\n                    disabled={isDownloadLoading}\n                    className={`transition-all duration-200 ${isDownloadSuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isDownloadError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isDownloadLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isDownloadLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isDownloadSuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isDownloadError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <Download className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Download\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-sm text-muted-foreground mb-3\">\n                {bundle.fileCount} files • {(bundle.size / 1024).toFixed(1)}kb\n                {bundle.lastGenerated &&\n                  ` • Generated ${new Date(bundle.lastGenerated).toLocaleTimeString()}`\n                }\n              </div>\n\n              <div className=\"space-y-2\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => toggleExpanded(bundle.name)}\n                  className=\"p-0 h-auto font-normal\"\n                >\n                  {expandedBundles.has(bundle.name) ? (\n                    <ChevronDown className=\"w-4 h-4 mr-1\" />\n                  ) : (\n                    <ChevronRight className=\"w-4 h-4 mr-1\" />\n                  )}\n                  View Files ({bundle.files.length})\n                </Button>\n\n                {expandedBundles.has(bundle.name) && (\n                  <div className=\"ml-5 space-y-1 max-h-40 overflow-y-auto\">\n                    {bundle.files.map((file) => (\n                      <div key={file} className=\"text-sm font-mono text-muted-foreground\">\n                        {file}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        )\n      })}\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/CursorRulesManager.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"15259\" modified=\"2025-06-07T01:48:54.713Z\" />\n      <cntx:content><![CDATA[// Updated CursorRulesManager.tsx\nimport { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Textarea } from './ui/textarea'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs'\nimport { Save, RefreshCw, Copy, Download, Upload, Sparkles, FileText, Info } from 'lucide-react'\nimport { useButtonFeedback } from '../hooks/useButtonFeedback'\nimport { getButtonIcon, getButtonClassName } from '../utils/buttonHelpers'\nimport { toast } from 'sonner'\n\ninterface CursorRulesTemplates {\n  react: string\n  node: string\n  general: string\n}\n\nconst fetchCursorRules = async (): Promise<string> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules')\n  if (!response.ok) throw new Error('Failed to fetch cursor rules')\n  return response.text()\n}\n\nconst saveCursorRules = async (content: string): Promise<void> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ content })\n  })\n  if (!response.ok) throw new Error('Failed to save cursor rules')\n}\n\nconst fetchTemplates = async (): Promise<CursorRulesTemplates> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules/templates')\n  if (!response.ok) throw new Error('Failed to fetch templates')\n  return response.json()\n}\n\nexport function CursorRulesManager() {\n  const queryClient = useQueryClient()\n  const [editingRules, setEditingRules] = useState<string>('')\n  const [selectedTemplate, setSelectedTemplate] = useState<string>('')\n\n  const { setButtonState, getButtonState, isLoading } = useButtonFeedback()\n\n  const { data: currentRules, isLoading: rulesLoading } = useQuery({\n    queryKey: ['cursor-rules'],\n    queryFn: fetchCursorRules\n  })\n\n  const { data: templates } = useQuery({\n    queryKey: ['cursor-templates'],\n    queryFn: fetchTemplates\n  })\n\n  const saveMutation = useMutation({\n    mutationFn: saveCursorRules,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['cursor-rules'] })\n      setButtonState('save', 'success')\n      toast.success('Cursor rules saved successfully!')\n    },\n    onError: (error) => {\n      setButtonState('save', 'error')\n      toast.error(`Failed to save cursor rules: ${error.message}`)\n    }\n  })\n\n  useEffect(() => {\n    if (currentRules && !editingRules) {\n      setEditingRules(currentRules)\n    }\n  }, [currentRules])\n\n  const handleSave = () => {\n    if (editingRules) {\n      setButtonState('save', 'loading')\n      saveMutation.mutate(editingRules)\n    }\n  }\n\n  const handleReset = () => {\n    setEditingRules(currentRules || '')\n    toast.info('Reset to last saved version')\n  }\n\n  const handleLoadTemplate = (templateType: keyof CursorRulesTemplates) => {\n    if (templates && templates[templateType]) {\n      setEditingRules(templates[templateType])\n      setSelectedTemplate(templateType)\n      toast.success(`Loaded ${templateType} template`)\n    }\n  }\n\n  const copyToClipboard = async () => {\n    if (!editingRules) return\n\n    setButtonState('copy', 'loading')\n    try {\n      await navigator.clipboard.writeText(editingRules)\n      setButtonState('copy', 'success')\n      toast.success('Cursor rules copied to clipboard!')\n    } catch (error) {\n      setButtonState('copy', 'error')\n      toast.error('Failed to copy to clipboard')\n    }\n  }\n\n  const downloadRules = () => {\n    setButtonState('download', 'loading')\n    try {\n      const blob = new Blob([editingRules], { type: 'text/plain' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = '.cursorrules'\n      a.click()\n      URL.revokeObjectURL(url)\n      setButtonState('download', 'success')\n      toast.success('Cursor rules downloaded!')\n    } catch (error) {\n      setButtonState('download', 'error')\n      toast.error('Failed to download file')\n    }\n  }\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n\n    setButtonState('upload', 'loading')\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      const content = e.target?.result as string\n      setEditingRules(content)\n      setButtonState('upload', 'success')\n      toast.success('Cursor rules uploaded successfully!')\n    }\n    reader.onerror = () => {\n      setButtonState('upload', 'error')\n      toast.error('Failed to read file')\n    }\n    reader.readAsText(file)\n  }\n\n  if (rulesLoading) return <div>Loading cursor rules...</div>\n\n  const hasChanges = currentRules !== editingRules\n  const wordCount = editingRules.split(/\\s+/).filter(word => word.length > 0).length\n  const lineCount = editingRules.split('\\n').length\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-start\">\n        <div>\n          <h2 className=\"text-lg font-semibold flex items-center gap-2\">\n            <Sparkles className=\"w-5 h-5\" />\n            Cursor Rules Management\n          </h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Configure AI assistant behavior and project context for Cursor IDE\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={handleReset}\n            disabled={!hasChanges}\n          >\n            <RefreshCw className=\"w-4 h-4 mr-1\" />\n            Reset\n          </Button>\n          <Button\n            onClick={handleSave}\n            disabled={!hasChanges || isLoading('save')}\n            className={`bg-purple-600 hover:bg-purple-700 ${getButtonClassName(getButtonState('save'))}`}\n          >\n            {getButtonIcon(getButtonState('save'), <Save className=\"w-4 h-4\" />)}\n            <span className=\"ml-1\">Save Rules</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Status Info */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <FileText className=\"w-4 h-4 text-muted-foreground\" />\n                <span className=\"text-sm text-muted-foreground\">\n                  {lineCount} lines • {wordCount} words\n                </span>\n              </div>\n              {currentRules && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-green-700\">.cursorrules file exists</span>\n                </div>\n              )}\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={copyToClipboard}\n                disabled={isLoading('copy')}\n                className={getButtonClassName(getButtonState('copy'))}\n              >\n                {getButtonIcon(getButtonState('copy'), <Copy className=\"w-4 h-4\" />)}\n                <span className=\"ml-1\">Copy</span>\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={downloadRules}\n                disabled={isLoading('download')}\n                className={getButtonClassName(getButtonState('download'))}\n              >\n                {getButtonIcon(getButtonState('download'), <Download className=\"w-4 h-4\" />)}\n                <span className=\"ml-1\">Download</span>\n              </Button>\n              <label className=\"cursor-pointer\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  asChild\n                  className={getButtonClassName(getButtonState('upload'))}\n                >\n                  <span>\n                    {getButtonIcon(getButtonState('upload'), <Upload className=\"w-4 h-4\" />)}\n                    <span className=\"ml-1\">Upload</span>\n                  </span>\n                </Button>\n                <input\n                  type=\"file\"\n                  accept=\".cursorrules,.txt,.md\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                />\n              </label>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Tabs defaultValue=\"editor\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"editor\">Rules Editor</TabsTrigger>\n          <TabsTrigger value=\"templates\">Templates</TabsTrigger>\n          <TabsTrigger value=\"help\">Help & Examples</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"editor\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Edit Cursor Rules</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {hasChanges && (\n                <Alert className=\"border-yellow-200 bg-yellow-50\">\n                  <Info className=\"w-4 h-4\" />\n                  <AlertDescription>\n                    You have unsaved changes. Click \"Save Rules\" to apply them to your .cursorrules file.\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              <Textarea\n                value={editingRules}\n                onChange={(e) => setEditingRules(e.target.value)}\n                placeholder=\"Enter your cursor rules here...\"\n                className=\"min-h-96 font-mono text-sm\"\n              />\n\n              {selectedTemplate && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">\n                    Template: {selectedTemplate}\n                  </span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setSelectedTemplate('')}\n                  >\n                    Clear\n                  </Button>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"templates\">\n          <div className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Templates</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Choose a template that matches your project type. You can customize it after loading.\n                </p>\n                <div className=\"grid gap-3\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('react')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">React Application</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Modern React with TypeScript, hooks, and Tailwind CSS\n                      </div>\n                    </div>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('node')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">Node.js Backend</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Express/Fastify backend with ES modules and TypeScript\n                      </div>\n                    </div>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('general')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">General Project</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Basic template for any type of project\n                      </div>\n                    </div>\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"help\">\n          <div className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>What are Cursor Rules?</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Cursor rules (.cursorrules) provide context and guidelines to AI assistants like Cursor IDE's AI.\n                  They help the AI understand your project structure, coding preferences, and best practices.\n                </p>\n\n                <div className=\"space-y-3\">\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Best Practices</h4>\n                    <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside\">\n                      <li>Include project context and technology stack</li>\n                      <li>Specify coding standards and naming conventions</li>\n                      <li>Document file organization patterns</li>\n                      <li>Mention important dependencies and frameworks</li>\n                      <li>Include team preferences and architectural decisions</li>\n                    </ul>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Example Sections</h4>\n                    <div className=\"bg-gray-50 p-3 rounded text-xs font-mono\">\n                      # Project Context<br />\n                      # Development Guidelines<br />\n                      # Code Style<br />\n                      # File Organization<br />\n                      # Bundle Context<br />\n                      # AI Assistant Instructions\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Integration with cntx-ui</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-muted-foreground mb-3\">\n                  Your cursor rules automatically include information about your cntx-ui bundle configuration,\n                  helping AI assistants understand your project structure and file organization.\n                </p>\n\n                <Alert>\n                  <Sparkles className=\"w-4 h-4\" />\n                  <AlertDescription>\n                    When you change your bundle configuration, consider updating your cursor rules\n                    to reflect the new project structure and help AI assistants provide better suggestions.\n                  </AlertDescription>\n                </Alert>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/FileTree.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"8572\" modified=\"2025-06-07T02:09:52.648Z\" />\n      <cntx:content><![CDATA[import { useQuery } from '@tanstack/react-query'\nimport { useState } from 'react'\nimport { ChevronDown, ChevronRight, File, Folder, FolderOpen } from 'lucide-react'\nimport { Button } from './ui/button'\nimport { Badge } from './ui/badge'\nimport { Card } from './ui/card'\n\ninterface FileNode {\n  name: string\n  path: string\n  type: 'file' | 'directory'\n  size?: number\n  children?: FileNode[]\n  bundles?: string[]\n}\n\ninterface Bundle {\n  name: string\n  files: string[]\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nconst buildFileTree = (bundles: Bundle[]): FileNode => {\n  const root: FileNode = { name: '', path: '', type: 'directory', children: [] }\n  const allFiles = new Set<string>()\n  const fileBundleMap = new Map<string, string[]>()\n\n  // Collect all files and their bundle associations\n  bundles.forEach(bundle => {\n    bundle.files.forEach(file => {\n      allFiles.add(file)\n      if (!fileBundleMap.has(file)) {\n        fileBundleMap.set(file, [])\n      }\n      fileBundleMap.get(file)!.push(bundle.name)\n    })\n  })\n\n  // Build tree structure\n  allFiles.forEach(filePath => {\n    const parts = filePath.split('/')\n    let current = root\n\n    parts.forEach((part, index) => {\n      const isFile = index === parts.length - 1\n      const currentPath = parts.slice(0, index + 1).join('/')\n\n      if (!current.children) current.children = []\n\n      let existing = current.children.find(child => child.name === part)\n\n      if (!existing) {\n        existing = {\n          name: part,\n          path: currentPath,\n          type: isFile ? 'file' : 'directory',\n          children: isFile ? undefined : [],\n          bundles: isFile ? fileBundleMap.get(filePath) : undefined\n        }\n        current.children.push(existing)\n      }\n\n      if (!isFile) {\n        current = existing\n      }\n    })\n  })\n\n  // Sort: directories first, then files, alphabetically\n  const sortChildren = (node: FileNode) => {\n    if (node.children) {\n      node.children.sort((a, b) => {\n        if (a.type !== b.type) {\n          return a.type === 'directory' ? -1 : 1\n        }\n        return a.name.localeCompare(b.name)\n      })\n      node.children.forEach(sortChildren)\n    }\n  }\n\n  sortChildren(root)\n  return root\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\ninterface FileTreeNodeProps {\n  node: FileNode\n  level: number\n  expandedDirs: Set<string>\n  onToggleDir: (path: string) => void\n}\n\nfunction FileTreeNode({ node, level, expandedDirs, onToggleDir }: FileTreeNodeProps) {\n  const isExpanded = expandedDirs.has(node.path)\n  const indent = level * 16\n\n  if (node.type === 'directory') {\n    return (\n      <div>\n        <div\n          className=\"flex items-center gap-2 py-1 px-2 hover:bg-muted/50 rounded cursor-pointer\"\n          style={{ paddingLeft: `${indent + 8}px` }}\n          onClick={() => onToggleDir(node.path)}\n        >\n          {isExpanded ? (\n            <ChevronDown className=\"w-4 h-4 text-muted-foreground\" />\n          ) : (\n            <ChevronRight className=\"w-4 h-4 text-muted-foreground\" />\n          )}\n          {isExpanded ? (\n            <FolderOpen className=\"w-4 h-4 text-blue-500\" />\n          ) : (\n            <Folder className=\"w-4 h-4 text-blue-500\" />\n          )}\n          <span className=\"text-sm font-medium\">{node.name}</span>\n          {node.children && (\n            <span className=\"text-xs text-muted-foreground ml-auto\">\n              {node.children.length} items\n            </span>\n          )}\n        </div>\n\n        {isExpanded && node.children && (\n          <div>\n            {node.children.map((child) => (\n              <FileTreeNode\n                key={child.path}\n                node={child}\n                level={level + 1}\n                expandedDirs={expandedDirs}\n                onToggleDir={onToggleDir}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // File node\n  const getFileIcon = (filename: string) => {\n    const ext = filename.split('.').pop()?.toLowerCase()\n    const iconClass = \"w-4 h-4\"\n\n    switch (ext) {\n      case 'js':\n      case 'ts':\n      case 'jsx':\n      case 'tsx':\n        return <File className={`${iconClass} text-yellow-500`} />\n      case 'json':\n        return <File className={`${iconClass} text-green-500`} />\n      case 'md':\n        return <File className={`${iconClass} text-blue-400`} />\n      case 'css':\n      case 'scss':\n        return <File className={`${iconClass} text-pink-500`} />\n      case 'html':\n        return <File className={`${iconClass} text-orange-500`} />\n      default:\n        return <File className={`${iconClass} text-muted-foreground`} />\n    }\n  }\n\n  return (\n    <div\n      className=\"flex items-center gap-2 py-1 px-2 hover:bg-muted/50 rounded\"\n      style={{ paddingLeft: `${indent + 24}px` }}\n    >\n      {getFileIcon(node.name)}\n      <span className=\"text-sm font-mono\">{node.name}</span>\n\n      {node.bundles && node.bundles.length > 0 && (\n        <div className=\"flex gap-1 ml-2\">\n          {node.bundles.map(bundle => (\n            <Badge\n              key={bundle}\n              variant=\"outline\"\n              className=\"text-xs px-1 py-0\"\n            >\n              {bundle}\n            </Badge>\n          ))}\n        </div>\n      )}\n\n      {node.size && (\n        <span className=\"text-xs text-muted-foreground ml-auto\">\n          {formatFileSize(node.size)}\n        </span>\n      )}\n    </div>\n  )\n}\n\nexport function FileTree() {\n  const [expandedDirs, setExpandedDirs] = useState<Set<string>>(new Set(['']))\n  // wtf is this shit broseph? \n  // const [showUnbundled, setShowUnbundled] = useState(false)\n\n  const { data: bundles, isLoading } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000,\n  })\n\n  const handleToggleDir = (path: string) => {\n    const newExpanded = new Set(expandedDirs)\n    if (newExpanded.has(path)) {\n      newExpanded.delete(path)\n    } else {\n      newExpanded.add(path)\n    }\n    setExpandedDirs(newExpanded)\n  }\n\n  const expandAll = () => {\n    if (!bundles) return\n    const tree = buildFileTree(bundles)\n    const allDirs = new Set<string>()\n\n    const collectDirs = (node: FileNode) => {\n      if (node.type === 'directory') {\n        allDirs.add(node.path)\n        node.children?.forEach(collectDirs)\n      }\n    }\n\n    collectDirs(tree)\n    setExpandedDirs(allDirs)\n  }\n\n  const collapseAll = () => {\n    setExpandedDirs(new Set(['']))\n  }\n\n  if (isLoading) return <div>Loading file tree...</div>\n  if (!bundles) return <div>No bundles found</div>\n\n  const tree = buildFileTree(bundles)\n  const totalFiles = bundles.reduce((acc, bundle) => acc + bundle.files.length, 0)\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Controls */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" size=\"sm\" onClick={expandAll}>\n            Expand All\n          </Button>\n          <Button variant=\"outline\" size=\"sm\" onClick={collapseAll}>\n            Collapse All\n          </Button>\n        </div>\n\n        <div className=\"text-sm text-muted-foreground\">\n          {totalFiles} files tracked\n        </div>\n      </div>\n\n      {/* File Tree */}\n      <Card className=\"p-4\">\n        <div className=\"space-y-1 max-h-96 overflow-y-auto\">\n          {tree.children && tree.children.length > 0 ? (\n            tree.children.map((child) => (\n              <FileTreeNode\n                key={child.path}\n                node={child}\n                level={0}\n                expandedDirs={expandedDirs}\n                onToggleDir={handleToggleDir}\n              />\n            ))\n          ) : (\n            <div className=\"text-center text-muted-foreground py-8\">\n              No files found\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Bundle Legend */}\n      <Card className=\"p-4\">\n        <h3 className=\"text-sm font-medium mb-2\">Bundle Legend</h3>\n        <div className=\"flex flex-wrap gap-2\">\n          {bundles.map(bundle => (\n            <Badge key={bundle.name} variant=\"outline\">\n              {bundle.name} ({bundle.files.length})\n            </Badge>\n          ))}\n        </div>\n      </Card>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/HiddenFilesManager.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"25316\" modified=\"2025-06-07T04:24:52.900Z\" />\n      <cntx:content><![CDATA[import { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Input } from './ui/input'\nimport { Badge } from './ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs'\nimport {\n  Eye,\n  EyeOff,\n  Search,\n  Plus,\n  Trash2,\n  RotateCcw,\n  FileText,\n  Settings,\n  AlertCircle,\n  CheckCircle,\n  Info,\n} from 'lucide-react'\nimport { toast } from 'sonner'\n\ninterface FileWithVisibility {\n  path: string\n  size: number\n  modified: string\n  visible: boolean\n  globallyHidden: boolean\n  bundleHidden: boolean\n  inBundles: string[]\n  matchesIgnorePattern: boolean\n}\n\ninterface IgnorePattern {\n  pattern: string\n  active: boolean\n}\n\ninterface IgnorePatterns {\n  system: IgnorePattern[]\n  user: IgnorePattern[]\n  file: IgnorePattern[]\n}\n\ninterface BundleStats {\n  total: number\n  visible: number\n  hidden: number\n  patterns: string[]\n}\n\n// API functions\nconst fetchFilesWithVisibility = async (bundleName: string | null = null): Promise<FileWithVisibility[]> => {\n  const url = bundleName\n    ? `http://localhost:3333/api/files-with-visibility?bundle=${bundleName}`\n    : 'http://localhost:3333/api/files-with-visibility'\n  const response = await fetch(url)\n  if (!response.ok) throw new Error('Failed to fetch files')\n  return response.json()\n}\n\nconst fetchIgnorePatterns = async (): Promise<IgnorePatterns> => {\n  const response = await fetch('http://localhost:3333/api/ignore-patterns')\n  if (!response.ok) throw new Error('Failed to fetch ignore patterns')\n  return response.json()\n}\n\nconst fetchBundleVisibilityStats = async (): Promise<Record<string, BundleStats>> => {\n  const response = await fetch('http://localhost:3333/api/bundle-visibility-stats')\n  if (!response.ok) throw new Error('Failed to fetch bundle stats')\n  return response.json()\n}\n\nconst toggleFileVisibility = async ({ filePath, bundleName = null, forceHide = null }: {\n  filePath: string\n  bundleName?: string | null\n  forceHide?: boolean | null\n}) => {\n  const response = await fetch('http://localhost:3333/api/hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      action: 'toggle',\n      filePath,\n      bundleName,\n      forceHide\n    })\n  })\n  if (!response.ok) throw new Error('Failed to toggle file visibility')\n  return response.json()\n}\n\nconst bulkToggleVisibility = async ({ filePaths, bundleName = null, forceHide }: {\n  filePaths: string[]\n  bundleName?: string | null\n  forceHide: boolean\n}) => {\n  const response = await fetch('http://localhost:3333/api/hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      action: 'bulk-toggle',\n      filePaths,\n      bundleName,\n      forceHide\n    })\n  })\n  if (!response.ok) throw new Error('Failed to bulk toggle visibility')\n  return response.json()\n}\n\nconst manageIgnorePattern = async ({ action, pattern }: {\n  action: 'add' | 'remove' | 'toggle-system'\n  pattern: string\n}) => {\n  const response = await fetch('http://localhost:3333/api/ignore-patterns', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ action, pattern })\n  })\n  if (!response.ok) throw new Error('Failed to manage ignore pattern')\n  return response.json()\n}\n\nconst resetHiddenFiles = async ({ scope, bundleName = null }: {\n  scope: 'global' | 'bundle' | 'all'\n  bundleName?: string | null\n}) => {\n  const response = await fetch('http://localhost:3333/api/reset-hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ scope, bundleName })\n  })\n  if (!response.ok) throw new Error('Failed to reset hidden files')\n  return response.json()\n}\n\nexport function HiddenFilesManager() {\n  const queryClient = useQueryClient()\n  const [selectedBundle, setSelectedBundle] = useState<string | null>(null)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [showHidden, setShowHidden] = useState(false)\n  const [filterBy, setFilterBy] = useState('all') // all, hidden, visible\n  const [newPattern, setNewPattern] = useState('')\n  const [selectedFiles, setSelectedFiles] = useState<string[]>([])\n\n  // Queries\n  const { data: files = [], isLoading: filesLoading } = useQuery({\n    queryKey: ['files-with-visibility', selectedBundle],\n    queryFn: () => fetchFilesWithVisibility(selectedBundle),\n    refetchInterval: 5000\n  })\n\n  const { data: ignorePatterns = { system: [], user: [], file: [] }, isLoading: patternsLoading } = useQuery({\n    queryKey: ['ignore-patterns'],\n    queryFn: fetchIgnorePatterns,\n    refetchInterval: 10000\n  })\n\n  const { data: bundleStats = {}, isLoading: statsLoading } = useQuery({\n    queryKey: ['bundle-visibility-stats'],\n    queryFn: fetchBundleVisibilityStats,\n    refetchInterval: 5000\n  })\n\n  // Mutations\n  const toggleFileMutation = useMutation({\n    mutationFn: toggleFileVisibility,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('File visibility updated')\n    },\n    onError: (error: Error) => toast.error(`Failed to update file visibility: ${error.message}`)\n  })\n\n  const bulkToggleMutation = useMutation({\n    mutationFn: bulkToggleVisibility,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      setSelectedFiles([])\n      toast.success('Bulk visibility update completed')\n    },\n    onError: (error: Error) => toast.error(`Failed to bulk update visibility: ${error.message}`)\n  })\n\n  const patternMutation = useMutation({\n    mutationFn: manageIgnorePattern,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['ignore-patterns'] })\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Ignore pattern updated')\n    },\n    onError: (error: Error) => toast.error(`Failed to update ignore pattern: ${error.message}`)\n  })\n\n  const resetMutation = useMutation({\n    mutationFn: resetHiddenFiles,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Hidden files reset successfully')\n    },\n    onError: (error: Error) => toast.error(`Failed to reset hidden files: ${error.message}`)\n  })\n\n  // Filter files\n  const filteredFiles = files.filter(file => {\n    const matchesSearch = file.path.toLowerCase().includes(searchTerm.toLowerCase())\n    const matchesVisibility = filterBy === 'all' ||\n      (filterBy === 'hidden' && !file.visible) ||\n      (filterBy === 'visible' && file.visible)\n    const shouldShow = showHidden || file.visible\n\n    return matchesSearch && matchesVisibility && shouldShow\n  })\n\n  // Handlers\n  const handleToggleFile = (filePath: string) => {\n    toggleFileMutation.mutate({ filePath, bundleName: selectedBundle })\n  }\n\n  const handleBulkToggle = (forceHide: boolean) => {\n    bulkToggleMutation.mutate({\n      filePaths: selectedFiles,\n      bundleName: selectedBundle,\n      forceHide\n    })\n  }\n\n  const handleAddPattern = () => {\n    if (newPattern.trim()) {\n      patternMutation.mutate({ action: 'add', pattern: newPattern.trim() })\n      setNewPattern('')\n    }\n  }\n\n  const handleTogglePattern = (pattern: string, isSystem = false) => {\n    const action = isSystem ? 'toggle-system' : 'remove'\n    patternMutation.mutate({ action, pattern })\n  }\n\n  const allPatterns = [\n    ...(ignorePatterns.system || []).map(p => ({ ...p, source: 'system' as const })),\n    ...(ignorePatterns.user || []).map(p => ({ ...p, source: 'user' as const })),\n    ...(ignorePatterns.file || []).map(p => ({ ...p, source: 'file' as const }))\n  ]\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-lg font-semibold\">File Visibility & Ignore Management</h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Control which files appear in bundles and manage ignore patterns\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n            <Eye className=\"w-3 h-3\" />\n            {filteredFiles.filter(f => f.visible).length} visible\n          </Badge>\n          <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n            <EyeOff className=\"w-3 h-3\" />\n            {filteredFiles.filter(f => !f.visible).length} hidden\n          </Badge>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"files\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"files\">File Visibility</TabsTrigger>\n          <TabsTrigger value=\"patterns\">Ignore Patterns</TabsTrigger>\n          <TabsTrigger value=\"bundles\">Bundle Overview</TabsTrigger>\n        </TabsList>\n\n        {/* File Visibility Tab */}\n        <TabsContent value=\"files\" className=\"space-y-4\">\n          {/* Bundle Selector */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-4 mb-4\">\n                <div className=\"flex items-center gap-2\">\n                  <label className=\"text-sm font-medium\">Bundle:</label>\n                  <select\n                    value={selectedBundle || ''}\n                    onChange={(e) => setSelectedBundle(e.target.value || null)}\n                    className=\"px-3 py-2 border rounded-md text-sm\"\n                  >\n                    <option value=\"\">All Bundles (Global)</option>\n                    {Object.keys(bundleStats).map(bundleName => (\n                      <option key={bundleName} value={bundleName}>{bundleName}</option>\n                    ))}\n                  </select>\n                </div>\n\n                {selectedBundle && (\n                  <Badge variant=\"secondary\">\n                    Bundle-specific visibility for {selectedBundle}\n                  </Badge>\n                )}\n              </div>\n\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      placeholder=\"Search files...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-8\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setShowHidden(!showHidden)}\n                    className={showHidden ? 'bg-blue-50 border-blue-200' : ''}\n                  >\n                    {showHidden ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\n                    {showHidden ? 'Hide Hidden' : 'Show Hidden'}\n                  </Button>\n\n                  <select\n                    value={filterBy}\n                    onChange={(e) => setFilterBy(e.target.value)}\n                    className=\"px-3 py-2 border rounded-md text-sm\"\n                  >\n                    <option value=\"all\">All Files</option>\n                    <option value=\"visible\">Visible Only</option>\n                    <option value=\"hidden\">Hidden Only</option>\n                  </select>\n                </div>\n              </div>\n\n              {/* Bulk Actions */}\n              {selectedFiles.length > 0 && (\n                <div className=\"flex items-center gap-2 p-3 bg-blue-50 rounded-md border border-blue-200 mt-4\">\n                  <Info className=\"w-4 h-4 text-blue-600\" />\n                  <span className=\"text-sm text-blue-800\">\n                    {selectedFiles.length} files selected\n                  </span>\n                  <div className=\"flex gap-2 ml-auto\">\n                    <Button size=\"sm\" onClick={() => handleBulkToggle(false)}>\n                      <Eye className=\"w-4 h-4 mr-1\" />\n                      Show All\n                    </Button>\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => handleBulkToggle(true)}>\n                      <EyeOff className=\"w-4 h-4 mr-1\" />\n                      Hide All\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => setSelectedFiles([])}\n                    >\n                      Cancel\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* File List */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              {filesLoading ? (\n                <div className=\"text-center py-8\">Loading files...</div>\n              ) : (\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {filteredFiles.map((file) => (\n                    <div\n                      key={file.path}\n                      className={`flex items-center gap-3 p-2 rounded-md border transition-colors ${!file.visible ? 'opacity-60 bg-gray-50' : 'hover:bg-gray-50'\n                        }`}\n                    >\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedFiles.includes(file.path)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedFiles([...selectedFiles, file.path])\n                          } else {\n                            setSelectedFiles(selectedFiles.filter(f => f !== file.path))\n                          }\n                        }}\n                        className=\"rounded\"\n                      />\n\n                      <FileText className=\"w-4 h-4 text-muted-foreground flex-shrink-0\" />\n\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"font-mono text-sm truncate\">{file.path}</div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          {file.inBundles.map(bundle => (\n                            <Badge key={bundle} variant=\"outline\" className=\"text-xs\">\n                              {bundle}\n                            </Badge>\n                          ))}\n                          {file.globallyHidden && (\n                            <Badge variant=\"destructive\" className=\"text-xs\">\n                              Globally Hidden\n                            </Badge>\n                          )}\n                          {file.bundleHidden && selectedBundle && (\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              Hidden in {selectedBundle}\n                            </Badge>\n                          )}\n                          {file.matchesIgnorePattern && (\n                            <Badge variant=\"outline\" className=\"text-xs text-gray-500\">\n                              Ignored\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n\n                      <div className=\"text-xs text-muted-foreground\">\n                        {(file.size / 1024).toFixed(1)}kb\n                      </div>\n\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => handleToggleFile(file.path)}\n                        disabled={toggleFileMutation.isPending}\n                        className=\"flex-shrink-0\"\n                      >\n                        {file.visible ? (\n                          <>\n                            <EyeOff className=\"w-4 h-4 mr-1\" />\n                            Hide\n                          </>\n                        ) : (\n                          <>\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Show\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {filteredFiles.length === 0 && !filesLoading && (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  No files match your current filters\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Reset Options */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <RotateCcw className=\"w-4 h-4\" />\n                Reset Options\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => resetMutation.mutate({ scope: 'global' })}\n                  disabled={resetMutation.isPending}\n                >\n                  Reset Global Hidden Files\n                </Button>\n\n                {selectedBundle && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => resetMutation.mutate({ scope: 'bundle', bundleName: selectedBundle })}\n                    disabled={resetMutation.isPending}\n                  >\n                    Reset {selectedBundle} Bundle\n                  </Button>\n                )}\n\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => resetMutation.mutate({ scope: 'all' })}\n                  disabled={resetMutation.isPending}\n                  className=\"text-red-600 border-red-200 hover:bg-red-50\"\n                >\n                  Reset All Hidden Files\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Ignore Patterns Tab */}\n        <TabsContent value=\"patterns\" className=\"space-y-4\">\n          {/* Add New Pattern */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Add Ignore Pattern</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex gap-2\">\n                <Input\n                  placeholder=\"Enter glob pattern (e.g., *.log, src/debug/**)\"\n                  value={newPattern}\n                  onChange={(e) => setNewPattern(e.target.value)}\n                  className=\"flex-1\"\n                  onKeyDown={(e) => e.key === 'Enter' && handleAddPattern()}\n                />\n                <Button\n                  onClick={handleAddPattern}\n                  disabled={!newPattern.trim() || patternMutation.isPending}\n                >\n                  <Plus className=\"w-4 h-4 mr-1\" />\n                  Add Pattern\n                </Button>\n              </div>\n\n              <div className=\"text-sm text-muted-foreground\">\n                Examples: <code>*.log</code>, <code>node_modules/**</code>, <code>src/debug.ts</code>, <code>**/*.test.*</code>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Existing Patterns */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Current Ignore Patterns</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {patternsLoading ? (\n                <div className=\"text-center py-4\">Loading patterns...</div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {allPatterns.map((item, index) => (\n                    <div\n                      key={index}\n                      className={`flex items-center gap-3 p-3 rounded-md border ${!item.active ? 'opacity-60 bg-gray-50' : ''\n                        }`}\n                    >\n                      <div className=\"flex-1\">\n                        <div className=\"font-mono text-sm\">{item.pattern}</div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Badge\n                            variant={item.source === 'system' ? 'secondary' :\n                              item.source === 'user' ? 'default' : 'outline'}\n                            className=\"text-xs\"\n                          >\n                            {item.source === 'system' ? 'System Default' :\n                              item.source === 'user' ? 'User Added' : 'File Pattern'}\n                          </Badge>\n                          {item.active ? (\n                            <Badge variant=\"outline\" className=\"text-xs text-green-700\">\n                              <CheckCircle className=\"w-3 h-3 mr-1\" />\n                              Active\n                            </Badge>\n                          ) : (\n                            <Badge variant=\"outline\" className=\"text-xs text-gray-500\">\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\n                              Disabled\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        {item.source === 'system' ? (\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleTogglePattern(item.pattern, true)}\n                            disabled={patternMutation.isPending}\n                          >\n                            {item.active ? 'Disable' : 'Enable'}\n                          </Button>\n                        ) : (\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleTogglePattern(item.pattern, false)}\n                            disabled={patternMutation.isPending}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Bundle Overview Tab */}\n        <TabsContent value=\"bundles\" className=\"space-y-4\">\n          {statsLoading ? (\n            <div className=\"text-center py-8\">Loading bundle statistics...</div>\n          ) : (\n            <div className=\"grid gap-4\">\n              {Object.entries(bundleStats).map(([bundleName, stats]) => (\n                <Card key={bundleName}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-center\">\n                      <CardTitle>{bundleName}</CardTitle>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant=\"outline\">\n                          {stats.visible} / {stats.total} visible\n                        </Badge>\n                        {stats.hidden > 0 && (\n                          <Badge variant=\"secondary\">\n                            {stats.hidden} hidden\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                          <div\n                            className=\"bg-blue-600 h-2 rounded-full\"\n                            style={{\n                              width: `${stats.total > 0 ? (stats.visible / stats.total) * 100 : 0}%`\n                            }}\n                          />\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => setSelectedBundle(bundleName)}\n                        >\n                          <Settings className=\"w-4 h-4 mr-1\" />\n                          Manage Files\n                        </Button>\n                      </div>\n\n                      <div className=\"text-sm text-muted-foreground\">\n                        <div>Patterns: {stats.patterns.join(', ')}</div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/SetupComponents.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"11375\" modified=\"2025-06-07T04:10:05.940Z\" />\n      <cntx:content><![CDATA[// Updated SetupComponents.tsx with clearer CLI vs UI guidance\n\nimport { useQuery } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { CheckCircle, AlertTriangle, Settings, Play, Terminal, FileText, Monitor, Command } from 'lucide-react'\n\ninterface SetupStatus {\n  hasConfig: boolean\n  hasIgnoreFile: boolean\n  bundleCount: number\n  hasCursorRules: boolean\n  isFirstTime: boolean\n}\n\nconst fetchSetupStatus = async (): Promise<SetupStatus> => {\n  try {\n    const [configResponse, bundlesResponse, cursorResponse] = await Promise.all([\n      fetch('http://localhost:3333/api/config'),\n      fetch('http://localhost:3333/api/bundles'),\n      fetch('http://localhost:3333/api/cursor-rules')\n    ])\n\n    const hasConfig = configResponse.ok\n    const bundles = bundlesResponse.ok ? await bundlesResponse.json() : []\n    const hasCursorRules = cursorResponse.ok\n\n    return {\n      hasConfig,\n      hasIgnoreFile: true, // We can assume this exists if config exists\n      bundleCount: bundles.length || 0,\n      hasCursorRules,\n      isFirstTime: !hasConfig || bundles.length === 0\n    }\n  } catch (error) {\n    return {\n      hasConfig: false,\n      hasIgnoreFile: false,\n      bundleCount: 0,\n      hasCursorRules: false,\n      isFirstTime: true\n    }\n  }\n}\n\ninterface SetupBannerProps {\n  onStartSetup: () => void\n}\n\nexport function SetupBanner({ onStartSetup }: SetupBannerProps) {\n  const { data: status, isLoading } = useQuery({\n    queryKey: ['setup-status'],\n    queryFn: fetchSetupStatus,\n    refetchInterval: 5000,\n  })\n\n  if (isLoading || !status?.isFirstTime) {\n    return null\n  }\n\n  return (\n    <Alert className=\"mb-6 border-blue-200 bg-blue-50\">\n      <Settings className=\"w-4 h-4\" />\n      <AlertDescription className=\"flex items-center justify-between\">\n        <div>\n          <strong>Welcome to cntx-ui!</strong> This looks like your first time.\n          The web interface is already running - let's help you get set up properly.\n        </div>\n        <Button onClick={onStartSetup} size=\"sm\">\n          Start Setup Guide\n        </Button>\n      </AlertDescription>\n    </Alert>\n  )\n}\n\ninterface SetupChecklistProps {\n  onOpenFullSetup: () => void\n}\n\nexport function SetupChecklist({ onOpenFullSetup }: SetupChecklistProps) {\n  const { data: status, isLoading } = useQuery({\n    queryKey: ['setup-status'],\n    queryFn: fetchSetupStatus,\n    refetchInterval: 10000,\n  })\n\n  if (isLoading) {\n    return <div>Checking setup status...</div>\n  }\n\n  const checks = [\n    {\n      label: 'Configuration file exists',\n      passed: status?.hasConfig || false,\n      description: '.cntx/config.json with bundle definitions'\n    },\n    {\n      label: 'Ignore patterns configured',\n      passed: status?.hasIgnoreFile || false,\n      description: '.cntxignore file to exclude unnecessary files'\n    },\n    {\n      label: 'Bundles generated',\n      passed: (status?.bundleCount || 0) > 0,\n      description: `${status?.bundleCount || 0} bundles currently configured`\n    },\n    {\n      label: 'Cursor rules created',\n      passed: status?.hasCursorRules || false,\n      description: '.cursorrules file for AI assistant context'\n    }\n  ]\n\n  const allPassed = checks.every(check => check.passed)\n\n  return (\n    <Card className={!allPassed ? 'border-yellow-200' : ''}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Settings className=\"w-5 h-5\" />\n          Setup Status\n          {allPassed ? (\n            <CheckCircle className=\"w-5 h-5 text-green-500\" />\n          ) : (\n            <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\n          )}\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          {checks.map((check, index) => (\n            <div key={index} className=\"flex items-start gap-3\">\n              <div className=\"flex-shrink-0 mt-0.5\">\n                {check.passed ? (\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                ) : (\n                  <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />\n                )}\n              </div>\n              <div className=\"flex-1\">\n                <div className={`font-medium ${check.passed ? 'text-green-700' : 'text-yellow-700'}`}>\n                  {check.label}\n                </div>\n                <div className=\"text-sm text-gray-600\">{check.description}</div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {!allPassed && (\n          <div className=\"mt-4 pt-4 border-t\">\n            <Button onClick={onOpenFullSetup} variant=\"outline\" className=\"w-full\">\n              <Play className=\"w-4 h-4 mr-2\" />\n              Complete Setup Guide\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\n// CLI vs UI guidance component\nexport function UsageGuidance() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Monitor className=\"w-5 h-5\" />\n          How to Use cntx-ui\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <Alert className=\"border-blue-200 bg-blue-50\">\n          <Terminal className=\"w-4 h-4\" />\n          <AlertDescription>\n            <strong>You're already running!</strong> The web interface provides full functionality.\n            CLI commands are available for automation and advanced workflows.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n              <Monitor className=\"w-4 h-4\" />\n              Web Interface (Recommended)\n            </h4>\n            <div className=\"text-sm text-gray-600 space-y-2\">\n              <p>Perfect for interactive use and project management:</p>\n              <div className=\"ml-4 space-y-1\">\n                <div>• <strong>Bundle Management:</strong> View, create, and manage bundles</div>\n                <div>• <strong>Configuration:</strong> Edit bundle patterns visually</div>\n                <div>• <strong>Hidden Files:</strong> Control file visibility per bundle</div>\n                <div>• <strong>Cursor Rules:</strong> Manage AI assistant context</div>\n                <div>• <strong>Real-time Updates:</strong> See changes immediately</div>\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n              <Command className=\"w-4 h-4\" />\n              Command Line Interface\n            </h4>\n            <div className=\"text-sm text-gray-600 space-y-2\">\n              <p>Great for automation, scripts, and CI/CD:</p>\n              <div className=\"ml-4 space-y-1\">\n                <div>• <strong>Quick bundle generation:</strong> <code className=\"bg-gray-100 px-1 rounded\">cntx-ui bundle master</code></div>\n                <div>• <strong>Status checking:</strong> <code className=\"bg-gray-100 px-1 rounded\">cntx-ui status</code></div>\n                <div>• <strong>Scripting workflows:</strong> Integrate with build processes</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Quick CLI reference for advanced users\nexport function QuickCliReference() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Terminal className=\"w-5 h-5\" />\n          CLI Reference\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3 text-sm font-mono\">\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui watch</code>\n            <span className=\"text-gray-600 text-xs\">Start server (already running)</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui status</code>\n            <span className=\"text-gray-600 text-xs\">Check configuration status</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui bundle [name]</code>\n            <span className=\"text-gray-600 text-xs\">Generate specific bundle</span>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Workflow instructions component\nexport function WorkflowInstructions() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <FileText className=\"w-5 h-5\" />\n          Common Workflows\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div>\n          <h4 className=\"font-medium mb-2\">🎯 For AI Development</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Create focused bundles (api, ui, core)</div>\n            <div>2. Hide debug/temp files from bundles</div>\n            <div>3. Copy bundle XML for AI context</div>\n            <div>4. Use Cursor Rules for project context</div>\n          </div>\n        </div>\n\n        <div>\n          <h4 className=\"font-medium mb-2\">📁 For Project Organization</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Configure ignore patterns for unwanted files</div>\n            <div>2. Create bundles by feature or responsibility</div>\n            <div>3. Use hidden files to trim bundle scope</div>\n            <div>4. Monitor bundle sizes and file counts</div>\n          </div>\n        </div>\n\n        <div>\n          <h4 className=\"font-medium mb-2\">🤖 For CI/CD Integration</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Use CLI commands in build scripts</div>\n            <div>2. Generate bundles for automated testing</div>\n            <div>3. Export project context for deployment</div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Installation reminder for new users\nexport function InstallationReminder() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>First Time Setup</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <Alert className=\"border-green-200 bg-green-50\">\n          <CheckCircle className=\"w-4 h-4\" />\n          <AlertDescription>\n            <strong>You're all set!</strong> cntx-ui is installed and running.\n            Use this web interface for full functionality.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"text-sm text-gray-600\">\n          <p className=\"mb-2\"><strong>For new projects:</strong></p>\n          <div className=\"ml-4 space-y-1\">\n            <div>1. Install: <code className=\"bg-gray-100 px-1 rounded\">npm install -g cntx-ui</code></div>\n            <div>2. Initialize: <code className=\"bg-gray-100 px-1 rounded\">cntx-ui init</code></div>\n            <div>3. Start: <code className=\"bg-gray-100 px-1 rounded\">cntx-ui watch</code></div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Legacy components for backward compatibility\nexport const QuickSetupTips = QuickCliReference\nexport const UsageInstructions = WorkflowInstructions\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/SetupScreen.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"31165\" modified=\"2025-06-07T04:53:40.702Z\" />\n      <cntx:content><![CDATA[import { useState } from 'react'\nimport { CheckCircle, Circle, Copy, Monitor, FolderOpen, Settings, ArrowRight, ExternalLink, AlertTriangle, Play, Sparkles, Eye, FileText, Zap, Download } from 'lucide-react'\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\n\ninterface SetupStep {\n  id: string\n  title: string\n  description: string\n  completed: boolean\n  required: boolean\n}\n\nexport default function SetupScreen() {\n  const [currentStep, setCurrentStep] = useState(0)\n  const [setupSteps, setSetupSteps] = useState<SetupStep[]>([\n    {\n      id: 'welcome',\n      title: 'Welcome to cntx-ui',\n      description: 'Learn what you can do with the web interface',\n      completed: false,\n      required: true\n    },\n    {\n      id: 'ai-analysis',\n      title: 'AI Bundle Analysis',\n      description: 'Let AI analyze your code and suggest optimal bundles',\n      completed: false,\n      required: false\n    },\n    {\n      id: 'bundles',\n      title: 'Create & Manage Bundles',\n      description: 'Set up focused file collections for AI development',\n      completed: false,\n      required: true\n    },\n    {\n      id: 'optimization',\n      title: 'Fine-tune & Optimize',\n      description: 'Configure file visibility and AI assistant context',\n      completed: false,\n      required: false\n    },\n    {\n      id: 'workflows',\n      title: 'Explore Workflows',\n      description: 'Learn common patterns and best practices',\n      completed: false,\n      required: false\n    }\n  ])\n\n  const [aiPromptCopied, setAiPromptCopied] = useState(false)\n  const [masterBundleCopied, setMasterBundleCopied] = useState(false)\n\n  const copyAiPrompt = async () => {\n    const prompt = `Analyze this codebase bundle and suggest an optimal bundle configuration for cntx-ui.\n\nBased on the file structure and content, recommend 3-6 meaningful bundles with glob patterns that group related files logically.\n\nConsider these common bundle types:\n- Frontend/UI components and pages\n- Backend API routes and controllers  \n- Configuration files\n- Documentation\n- Tests\n- Utilities/helpers\n- Styles/assets\n\nReturn ONLY a JSON configuration in this exact format:\n{\n  \"bundles\": {\n    \"master\": [\"**/*\"],\n    \"frontend\": [\"src/components/**/*\", \"src/pages/**/*\", \"src/hooks/**/*\"],\n    \"api\": [\"src/api/**/*\", \"routes/**/*\", \"controllers/**/*\"],\n    \"config\": [\"*.config.*\", \"package.json\", \"tsconfig.json\"],\n    \"docs\": [\"README.md\", \"docs/**/*\", \"*.md\"],\n    \"tests\": [\"**/*.test.*\", \"**/*.spec.*\", \"__tests__/**/*\"]\n  }\n}\n\nPlease analyze the following master bundle and suggest appropriate bundles:\n\n[PASTE YOUR MASTER BUNDLE XML CONTENT HERE]`\n\n    try {\n      await navigator.clipboard.writeText(prompt)\n      setAiPromptCopied(true)\n      setTimeout(() => setAiPromptCopied(false), 3000)\n    } catch (err) {\n      console.error('Failed to copy AI prompt:', err)\n    }\n  }\n\n  const copyMasterBundle = async () => {\n    try {\n      const response = await fetch('http://localhost:3333/api/bundles/master')\n      if (!response.ok) throw new Error('Failed to fetch master bundle')\n\n      const xmlContent = await response.text()\n      await navigator.clipboard.writeText(xmlContent)\n      setMasterBundleCopied(true)\n      setTimeout(() => setMasterBundleCopied(false), 3000)\n    } catch (err) {\n      console.error('Failed to copy master bundle:', err)\n    }\n  }\n\n  const downloadMasterBundle = async () => {\n    try {\n      const response = await fetch('http://localhost:3333/api/bundles/master')\n      if (!response.ok) throw new Error('Failed to fetch master bundle')\n\n      const xmlContent = await response.text()\n      const blob = new Blob([xmlContent], { type: 'application/xml' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = 'master-bundle.xml'\n      a.click()\n      URL.revokeObjectURL(url)\n    } catch (err) {\n      console.error('Failed to download master bundle:', err)\n    }\n  }\n\n\n  const markStepComplete = (stepId: string) => {\n    setSetupSteps(prev => prev.map(step =>\n      step.id === stepId ? { ...step, completed: true } : step\n    ))\n  }\n\n  const StepIndicator = ({ step, isActive }: { step: SetupStep, isActive: boolean }) => (\n    <div className={`flex items-center gap-3 p-3 rounded-lg transition-colors ${isActive ? 'bg-blue-50 border border-blue-200' : 'hover:bg-gray-50'\n      }`}>\n      <div className=\"flex-shrink-0\">\n        {step.completed ? (\n          <CheckCircle className=\"w-6 h-6 text-green-500\" />\n        ) : (\n          <Circle className={`w-6 h-6 ${isActive ? 'text-blue-500' : 'text-gray-300'}`} />\n        )}\n      </div>\n      <div className=\"flex-1\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className={`font-medium ${isActive ? 'text-blue-900' : 'text-gray-900'}`}>\n            {step.title}\n          </h3>\n          {step.required && (\n            <Badge variant=\"outline\" className=\"text-xs\">Required</Badge>\n          )}\n        </div>\n        <p className=\"text-sm text-gray-600\">{step.description}</p>\n      </div>\n    </div>\n  )\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-2\">Welcome to cntx-ui</h1>\n          <p className=\"text-lg text-gray-600 max-w-2xl mx-auto\">\n            You're already up and running! Let's explore what you can do with the web interface.\n          </p>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-8 max-w-7xl mx-auto\">\n          {/* Steps Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Settings className=\"w-5 h-5\" />\n                  Quick Tour\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                {setupSteps.map((step, index) => (\n                  <div\n                    key={step.id}\n                    onClick={() => setCurrentStep(index)}\n                    className=\"cursor-pointer\"\n                  >\n                    <StepIndicator step={step} isActive={currentStep === index} />\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Step 1: Welcome */}\n            {currentStep === 0 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5\" />\n                    Welcome! You're Already Running\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <Alert className=\"border-green-200 bg-green-50\">\n                    <CheckCircle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Great news!</strong> cntx-ui is installed and the web interface is running.\n                      No command line setup needed - you can do everything from this interface.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <Card className=\"border-blue-200\">\n                      <CardContent className=\"pt-6\">\n                        <Monitor className=\"w-8 h-8 text-blue-600 mb-3\" />\n                        <h3 className=\"font-medium mb-2\">Web Interface</h3>\n                        <p className=\"text-sm text-gray-600\">\n                          Full-featured interface for managing bundles, files, and AI context. Perfect for interactive use.\n                        </p>\n                      </CardContent>\n                    </Card>\n\n                    <Card className=\"border-gray-200\">\n                      <CardContent className=\"pt-6\">\n                        <FileText className=\"w-8 h-8 text-gray-600 mb-3\" />\n                        <h3 className=\"font-medium mb-2\">Command Line</h3>\n                        <p className=\"text-sm text-gray-600\">\n                          Available for automation, scripts, and CI/CD workflows. Optional for advanced users.\n                        </p>\n                      </CardContent>\n                    </Card>\n                  </div>\n\n                  <div className=\"bg-blue-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-blue-900 mb-2\">What is cntx-ui?</h4>\n                    <p className=\"text-sm text-blue-800 mb-3\">\n                      cntx-ui helps you organize your codebase for AI development by creating focused file bundles.\n                      Think of it as intelligent project packaging for AI assistants like Claude, ChatGPT, or Cursor.\n                    </p>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm text-blue-800\">\n                      <div>• Bundle files by purpose or feature</div>\n                      <div>• Hide irrelevant files from AI context</div>\n                      <div>• Generate XML packages for AI tools</div>\n                      <div>• Manage project context efficiently</div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" disabled>Previous</Button>\n                    <Button onClick={() => { markStepComplete('welcome'); setCurrentStep(1); }}>\n                      Let's Start <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 2: AI Bundle Analysis */}\n            {currentStep === 1 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5\" />\n                    Let AI Analyze Your Code & Suggest Bundles\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Let AI examine your entire codebase and intelligently suggest\n                      the perfect bundle configuration based on your project structure.\n                    </p>\n\n                    <Alert className=\"border-purple-200 bg-purple-50\">\n                      <Sparkles className=\"w-4 h-4\" />\n                      <AlertDescription>\n                        <strong>🎯 AI-Powered Bundle Design:</strong> Instead of guessing what bundles to create,\n                        let AI analyze your code structure and suggest optimal groupings.\n                      </AlertDescription>\n                    </Alert>\n                  </div>\n\n                  <div className=\"bg-blue-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-blue-900 mb-3\">Here's the workflow:</h4>\n                    <ol className=\"text-sm text-blue-800 space-y-2 list-decimal list-inside\">\n                      <li><strong>Copy the AI analysis prompt</strong> (button below)</li>\n                      <li><strong>Go to Bundles tab</strong> → Copy the \"master\" bundle XML</li>\n                      <li><strong>Open Claude/ChatGPT</strong> → Paste the prompt</li>\n                      <li><strong>Paste your master bundle XML</strong> after the prompt</li>\n                      <li><strong>AI returns perfect bundle JSON</strong> tailored to your code!</li>\n                      <li><strong>Go to Config tab</strong> → Paste the JSON → Apply!</li>\n                    </ol>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Step 1: Copy AI Prompt & Master Bundle</h4>\n                    <div className=\"space-y-3\">\n                      <div className=\"bg-slate-900 rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <span className=\"text-green-400 text-sm\">🤖 Smart Bundle Analysis Prompt</span>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={copyAiPrompt}\n                            className=\"text-gray-400 hover:text-white\"\n                          >\n                            {aiPromptCopied ? (\n                              <>\n                                <CheckCircle className=\"w-4 h-4 mr-1\" />\n                                Copied!\n                              </>\n                            ) : (\n                              <>\n                                <Copy className=\"w-4 h-4 mr-1\" />\n                                Copy Prompt\n                              </>\n                            )}\n                          </Button>\n                        </div>\n                        <div className=\"text-gray-300 text-sm\">\n                          Intelligent prompt that guides AI to analyze your code structure\n                        </div>\n                      </div>\n\n                      <div className=\"bg-slate-900 rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <span className=\"text-blue-400 text-sm\">📦 Master Bundle XML</span>\n                          <div className=\"flex gap-2\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={copyMasterBundle}\n                              className=\"text-gray-400 hover:text-white\"\n                            >\n                              {masterBundleCopied ? (\n                                <>\n                                  <CheckCircle className=\"w-4 h-4 mr-1\" />\n                                  Copied!\n                                </>\n                              ) : (\n                                <>\n                                  <Copy className=\"w-4 h-4 mr-1\" />\n                                  Copy XML\n                                </>\n                              )}\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={downloadMasterBundle}\n                              className=\"text-gray-400 hover:text-white\"\n                            >\n                              <Download className=\"w-4 h-4 mr-1\" />\n                              Download\n                            </Button>\n                          </div>\n                        </div>\n                        <div className=\"text-gray-300 text-sm\">\n                          Your complete codebase bundle for AI analysis\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\n                    <h4 className=\"font-medium text-purple-900 mb-2\">🚀 Complete AI Workflow:</h4>\n                    <ol className=\"text-sm text-purple-800 space-y-1 list-decimal list-inside\">\n                      <li><strong>Copy the prompt above</strong> → Paste into Claude/ChatGPT</li>\n                      <li><strong>Copy/download master bundle</strong> → Add to your AI conversation</li>\n                      <li><strong>AI analyzes your code</strong> → Returns perfect bundle configuration</li>\n                      <li><strong>Go to Config tab</strong> → Paste AI's JSON → Apply configuration</li>\n                      <li><strong>🎉 Optimized bundles ready!</strong> → Tailored to your project structure</li>\n                    </ol>\n                  </div>\n\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium\">What AI Analyzes:</h4>\n                      <div className=\"text-sm space-y-1\">\n                        <div>🗂️ <strong>File organization patterns</strong></div>\n                        <div>🔗 <strong>Import/dependency relationships</strong></div>\n                        <div>⚙️ <strong>Technology stack detection</strong></div>\n                        <div>📁 <strong>Logical grouping opportunities</strong></div>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium\">AI Suggests Bundles Like:</h4>\n                      <div className=\"text-sm space-y-1\">\n                        <div>🎨 <strong>frontend</strong> - Components, pages, styles</div>\n                        <div>🔌 <strong>api</strong> - Routes, controllers, models</div>\n                        <div>🧪 <strong>tests</strong> - All test files</div>\n                        <div>⚙️ <strong>config</strong> - Configuration files</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <Alert>\n                    <AlertTriangle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Why this works so well:</strong> AI understands code patterns and can see relationships\n                      between files that aren't obvious. It creates bundles that actually make sense for your specific project.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(0)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('ai-analysis'); setCurrentStep(2); }}>\n                      Continue to Bundle Management <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 3: Create/Manage Bundles */}\n            {currentStep === 2 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <FolderOpen className=\"w-5 h-5\" />\n                    Create & Manage Your Bundles\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Whether you used AI suggestions or want to create bundles manually,\n                      here's how to manage your bundle collection.\n                    </p>\n\n                    <div className=\"bg-green-50 p-4 rounded-lg mb-4\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">If you used AI analysis:</h4>\n                      <ol className=\"text-sm text-green-800 space-y-1 list-decimal list-inside\">\n                        <li>Go to the <strong>Config</strong> tab above</li>\n                        <li>Scroll to <strong>\"Paste Bundle Configuration\"</strong></li>\n                        <li>Paste the AI-generated JSON</li>\n                        <li>Click <strong>\"Apply Configuration\"</strong></li>\n                        <li>🎉 Your optimized bundles are ready!</li>\n                      </ol>\n                    </div>\n\n                    <div className=\"bg-blue-50 p-4 rounded-lg mb-4\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">To create bundles manually:</h4>\n                      <ol className=\"text-sm text-blue-800 space-y-1 list-decimal list-inside\">\n                        <li>Go to the <strong>Config</strong> tab above</li>\n                        <li>Click <strong>\"Add New Bundle\"</strong> at the bottom</li>\n                        <li>Name it something meaningful (e.g., \"frontend\", \"api\", \"core\")</li>\n                        <li>Add patterns like <code className=\"bg-blue-100 px-1 rounded\">src/components/**/*</code></li>\n                        <li>Click <strong>\"Create Bundle\"</strong></li>\n                      </ol>\n                    </div>\n\n                    <Alert>\n                      <Sparkles className=\"w-4 h-4\" />\n                      <AlertDescription>\n                        <strong>Pro tip:</strong> You can test patterns before adding them!\n                        Use the \"Pattern Tester\" in the Config tab to see which files match.\n                      </AlertDescription>\n                    </Alert>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <h4 className=\"font-medium\">Popular Manual Bundle Examples:</h4>\n                    <div className=\"grid gap-3\">\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">Frontend Bundle</div>\n                        <code className=\"text-xs text-gray-600\">src/components/**/* • src/pages/**/* • *.css</code>\n                      </div>\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">API Bundle</div>\n                        <code className=\"text-xs text-gray-600\">src/api/**/* • src/routes/**/* • src/models/**/*</code>\n                      </div>\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">Tests Bundle</div>\n                        <code className=\"text-xs text-gray-600\">**/*.test.* • **/*.spec.* • __tests__/**/*</code>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(1)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('bundles'); setCurrentStep(3); }}>\n                      Continue to Optimization <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 4: Optimization */}\n            {currentStep === 3 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Zap className=\"w-5 h-5\" />\n                    Optimize for AI Development\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Now let's make your bundles perfect for AI assistants by controlling what they see.\n                    </p>\n\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      <Card className=\"border-purple-200\">\n                        <CardContent className=\"pt-6\">\n                          <Eye className=\"w-8 h-8 text-purple-600 mb-3\" />\n                          <h3 className=\"font-medium mb-2\">Hidden Files Tab</h3>\n                          <div className=\"text-sm text-gray-600 space-y-1\">\n                            <div>• Hide debug files from AI context</div>\n                            <div>• Remove temp/generated files</div>\n                            <div>• Create clean, focused bundles</div>\n                          </div>\n                        </CardContent>\n                      </Card>\n\n                      <Card className=\"border-green-200\">\n                        <CardContent className=\"pt-6\">\n                          <Sparkles className=\"w-8 h-8 text-green-600 mb-3\" />\n                          <h3 className=\"font-medium mb-2\">Cursor Rules Tab</h3>\n                          <div className=\"text-sm text-gray-600 space-y-1\">\n                            <div>• Set coding standards</div>\n                            <div>• Define project context</div>\n                            <div>• Guide AI assistant behavior</div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-green-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-green-900 mb-2\">Try this workflow:</h4>\n                    <ol className=\"text-sm text-green-800 space-y-1 list-decimal list-inside\">\n                      <li>Go to <strong>Hidden Files</strong> tab</li>\n                      <li>Search for \"debug\" or \"test\" files</li>\n                      <li>Hide them from your main bundles</li>\n                      <li>Go to <strong>Cursor Rules</strong> tab</li>\n                      <li>Choose a template that matches your project</li>\n                      <li>Customize the rules for your team's preferences</li>\n                    </ol>\n                  </div>\n\n                  <Alert>\n                    <AlertTriangle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Why this matters:</strong> Clean bundles = better AI responses.\n                      Removing noise helps AI focus on what's actually important in your code.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(2)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('optimization'); setCurrentStep(4); }}>\n                      Continue <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 5: Workflows */}\n            {currentStep === 4 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Play className=\"w-5 h-5\" />\n                    Common Workflows & Next Steps\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"grid gap-4\">\n                    <div className=\"bg-blue-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">🤖 Using with AI Assistants</h4>\n                      <div className=\"text-sm text-blue-800 space-y-1\">\n                        <div>1. Create a focused bundle for your current task</div>\n                        <div>2. Copy the XML from the <strong>Bundles</strong> tab</div>\n                        <div>3. Paste into Claude, ChatGPT, or other AI tools</div>\n                        <div>4. Get more accurate, context-aware responses</div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-purple-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-purple-900 mb-2\">📁 Organizing Large Projects</h4>\n                      <div className=\"text-sm text-purple-800 space-y-1\">\n                        <div>1. Create bundles by feature or team responsibility</div>\n                        <div>2. Use hidden files to exclude work-in-progress code</div>\n                        <div>3. Monitor bundle sizes in the web interface</div>\n                        <div>4. Share specific bundles with team members</div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-green-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">⚡ Advanced Tips</h4>\n                      <div className=\"text-sm text-green-800 space-y-1\">\n                        <div>• Bundle-specific hiding: Hide files from specific bundles only</div>\n                        <div>• Pattern testing: Use the pattern tester in Config tab</div>\n                        <div>• Real-time updates: Changes appear immediately</div>\n                        <div>• CLI integration: Use commands for automation</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\n                    <h4 className=\"font-medium text-yellow-900 mb-2\">🎯 Quick Start Checklist</h4>\n                    <div className=\"text-sm text-yellow-800 space-y-1\">\n                      <div>✅ Create 2-3 focused bundles</div>\n                      <div>✅ Hide debug/temp files</div>\n                      <div>✅ Set up cursor rules</div>\n                      <div>✅ Copy a bundle and try it with an AI assistant</div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(3)}>Previous</Button>\n                    <Button onClick={() => markStepComplete('workflows')} className=\"bg-green-600 hover:bg-green-700\">\n                      Get Started! <ExternalLink className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Quick Reference Card */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Quick Reference</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid md:grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Web Interface Tabs</h4>\n                    <ul className=\"space-y-1 text-gray-600\">\n                      <li><strong>Bundles</strong> - View and copy bundle content</li>\n                      <li><strong>Files</strong> - Browse your project files</li>\n                      <li><strong>Config</strong> - Create and edit bundles</li>\n                      <li><strong>Hidden</strong> - Control file visibility</li>\n                      <li><strong>Cursor</strong> - Manage AI assistant rules</li>\n                    </ul>\n                  </div>\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Key Features</h4>\n                    <ul className=\"space-y-1 text-gray-600\">\n                      <li>Real-time file watching and updates</li>\n                      <li>Bundle-specific file hiding</li>\n                      <li>Pattern testing and validation</li>\n                      <li>AI assistant context management</li>\n                      <li>XML export for AI tools</li>\n                    </ul>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/alert.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1614\" modified=\"2025-06-06T23:18:00.618Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/badge.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1631\" modified=\"2025-06-06T23:02:18.357Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/button.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"2123\" modified=\"2025-06-06T23:02:18.326Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/card.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1989\" modified=\"2025-06-06T22:59:58.927Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/input.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"967\" modified=\"2025-06-06T23:18:00.535Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/label.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"597\" modified=\"2025-06-06T23:18:00.593Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/sonner.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"555\" modified=\"2025-06-07T02:10:25.582Z\" />\n      <cntx:content><![CDATA[import { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, type ToasterProps } from \"sonner\"\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      style={\n        {\n          \"--normal-bg\": \"var(--popover)\",\n          \"--normal-text\": \"var(--popover-foreground)\",\n          \"--normal-border\": \"var(--border)\",\n        } as React.CSSProperties\n      }\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/tabs.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1955\" modified=\"2025-06-06T22:59:58.902Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/textarea.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"759\" modified=\"2025-06-06T23:18:00.602Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/hooks/useButtonFeedback.ts\" ext=\".ts\">\n      <cntx:meta size=\"1123\" modified=\"2025-06-07T01:43:23.151Z\" />\n      <cntx:content><![CDATA[// hooks/useButtonFeedback.ts\nimport { useState } from 'react'\n\nexport type ButtonState = 'idle' | 'loading' | 'success' | 'error'\n\nexport function useButtonFeedback() {\n  const [buttonStates, setButtonStates] = useState<Record<string, ButtonState>>(\n    {}\n  )\n\n  const setButtonState = (key: string, state: ButtonState) => {\n    setButtonStates((prev) => ({ ...prev, [key]: state }))\n\n    // Auto-clear success/error states\n    if (state === 'success') {\n      setTimeout(() => {\n        setButtonStates((prev) => ({ ...prev, [key]: 'idle' }))\n      }, 2000)\n    } else if (state === 'error') {\n      setTimeout(() => {\n        setButtonStates((prev) => ({ ...prev, [key]: 'idle' }))\n      }, 3000)\n    }\n  }\n\n  const getButtonState = (key: string): ButtonState => {\n    return buttonStates[key] || 'idle'\n  }\n\n  const isLoading = (key: string) => getButtonState(key) === 'loading'\n  const isSuccess = (key: string) => getButtonState(key) === 'success'\n  const isError = (key: string) => getButtonState(key) === 'error'\n\n  return {\n    setButtonState,\n    getButtonState,\n    isLoading,\n    isSuccess,\n    isError,\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/index.css\" ext=\".css\">\n      <cntx:meta size=\"4521\" modified=\"2025-06-06T22:59:43.865Z\" />\n      <cntx:content><![CDATA[@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  --color-background: var(--background);\n  --color-foreground: var(--foreground);\n  --color-card: var(--card);\n  --color-card-foreground: var(--card-foreground);\n  --color-popover: var(--popover);\n  --color-popover-foreground: var(--popover-foreground);\n  --color-primary: var(--primary);\n  --color-primary-foreground: var(--primary-foreground);\n  --color-secondary: var(--secondary);\n  --color-secondary-foreground: var(--secondary-foreground);\n  --color-muted: var(--muted);\n  --color-muted-foreground: var(--muted-foreground);\n  --color-accent: var(--accent);\n  --color-accent-foreground: var(--accent-foreground);\n  --color-destructive: var(--destructive);\n  --color-border: var(--border);\n  --color-input: var(--input);\n  --color-ring: var(--ring);\n  --color-chart-1: var(--chart-1);\n  --color-chart-2: var(--chart-2);\n  --color-chart-3: var(--chart-3);\n  --color-chart-4: var(--chart-4);\n  --color-chart-5: var(--chart-5);\n  --color-sidebar: var(--sidebar);\n  --color-sidebar-foreground: var(--sidebar-foreground);\n  --color-sidebar-primary: var(--sidebar-primary);\n  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);\n  --color-sidebar-accent: var(--sidebar-accent);\n  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);\n  --color-sidebar-border: var(--sidebar-border);\n  --color-sidebar-ring: var(--sidebar-ring);\n}\n\n:root {\n  --radius: 0.625rem;\n  --background: oklch(1 0 0);\n  --foreground: oklch(0.129 0.042 264.695);\n  --card: oklch(1 0 0);\n  --card-foreground: oklch(0.129 0.042 264.695);\n  --popover: oklch(1 0 0);\n  --popover-foreground: oklch(0.129 0.042 264.695);\n  --primary: oklch(0.208 0.042 265.755);\n  --primary-foreground: oklch(0.984 0.003 247.858);\n  --secondary: oklch(0.968 0.007 247.896);\n  --secondary-foreground: oklch(0.208 0.042 265.755);\n  --muted: oklch(0.968 0.007 247.896);\n  --muted-foreground: oklch(0.554 0.046 257.417);\n  --accent: oklch(0.968 0.007 247.896);\n  --accent-foreground: oklch(0.208 0.042 265.755);\n  --destructive: oklch(0.577 0.245 27.325);\n  --border: oklch(0.929 0.013 255.508);\n  --input: oklch(0.929 0.013 255.508);\n  --ring: oklch(0.704 0.04 256.788);\n  --chart-1: oklch(0.646 0.222 41.116);\n  --chart-2: oklch(0.6 0.118 184.704);\n  --chart-3: oklch(0.398 0.07 227.392);\n  --chart-4: oklch(0.828 0.189 84.429);\n  --chart-5: oklch(0.769 0.188 70.08);\n  --sidebar: oklch(0.984 0.003 247.858);\n  --sidebar-foreground: oklch(0.129 0.042 264.695);\n  --sidebar-primary: oklch(0.208 0.042 265.755);\n  --sidebar-primary-foreground: oklch(0.984 0.003 247.858);\n  --sidebar-accent: oklch(0.968 0.007 247.896);\n  --sidebar-accent-foreground: oklch(0.208 0.042 265.755);\n  --sidebar-border: oklch(0.929 0.013 255.508);\n  --sidebar-ring: oklch(0.704 0.04 256.788);\n}\n\n.dark {\n  --background: oklch(0.129 0.042 264.695);\n  --foreground: oklch(0.984 0.003 247.858);\n  --card: oklch(0.208 0.042 265.755);\n  --card-foreground: oklch(0.984 0.003 247.858);\n  --popover: oklch(0.208 0.042 265.755);\n  --popover-foreground: oklch(0.984 0.003 247.858);\n  --primary: oklch(0.929 0.013 255.508);\n  --primary-foreground: oklch(0.208 0.042 265.755);\n  --secondary: oklch(0.279 0.041 260.031);\n  --secondary-foreground: oklch(0.984 0.003 247.858);\n  --muted: oklch(0.279 0.041 260.031);\n  --muted-foreground: oklch(0.704 0.04 256.788);\n  --accent: oklch(0.279 0.041 260.031);\n  --accent-foreground: oklch(0.984 0.003 247.858);\n  --destructive: oklch(0.704 0.191 22.216);\n  --border: oklch(1 0 0 / 10%);\n  --input: oklch(1 0 0 / 15%);\n  --ring: oklch(0.551 0.027 264.364);\n  --chart-1: oklch(0.488 0.243 264.376);\n  --chart-2: oklch(0.696 0.17 162.48);\n  --chart-3: oklch(0.769 0.188 70.08);\n  --chart-4: oklch(0.627 0.265 303.9);\n  --chart-5: oklch(0.645 0.246 16.439);\n  --sidebar: oklch(0.208 0.042 265.755);\n  --sidebar-foreground: oklch(0.984 0.003 247.858);\n  --sidebar-primary: oklch(0.488 0.243 264.376);\n  --sidebar-primary-foreground: oklch(0.984 0.003 247.858);\n  --sidebar-accent: oklch(0.279 0.041 260.031);\n  --sidebar-accent-foreground: oklch(0.984 0.003 247.858);\n  --sidebar-border: oklch(1 0 0 / 10%);\n  --sidebar-ring: oklch(0.551 0.027 264.364);\n}\n\n@layer base {\n  * {\n    @apply border-border outline-ring/50;\n  }\n  body {\n    @apply bg-background text-foreground;\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/lib/utils.ts\" ext=\".ts\">\n      <cntx:meta size=\"166\" modified=\"2025-06-06T22:59:49.030Z\" />\n      <cntx:content><![CDATA[import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/main.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"230\" modified=\"2025-06-06T22:55:53.337Z\" />\n      <cntx:content><![CDATA[import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport './index.css'\nimport App from './App.tsx'\n\ncreateRoot(document.getElementById('root')!).render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n)\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/utils/buttonHelpers.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"883\" modified=\"2025-06-07T02:10:05.487Z\" />\n      <cntx:content><![CDATA[// utils/buttonHelpers.tsx\nimport { Loader2, CheckCircle, AlertCircle } from 'lucide-react'\nimport type { ButtonState } from '../hooks/useButtonFeedback'\n\nexport function getButtonIcon(state: ButtonState, defaultIcon: React.ReactNode) {\n  switch (state) {\n    case 'loading':\n      return <Loader2 className=\"w-4 h-4 animate-spin\" />\n    case 'success':\n      return <CheckCircle className=\"w-4 h-4 text-green-600\" />\n    case 'error':\n      return <AlertCircle className=\"w-4 h-4 text-red-600\" />\n    default:\n      return defaultIcon\n  }\n}\n\nexport function getButtonClassName(state: ButtonState, baseClassName = '') {\n  const stateClasses = {\n    loading: 'opacity-75',\n    success: 'border-green-500 bg-green-50 text-green-700',\n    error: 'border-red-500 bg-red-50 text-red-700',\n    idle: ''\n  }\n\n  return `transition-all duration-200 ${baseClassName} ${stateClasses[state]}`\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/vite-env.d.ts\" ext=\".ts\">\n      <cntx:meta size=\"38\" modified=\"2025-06-06T22:55:53.337Z\" />\n      <cntx:content><![CDATA[/// <reference types=\"vite/client\" />\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.app.json\" ext=\".json\">\n      <cntx:meta size=\"753\" modified=\"2025-06-06T22:58:44.187Z\" />\n      <cntx:content><![CDATA[{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\n        \"./src/*\"\n      ]\n    },\n    \"tsBuildInfoFile\": \"./node_modules/.tmp/tsconfig.app.tsbuildinfo\",\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"verbatimModuleSyntax\": true,\n    \"moduleDetection\": \"force\",\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"noUncheckedSideEffectImports\": true\n  },\n  \"include\": [\"src\"]\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.json\" ext=\".json\">\n      <cntx:meta size=\"214\" modified=\"2025-06-06T22:58:20.358Z\" />\n      <cntx:content><![CDATA[{\n  \"files\": [],\n  \"references\": [\n    { \"path\": \"./tsconfig.app.json\" },\n    { \"path\": \"./tsconfig.node.json\" }\n  ],\n   \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.node.json\" ext=\".json\">\n      <cntx:meta size=\"598\" modified=\"2025-06-07T02:03:31.047Z\" />\n      <cntx:content><![CDATA[{\n  \"compilerOptions\": {\n    \"tsBuildInfoFile\": \"./node_modules/.tmp/tsconfig.node.tsbuildinfo\",\n    \"target\": \"ES2022\",\n    \"lib\": [\"ES2023\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"verbatimModuleSyntax\": true,\n    \"moduleDetection\": \"force\",\n    \"noEmit\": true,\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"noUncheckedSideEffectImports\": true\n  },\n  \"include\": [\"vite.config.ts\"]\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/vite.config.ts\" ext=\".ts\">\n      <cntx:meta size=\"833\" modified=\"2025-06-07T02:03:25.557Z\" />\n      <cntx:content><![CDATA[import path from 'path'\nimport tailwindcss from '@tailwindcss/vite'\nimport react from '@vitejs/plugin-react'\nimport { defineConfig } from 'vite'\n\n// https://vite.dev/config/\nexport default defineConfig({\n  plugins: [react(), tailwindcss()],\n  base: './', // Important: Use relative paths for serving from any location\n  build: {\n    outDir: 'dist',\n    assetsDir: 'assets',\n    sourcemap: false, // Reduce bundle size\n    rollupOptions: {\n      output: {\n        manualChunks: undefined, // Keep everything in one chunk for simplicity\n      },\n    },\n  },\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5173,\n    proxy: {\n      // Proxy API calls during development\n      '/api': {\n        target: 'http://localhost:3333',\n        changeOrigin: true,\n      },\n    },\n  },\n})\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.679Z",
    "size": 247009
  },
  "server": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"server\" generated=\"2025-06-18T12:10:52.687Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"1\">\n    <cntx:file path=\"server.js\" ext=\".js\">\n      <cntx:meta size=\"46772\" modified=\"2025-06-18T12:08:01.149Z\" />\n      <cntx:content><![CDATA[import { readFileSync, writeFileSync, existsSync, mkdirSync, watch, readdirSync, statSync } from 'fs';\nimport { join, dirname, relative, extname } from 'path';\nimport { createServer } from 'http';\nimport { WebSocketServer } from 'ws';\nimport { fileURLToPath } from 'url';\nimport path from 'path';\nimport { startMCPTransport } from './lib/mcp-transport.js';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\nfunction getContentType(filePath) {\n  const ext = path.extname(filePath).toLowerCase();\n  const contentTypes = {\n    '.html': 'text/html',\n    '.js': 'application/javascript',\n    '.css': 'text/css',\n    '.json': 'application/json',\n    '.png': 'image/png',\n    '.jpg': 'image/jpeg',\n    '.gif': 'image/gif',\n    '.svg': 'image/svg+xml',\n    '.ico': 'image/x-icon'\n  };\n  return contentTypes[ext] || 'text/plain';\n}\n\nexport class CntxServer {\n  constructor(cwd = process.cwd()) {\n    this.CWD = cwd;\n    this.CNTX_DIR = join(cwd, '.cntx');\n    this.CONFIG_FILE = join(this.CNTX_DIR, 'config.json');\n    this.BUNDLES_FILE = join(this.CNTX_DIR, 'bundles.json');\n    this.HIDDEN_FILES_CONFIG = join(this.CNTX_DIR, 'hidden-files.json');\n    this.IGNORE_FILE = join(cwd, '.cntxignore');\n    this.CURSOR_RULES_FILE = join(cwd, '.cursorrules');\n\n    this.bundles = new Map();\n    this.ignorePatterns = [];\n    this.watchers = [];\n    this.clients = new Set();\n    this.isScanning = false;\n\n    this.hiddenFilesConfig = {\n      globalHidden: [], // Files hidden across all bundles\n      bundleSpecific: {}, // Files hidden per bundle: { bundleName: [filePaths] }\n      userIgnorePatterns: [], // User-added ignore patterns\n      disabledSystemPatterns: [] // System patterns the user disabled\n    };\n  }\n\n  init() {\n    if (!existsSync(this.CNTX_DIR)) mkdirSync(this.CNTX_DIR, { recursive: true });\n    this.loadConfig();\n    this.loadHiddenFilesConfig();\n    this.loadIgnorePatterns();\n    this.loadBundleStates();\n    this.startWatching();\n    this.generateAllBundles();\n  }\n\n  loadConfig() {\n    // Clear existing bundles to ensure deleted ones are removed\n    this.bundles.clear();\n\n    if (existsSync(this.CONFIG_FILE)) {\n      const config = JSON.parse(readFileSync(this.CONFIG_FILE, 'utf8'));\n      Object.entries(config.bundles || {}).forEach(([name, patterns]) => {\n        this.bundles.set(name, {\n          patterns: Array.isArray(patterns) ? patterns : [patterns],\n          files: [],\n          content: '',\n          changed: false,\n          lastGenerated: null,\n          size: 0\n        });\n      });\n    }\n\n    if (!this.bundles.has('master')) {\n      this.bundles.set('master', {\n        patterns: ['**/*'],\n        files: [],\n        content: '',\n        changed: false,\n        lastGenerated: null,\n        size: 0\n      });\n    }\n  }\n\n  loadHiddenFilesConfig() {\n    if (existsSync(this.HIDDEN_FILES_CONFIG)) {\n      try {\n        const config = JSON.parse(readFileSync(this.HIDDEN_FILES_CONFIG, 'utf8'));\n        this.hiddenFilesConfig = { ...this.hiddenFilesConfig, ...config };\n      } catch (e) {\n        console.warn('Could not load hidden files config:', e.message);\n      }\n    }\n  }\n\n  saveHiddenFilesConfig() {\n    try {\n      writeFileSync(this.HIDDEN_FILES_CONFIG, JSON.stringify(this.hiddenFilesConfig, null, 2));\n    } catch (e) {\n      console.error('Failed to save hidden files config:', e.message);\n    }\n  }\n\n  isFileHidden(filePath, bundleName = null) {\n    // Check global hidden files\n    if (this.hiddenFilesConfig.globalHidden.includes(filePath)) {\n      return true;\n    }\n\n    // Check bundle-specific hidden files\n    if (bundleName && this.hiddenFilesConfig.bundleSpecific[bundleName]) {\n      return this.hiddenFilesConfig.bundleSpecific[bundleName].includes(filePath);\n    }\n\n    return false;\n  }\n\n  toggleFileVisibility(filePath, bundleName = null, forceHide = null) {\n    if (bundleName) {\n      // Bundle-specific hiding\n      if (!this.hiddenFilesConfig.bundleSpecific[bundleName]) {\n        this.hiddenFilesConfig.bundleSpecific[bundleName] = [];\n      }\n\n      const bundleHidden = this.hiddenFilesConfig.bundleSpecific[bundleName];\n      const isCurrentlyHidden = bundleHidden.includes(filePath);\n\n      if (forceHide === null) {\n        // Toggle current state\n        if (isCurrentlyHidden) {\n          this.hiddenFilesConfig.bundleSpecific[bundleName] = bundleHidden.filter(f => f !== filePath);\n        } else {\n          bundleHidden.push(filePath);\n        }\n      } else {\n        // Force to specific state\n        if (forceHide && !isCurrentlyHidden) {\n          bundleHidden.push(filePath);\n        } else if (!forceHide && isCurrentlyHidden) {\n          this.hiddenFilesConfig.bundleSpecific[bundleName] = bundleHidden.filter(f => f !== filePath);\n        }\n      }\n    } else {\n      // Global hiding\n      const isCurrentlyHidden = this.hiddenFilesConfig.globalHidden.includes(filePath);\n\n      if (forceHide === null) {\n        // Toggle current state\n        if (isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden = this.hiddenFilesConfig.globalHidden.filter(f => f !== filePath);\n        } else {\n          this.hiddenFilesConfig.globalHidden.push(filePath);\n        }\n      } else {\n        // Force to specific state\n        if (forceHide && !isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden.push(filePath);\n        } else if (!forceHide && isCurrentlyHidden) {\n          this.hiddenFilesConfig.globalHidden = this.hiddenFilesConfig.globalHidden.filter(f => f !== filePath);\n        }\n      }\n    }\n\n    this.saveHiddenFilesConfig();\n  }\n\n  bulkToggleFileVisibility(filePaths, bundleName = null, forceHide = null) {\n    filePaths.forEach(filePath => {\n      this.toggleFileVisibility(filePath, bundleName, forceHide);\n    });\n  }\n\n  addUserIgnorePattern(pattern) {\n    if (!this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)) {\n      this.hiddenFilesConfig.userIgnorePatterns.push(pattern);\n      this.saveHiddenFilesConfig();\n      this.loadIgnorePatterns();\n      this.generateAllBundles();\n      return true;\n    }\n    return false;\n  }\n\n  removeUserIgnorePattern(pattern) {\n    const index = this.hiddenFilesConfig.userIgnorePatterns.indexOf(pattern);\n    if (index > -1) {\n      this.hiddenFilesConfig.userIgnorePatterns.splice(index, 1);\n      this.saveHiddenFilesConfig();\n      this.loadIgnorePatterns();\n      this.generateAllBundles();\n      return true;\n    }\n    return false;\n  }\n\n  toggleSystemIgnorePattern(pattern) {\n    const index = this.hiddenFilesConfig.disabledSystemPatterns.indexOf(pattern);\n    if (index > -1) {\n      // Re-enable the pattern\n      this.hiddenFilesConfig.disabledSystemPatterns.splice(index, 1);\n    } else {\n      // Disable the pattern\n      this.hiddenFilesConfig.disabledSystemPatterns.push(pattern);\n    }\n\n    this.saveHiddenFilesConfig();\n    this.loadIgnorePatterns();\n    this.generateAllBundles();\n  }\n\n  loadIgnorePatterns() {\n    const systemPatterns = [\n      '**/.git/**',\n      '**/node_modules/**',\n      '**/.cntx/**'\n    ];\n\n    // Read from .cntxignore file\n    let filePatterns = [];\n    if (existsSync(this.IGNORE_FILE)) {\n      filePatterns = readFileSync(this.IGNORE_FILE, 'utf8')\n        .split('\\n')\n        .map(line => line.trim())\n        .filter(line => line && !line.startsWith('#'));\n    }\n\n    // Combine all patterns\n    this.ignorePatterns = [\n      // System patterns (filtered by disabled list)\n      ...systemPatterns.filter(pattern =>\n        !this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n      ),\n      // File patterns\n      ...filePatterns.filter(pattern =>\n        !systemPatterns.includes(pattern) &&\n        !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n      ),\n      // User-added patterns\n      ...this.hiddenFilesConfig.userIgnorePatterns\n    ];\n\n    // Update .cntxignore file with current patterns\n    const allPatterns = [\n      '# System patterns',\n      ...systemPatterns.map(pattern =>\n        this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n          ? `# ${pattern}`\n          : pattern\n      ),\n      '',\n      '# User patterns',\n      ...this.hiddenFilesConfig.userIgnorePatterns,\n      '',\n      '# File-specific patterns (edit manually)',\n      ...filePatterns.filter(pattern =>\n        !systemPatterns.includes(pattern) &&\n        !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n      )\n    ];\n\n    writeFileSync(this.IGNORE_FILE, allPatterns.join('\\n'));\n  }\n\n  loadBundleStates() {\n    if (existsSync(this.BUNDLES_FILE)) {\n      try {\n        const savedBundles = JSON.parse(readFileSync(this.BUNDLES_FILE, 'utf8'));\n        Object.entries(savedBundles).forEach(([name, data]) => {\n          if (this.bundles.has(name)) {\n            const bundle = this.bundles.get(name);\n            bundle.content = data.content || '';\n            bundle.lastGenerated = data.lastGenerated;\n            bundle.size = data.size || 0;\n          }\n        });\n      } catch (e) {\n        console.warn('Could not load bundle states:', e.message);\n      }\n    }\n  }\n\n  saveBundleStates() {\n    const bundleStates = {};\n    this.bundles.forEach((bundle, name) => {\n      bundleStates[name] = {\n        content: bundle.content,\n        lastGenerated: bundle.lastGenerated,\n        size: bundle.size\n      };\n    });\n    writeFileSync(this.BUNDLES_FILE, JSON.stringify(bundleStates, null, 2));\n  }\n\n  // Cursor Rules Methods\n  loadCursorRules() {\n    if (existsSync(this.CURSOR_RULES_FILE)) {\n      return readFileSync(this.CURSOR_RULES_FILE, 'utf8');\n    }\n    return this.getDefaultCursorRules();\n  }\n\n  getDefaultCursorRules() {\n    // Get project info for context\n    let projectInfo = { name: 'unknown', description: '', type: 'general' };\n    const pkgPath = join(this.CWD, 'package.json');\n\n    if (existsSync(pkgPath)) {\n      try {\n        const pkg = JSON.parse(readFileSync(pkgPath, 'utf8'));\n        projectInfo = {\n          name: pkg.name || 'unknown',\n          description: pkg.description || '',\n          type: this.detectProjectType(pkg)\n        };\n      } catch (e) {\n        // Use defaults\n      }\n    }\n\n    return this.generateCursorRulesTemplate(projectInfo);\n  }\n\n  detectProjectType(pkg) {\n    const deps = { ...pkg.dependencies, ...pkg.devDependencies };\n\n    if (deps.react || deps['@types/react']) return 'react';\n    if (deps.vue || deps['@vue/cli']) return 'vue';\n    if (deps.angular || deps['@angular/core']) return 'angular';\n    if (deps.express || deps.fastify || deps.koa) return 'node';\n    if (deps.next || deps.nuxt || deps.gatsby) return 'fullstack';\n    if (deps.typescript || deps['@types/node']) return 'typescript';\n    if (pkg.type === 'module' || deps.vite || deps.webpack) return 'modern-js';\n\n    return 'general';\n  }\n\n  generateCursorRulesTemplate(projectInfo) {\n    const bundlesList = Array.from(this.bundles.keys()).join(', ');\n\n    const templates = {\n      react: `# ${projectInfo.name} - React Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Type**: React Application\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Style\n- Use TypeScript for all new components\n- Prefer functional components with hooks\n- Use Tailwind CSS for styling\n- Follow React best practices and hooks rules\n\n### File Organization\n- Components in \\`src/components/\\`\n- Custom hooks in \\`src/hooks/\\`\n- Utilities in \\`src/lib/\\`\n- Types in \\`src/types/\\`\n\n### Naming Conventions\n- PascalCase for components\n- camelCase for functions and variables\n- kebab-case for files and folders\n- Use descriptive, meaningful names\n\n### Bundle Context\nThis project uses cntx-ui for file bundling. Current bundles: ${bundlesList}\n- **ui**: React components and styles\n- **api**: API routes and utilities  \n- **config**: Configuration files\n- **docs**: Documentation\n\n### AI Assistant Instructions\n- When suggesting code changes, consider the current bundle structure\n- Prioritize TypeScript and modern React patterns\n- Suggest Tailwind classes for styling\n- Keep components focused and reusable\n- Always include proper TypeScript types\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`,\n\n      node: `# ${projectInfo.name} - Node.js Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Type**: Node.js Backend\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Style\n- Use ES modules (import/export)\n- TypeScript preferred for type safety\n- Follow Node.js best practices\n- Use async/await over promises\n\n### File Organization\n- Routes in \\`src/routes/\\`\n- Middleware in \\`src/middleware/\\`\n- Models in \\`src/models/\\`\n- Utilities in \\`src/utils/\\`\n\n### Bundle Context\nThis project uses cntx-ui for file bundling. Current bundles: ${bundlesList}\n- **api**: Core API logic and routes\n- **config**: Environment and configuration\n- **docs**: API documentation\n\n### AI Assistant Instructions\n- Focus on scalable backend architecture\n- Suggest proper error handling\n- Consider security best practices\n- Optimize for performance and maintainability\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`,\n\n      general: `# ${projectInfo.name} - Project Rules\n\n## Project Context\n- **Project**: ${projectInfo.name}\n- **Description**: ${projectInfo.description}\n\n## Development Guidelines\n\n### Code Quality\n- Write clean, readable code\n- Follow consistent naming conventions\n- Add comments for complex logic\n- Maintain proper file organization\n\n### Bundle Management\nThis project uses cntx-ui for intelligent file bundling. Current bundles: ${bundlesList}\n- **master**: Complete project overview\n- **config**: Configuration and setup files\n- **docs**: Documentation and README files\n\n### AI Assistant Instructions\n- When helping with code, consider the project structure\n- Suggest improvements for maintainability\n- Follow established patterns in the codebase\n- Help optimize bundle configurations when needed\n- Consider bundle organization when suggesting file locations\n\n## Custom Rules\nAdd your specific project rules and preferences below:\n\n### Team Preferences\n- [Add team coding standards]\n- [Add preferred libraries/frameworks]\n- [Add project-specific guidelines]\n\n### Architecture Notes\n- [Document key architectural decisions]\n- [Note important patterns to follow]\n- [List critical dependencies]\n`\n    };\n\n    return templates[projectInfo.type] || templates.general;\n  }\n\n  saveCursorRules(content) {\n    writeFileSync(this.CURSOR_RULES_FILE, content, 'utf8');\n  }\n\n  shouldIgnoreFile(filePath) {\n    const relativePath = relative(this.CWD, filePath).replace(/\\\\\\\\/g, '/');\n\n    // Hard-coded critical ignores\n    if (relativePath.startsWith('node_modules/')) return true;\n    if (relativePath.startsWith('.git/')) return true;\n    if (relativePath.startsWith('.cntx/')) return true;\n\n    return this.ignorePatterns.some(pattern => this.matchesPattern(relativePath, pattern));\n  }\n\n  matchesPattern(path, pattern) {\n    if (pattern === '**/*') return true;\n    if (pattern === '*') return !path.includes('/');\n    if (pattern === path) return true;\n\n    let regexPattern = pattern\n      .replace(/\\\\/g, '/')\n      .replace(/\\./g, '\\\\.')\n      .replace(/\\?/g, '.');\n\n    regexPattern = regexPattern.replace(/\\*\\*/g, 'DOUBLESTAR');\n    regexPattern = regexPattern.replace(/\\*/g, '[^/]*');\n    regexPattern = regexPattern.replace(/DOUBLESTAR/g, '.*');\n\n    try {\n      const regex = new RegExp('^' + regexPattern + '$');\n      return regex.test(path);\n    } catch (e) {\n      console.log(`Regex error for pattern \"${pattern}\": ${e.message}`);\n      return false;\n    }\n  }\n\n  shouldIgnoreAnything(itemName, fullPath) {\n    // DIRECTORY NAME IGNORES (anywhere in the project)\n    const badDirectories = [\n      'node_modules',\n      '.git',\n      '.svn',\n      '.hg',\n      'vendor',\n      '__pycache__',\n      '.pytest_cache',\n      '.venv',\n      'venv',\n      'env',\n      '.env',\n      'dist',\n      'build',\n      'out',\n      '.next',\n      '.nuxt',\n      'coverage',\n      '.nyc_output',\n      '.cache',\n      '.parcel-cache',\n      '.vercel',\n      '.netlify',\n      'tmp',\n      'temp',\n      '.tmp',\n      '.temp',\n      'logs',\n      '*.egg-info',\n      '.cntx'\n    ];\n\n    if (badDirectories.includes(itemName)) {\n      return true;\n    }\n\n    // FILE EXTENSION IGNORES\n    const badExtensions = [\n      // Logs\n      '.log', '.logs',\n      // OS files\n      '.DS_Store', '.Thumbs.db', 'desktop.ini',\n      // Editor files\n      '.vscode', '.idea', '*.swp', '*.swo', '*~',\n      // Media files (large and useless for AI)\n      '.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp', '.svg',\n      '.mp4', '.avi', '.mov', '.wmv', '.flv', '.webm', '.mkv',\n      '.mp3', '.wav', '.flac', '.aac', '.ogg', '.wma',\n      '.pdf', '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx',\n      '.zip', '.tar', '.gz', '.rar', '.7z', '.bz2',\n      '.exe', '.dll', '.so', '.dylib', '.app', '.dmg', '.pkg',\n      // Cache/temp files\n      '.cache', '.tmp', '.temp', '.lock',\n      // Compiled files\n      '.pyc', '.pyo', '.class', '.o', '.obj', '.a', '.lib'\n    ];\n\n    const fileExt = extname(itemName).toLowerCase();\n    if (badExtensions.includes(fileExt)) {\n      return true;\n    }\n\n    // FILE NAME PATTERNS\n    const badFilePatterns = [\n      /^\\..*/, // Hidden files starting with .\n      /.*\\.lock$/, // Lock files\n      /.*\\.min\\.js$/, // Minified JS\n      /.*\\.min\\.css$/, // Minified CSS\n      /.*\\.map$/, // Source maps\n      /package-lock\\.json$/,\n      /yarn\\.lock$/,\n      /pnpm-lock\\.yaml$/,\n      /Thumbs\\.db$/,\n      /\\.DS_Store$/\n    ];\n\n    if (badFilePatterns.some(pattern => pattern.test(itemName))) {\n      return true;\n    }\n\n    // PATH-BASED IGNORES (from your .cntxignore)\n    return this.ignorePatterns.some(pattern => this.matchesPattern(fullPath, pattern));\n  }\n\n  getAllFiles(dir = this.CWD, files = []) {\n    try {\n      const items = readdirSync(dir);\n      for (const item of items) {\n        const fullPath = join(dir, item);\n        const relativePath = relative(this.CWD, fullPath).replace(/\\\\\\\\/g, '/');\n\n        // BULLETPROOF IGNORES - check directory/file names directly\n        const shouldIgnore = this.shouldIgnoreAnything(item, relativePath);\n\n        if (shouldIgnore) {\n          continue; // Don't even log it, just skip\n        }\n\n        const stat = statSync(fullPath);\n        if (stat.isDirectory()) {\n          this.getAllFiles(fullPath, files);\n        } else {\n          files.push(relativePath);\n        }\n      }\n    } catch (e) {\n      // Skip directories we can't read\n    }\n\n    return files;\n  }\n\n  startWatching() {\n    const watcher = watch(this.CWD, { recursive: true }, (eventType, filename) => {\n      if (filename && !this.isScanning) {\n        const fullPath = join(this.CWD, filename);\n        if (!this.shouldIgnoreFile(fullPath)) {\n          console.log(`File ${eventType}: ${filename}`);\n          this.markBundlesChanged(filename.replace(/\\\\\\\\/g, '/'));\n          this.broadcastUpdate();\n        }\n      }\n    });\n    this.watchers.push(watcher);\n  }\n\n  getFileTree() {\n    const allFiles = this.getAllFiles();\n    const fileData = allFiles.map(file => {\n      const fullPath = join(this.CWD, file);\n      try {\n        const stat = statSync(fullPath);\n        return {\n          path: file,\n          size: stat.size,\n          modified: stat.mtime\n        };\n      } catch (e) {\n        return {\n          path: file,\n          size: 0,\n          modified: new Date()\n        };\n      }\n    });\n    return fileData;\n  }\n\n  markBundlesChanged(filename) {\n    this.bundles.forEach((bundle, name) => {\n      if (bundle.patterns.some(pattern => this.matchesPattern(filename, pattern))) {\n        bundle.changed = true;\n      }\n    });\n  }\n\n  generateAllBundles() {\n    this.isScanning = true;\n    console.log('Scanning files and generating bundles...');\n\n    this.bundles.forEach((bundle, name) => {\n      this.generateBundle(name);\n    });\n\n    this.saveBundleStates();\n    this.isScanning = false;\n    console.log('Bundle generation complete');\n  }\n\n  generateBundle(name) {\n    const bundle = this.bundles.get(name);\n    if (!bundle) return;\n\n    console.log(`Generating bundle: ${name}`);\n    const allFiles = this.getAllFiles();\n\n    // Filter files by bundle patterns\n    let bundleFiles = allFiles.filter(file =>\n      bundle.patterns.some(pattern => this.matchesPattern(file, pattern))\n    );\n\n    // Remove hidden files\n    bundleFiles = bundleFiles.filter(file => !this.isFileHidden(file, name));\n\n    bundle.files = bundleFiles;\n    bundle.content = this.generateBundleXML(name, bundle.files);\n    bundle.changed = false;\n    bundle.lastGenerated = new Date().toISOString();\n    bundle.size = Buffer.byteLength(bundle.content, 'utf8');\n\n    console.log(`Generated bundle '${name}' with ${bundle.files.length} files (${(bundle.size / 1024).toFixed(1)}kb)`);\n  }\n\n  generateBundleXML(bundleName, files) {\n    let xml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"${bundleName}\" generated=\"${new Date().toISOString()}\">\n`;\n\n    const pkgPath = join(this.CWD, 'package.json');\n    if (existsSync(pkgPath)) {\n      try {\n        const pkg = JSON.parse(readFileSync(pkgPath, 'utf8'));\n        xml += `  <cntx:project>\n    <cntx:name>${this.escapeXml(pkg.name || 'unknown')}</cntx:name>\n    <cntx:version>${pkg.version || '0.0.0'}</cntx:version>\n`;\n        if (pkg.description) xml += `    <cntx:description>${this.escapeXml(pkg.description)}</cntx:description>\n`;\n        xml += `  </cntx:project>\n`;\n      } catch (e) {\n        xml += `  <cntx:project><cntx:error>Could not parse package.json</cntx:error></cntx:project>\n`;\n      }\n    }\n\n    xml += `  <cntx:files count=\"${files.length}\">\n`;\n\n    files.forEach(file => {\n      const fullPath = join(this.CWD, file);\n      xml += `    <cntx:file path=\"${file}\" ext=\"${extname(file)}\">\n`;\n\n      try {\n        const stat = statSync(fullPath);\n        const content = readFileSync(fullPath, 'utf8');\n        xml += `      <cntx:meta size=\"${stat.size}\" modified=\"${stat.mtime.toISOString()}\" />\n      <cntx:content><![CDATA[${content}]]></cntx:content>\n`;\n      } catch (e) {\n        xml += `      <cntx:error>Could not read file: ${e.message}</cntx:error>\n`;\n      }\n\n      xml += `    </cntx:file>\n`;\n    });\n\n    xml += `  </cntx:files>\n</cntx:bundle>`;\n    return xml;\n  }\n\n  escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;');\n  }\n\n  getFileStats(filePath) {\n    try {\n      const fullPath = join(this.CWD, filePath);\n      const stat = statSync(fullPath);\n      return {\n        size: stat.size,\n        mtime: stat.mtime\n      };\n    } catch (e) {\n      return {\n        size: 0,\n        mtime: new Date()\n      };\n    }\n  }\n\n  getFileListWithVisibility(bundleName = null) {\n    const allFiles = this.getAllFiles();\n\n    return allFiles.map(filePath => {\n      const fileStats = this.getFileStats(filePath);\n      const isGloballyHidden = this.hiddenFilesConfig.globalHidden.includes(filePath);\n      const bundleHidden = bundleName ? this.isFileHidden(filePath, bundleName) : false;\n\n      // Determine which bundles this file appears in\n      const inBundles = [];\n      this.bundles.forEach((bundle, name) => {\n        const matchesPattern = bundle.patterns.some(pattern => this.matchesPattern(filePath, pattern));\n        const notHidden = !this.isFileHidden(filePath, name);\n        if (matchesPattern && notHidden) {\n          inBundles.push(name);\n        }\n      });\n\n      return {\n        path: filePath,\n        size: fileStats.size,\n        modified: fileStats.mtime,\n        visible: !isGloballyHidden && !bundleHidden,\n        globallyHidden: isGloballyHidden,\n        bundleHidden: bundleHidden,\n        inBundles: inBundles,\n        matchesIgnorePattern: this.shouldIgnoreFile(join(this.CWD, filePath))\n      };\n    });\n  }\n\n  startServer(port = 3333) {\n    const server = createServer((req, res) => {\n      const url = new URL(req.url, `http://localhost:${port}`);\n\n      // CORS headers for ALL requests - MUST be first\n      res.setHeader('Access-Control-Allow-Origin', '*');\n      res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\n      res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n      res.setHeader('Access-Control-Max-Age', '86400');\n\n      // Handle preflight OPTIONS requests\n      if (req.method === 'OPTIONS') {\n        res.writeHead(200);\n        res.end();\n        return;\n      }\n\n      // Serve static files for web interface\n      if (url.pathname === '/' || url.pathname.startsWith('/assets/') || url.pathname.endsWith('.js') || url.pathname.endsWith('.css') || url.pathname.endsWith('.ico')) {\n        const webDistPath = path.join(__dirname, 'web', 'dist');\n\n        if (url.pathname === '/') {\n          // Serve index.html for root\n          const indexPath = path.join(webDistPath, 'index.html');\n          if (existsSync(indexPath)) {\n            try {\n              const content = readFileSync(indexPath, 'utf8');\n              res.writeHead(200, { 'Content-Type': 'text/html' });\n              res.end(content);\n              return;\n            } catch (e) {\n              console.error('Error serving index.html:', e);\n            }\n          }\n\n          // Fallback if no web interface built\n          res.writeHead(200, { 'Content-Type': 'text/html' });\n          res.end(`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <title>cntx-ui Server</title>\n              <style>\n                body { font-family: system-ui, sans-serif; margin: 40px; }\n                .container { max-width: 600px; }\n                .api-link { background: #f5f5f5; padding: 10px; border-radius: 5px; margin: 10px 0; }\n                code { background: #f0f0f0; padding: 2px 5px; border-radius: 3px; }\n              </style>\n            </head>\n            <body>\n              <div class=\"container\">\n                <h1>🚀 cntx-ui Server Running</h1>\n                <p>Your cntx-ui server is running successfully!</p>\n                \n                <h2>Available APIs:</h2>\n                <div class=\"api-link\">\n                  <strong>Bundles:</strong> <a href=\"/api/bundles\">/api/bundles</a>\n                </div>\n                <div class=\"api-link\">\n                  <strong>Configuration:</strong> <a href=\"/api/config\">/api/config</a>\n                </div>\n                <div class=\"api-link\">\n                  <strong>Files:</strong> <a href=\"/api/files\">/api/files</a>\n                </div>\n                \n                <h2>Web Interface:</h2>\n                <p>The web interface is not available because it wasn't built when this package was published.</p>\n                <p>To enable the web interface, the package maintainer needs to run:</p>\n                <pre><code>cd web && npm install && npm run build</code></pre>\n                \n                <h2>CLI Usage:</h2>\n                <p>You can still use all CLI commands:</p>\n                <ul>\n                  <li><code>cntx-ui status</code> - Check current status</li>\n                  <li><code>cntx-ui bundle master</code> - Generate specific bundle</li>\n                  <li><code>cntx-ui init</code> - Initialize configuration</li>\n                </ul>\n              </div>\n            </body>\n          </html>\n        `);\n          return;\n        } else {\n          // Serve other static assets\n          const filePath = path.join(webDistPath, url.pathname);\n          if (existsSync(filePath)) {\n            try {\n              const content = readFileSync(filePath);\n              const contentType = getContentType(filePath);\n              res.writeHead(200, { 'Content-Type': contentType });\n              res.end(content);\n              return;\n            } catch (e) {\n              console.error('Error serving static file:', e);\n            }\n          }\n        }\n      }\n\n      // API Routes\n      if (url.pathname === '/api/bundles') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const bundleData = Array.from(this.bundles.entries()).map(([name, bundle]) => ({\n          name,\n          changed: bundle.changed,\n          fileCount: bundle.files.length,\n          content: bundle.content.substring(0, 5000) + (bundle.content.length > 5000 ? '...' : ''),\n          files: bundle.files,\n          lastGenerated: bundle.lastGenerated,\n          size: bundle.size\n        }));\n        res.end(JSON.stringify(bundleData));\n\n      } else if (url.pathname.startsWith('/api/bundles/')) {\n        const bundleName = url.pathname.split('/').pop();\n        const bundle = this.bundles.get(bundleName);\n        if (bundle) {\n          res.writeHead(200, { 'Content-Type': 'application/xml' });\n          res.end(bundle.content);\n        } else {\n          res.writeHead(404);\n          res.end('Bundle not found');\n        }\n\n      } else if (url.pathname.startsWith('/api/regenerate/')) {\n        const bundleName = url.pathname.split('/').pop();\n        if (this.bundles.has(bundleName)) {\n          this.generateBundle(bundleName);\n          this.saveBundleStates();\n          this.broadcastUpdate();\n          res.writeHead(200);\n          res.end('OK');\n        } else {\n          res.writeHead(404);\n          res.end('Bundle not found');\n        }\n\n      } else if (url.pathname === '/api/files') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const fileTree = this.getFileTree();\n        res.end(JSON.stringify(fileTree));\n\n      } else if (url.pathname === '/api/config') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          if (existsSync(this.CONFIG_FILE)) {\n            const config = readFileSync(this.CONFIG_FILE, 'utf8');\n            res.end(config);\n          } else {\n            const defaultConfig = {\n              bundles: {\n                master: ['**/*'],\n                api: ['src/api.js'],\n                ui: ['src/component.jsx', 'src/*.jsx'],\n                config: ['package.json', 'package-lock.json', '*.config.*'],\n                docs: ['README.md', '*.md']\n              }\n            };\n            res.end(JSON.stringify(defaultConfig));\n          }\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              console.log('🔍 Received config save request');\n              const config = JSON.parse(body);\n              console.log('📝 Config to save:', JSON.stringify(config, null, 2));\n\n              // Ensure .cntx directory exists\n              if (!existsSync(this.CNTX_DIR)) {\n                console.log('📁 Creating .cntx directory...');\n                mkdirSync(this.CNTX_DIR, { recursive: true });\n              }\n\n              // Write config file\n              console.log('💾 Writing config to:', this.CONFIG_FILE);\n              writeFileSync(this.CONFIG_FILE, JSON.stringify(config, null, 2));\n              console.log('✅ Config file written successfully');\n\n              // Reload configuration\n              this.loadConfig();\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'text/plain' });\n              res.end('OK');\n              console.log('✅ Config save response sent');\n\n            } catch (e) {\n              console.error('❌ Config save error:', e);\n              res.writeHead(400, { 'Content-Type': 'text/plain' });\n              res.end(`Error: ${e.message}`);\n            }\n          });\n\n          req.on('error', (err) => {\n            console.error('❌ Request error:', err);\n            if (!res.headersSent) {\n              res.writeHead(500, { 'Content-Type': 'text/plain' });\n              res.end('Internal Server Error');\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/cursor-rules') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'text/plain' });\n          const rules = this.loadCursorRules();\n          res.end(rules);\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { content } = JSON.parse(body);\n              this.saveCursorRules(content);\n              res.writeHead(200);\n              res.end('OK');\n            } catch (e) {\n              res.writeHead(400);\n              res.end('Invalid request');\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/cursor-rules/templates') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const templates = {\n          react: this.generateCursorRulesTemplate({ name: 'My React App', description: 'React application', type: 'react' }),\n          node: this.generateCursorRulesTemplate({ name: 'My Node App', description: 'Node.js backend', type: 'node' }),\n          general: this.generateCursorRulesTemplate({ name: 'My Project', description: 'General project', type: 'general' })\n        };\n        res.end(JSON.stringify(templates));\n\n      } else if (url.pathname === '/api/test-pattern') {\n        if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { pattern } = JSON.parse(body);\n              const allFiles = this.getAllFiles();\n              const matchingFiles = allFiles.filter(file =>\n                this.matchesPattern(file, pattern)\n              );\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify(matchingFiles));\n            } catch (e) {\n              res.writeHead(400);\n              res.end('Invalid request');\n            }\n          });\n        } else {\n          res.writeHead(405);\n          res.end('Method not allowed');\n        }\n\n      } else if (url.pathname === '/api/hidden-files') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          const stats = {\n            totalFiles: this.getAllFiles().length,\n            globallyHidden: this.hiddenFilesConfig.globalHidden.length,\n            bundleSpecificHidden: this.hiddenFilesConfig.bundleSpecific,\n            ignorePatterns: {\n              system: [\n                { pattern: '**/.git/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/.git/**') },\n                { pattern: '**/node_modules/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/node_modules/**') },\n                { pattern: '**/.cntx/**', active: !this.hiddenFilesConfig.disabledSystemPatterns.includes('**/.cntx/**') }\n              ],\n              user: this.hiddenFilesConfig.userIgnorePatterns,\n              disabled: this.hiddenFilesConfig.disabledSystemPatterns\n            }\n          };\n          res.end(JSON.stringify(stats));\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { action, filePath, filePaths, bundleName, forceHide } = JSON.parse(body);\n\n              if (action === 'toggle' && filePath) {\n                this.toggleFileVisibility(filePath, bundleName, forceHide);\n              } else if (action === 'bulk-toggle' && filePaths) {\n                this.bulkToggleFileVisibility(filePaths, bundleName, forceHide);\n              }\n\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success: true }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/files-with-visibility') {\n        const bundleName = url.searchParams.get('bundle');\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const files = this.getFileListWithVisibility(bundleName);\n        res.end(JSON.stringify(files));\n\n      } else if (url.pathname === '/api/ignore-patterns') {\n        if (req.method === 'GET') {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n\n          // Read file patterns\n          let filePatterns = [];\n          if (existsSync(this.IGNORE_FILE)) {\n            filePatterns = readFileSync(this.IGNORE_FILE, 'utf8')\n              .split('\\n')\n              .map(line => line.trim())\n              .filter(line => line && !line.startsWith('#'));\n          }\n\n          const systemPatterns = ['**/.git/**', '**/node_modules/**', '**/.cntx/**'];\n\n          const patterns = {\n            system: systemPatterns.map(pattern => ({\n              pattern,\n              active: !this.hiddenFilesConfig.disabledSystemPatterns.includes(pattern)\n            })),\n            user: this.hiddenFilesConfig.userIgnorePatterns.map(pattern => ({ pattern, active: true })),\n            file: filePatterns.filter(pattern =>\n              !systemPatterns.includes(pattern) &&\n              !this.hiddenFilesConfig.userIgnorePatterns.includes(pattern)\n            ).map(pattern => ({ pattern, active: true }))\n          };\n          res.end(JSON.stringify(patterns));\n\n        } else if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { action, pattern } = JSON.parse(body);\n              let success = false;\n\n              switch (action) {\n                case 'add':\n                  success = this.addUserIgnorePattern(pattern);\n                  break;\n                case 'remove':\n                  success = this.removeUserIgnorePattern(pattern);\n                  break;\n                case 'toggle-system':\n                  this.toggleSystemIgnorePattern(pattern);\n                  success = true;\n                  break;\n              }\n\n              this.broadcastUpdate();\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else if (url.pathname === '/api/bundle-visibility-stats') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        const stats = {};\n\n        this.bundles.forEach((bundle, bundleName) => {\n          const allFiles = this.getAllFiles();\n          const matchingFiles = allFiles.filter(file =>\n            bundle.patterns.some(pattern => this.matchesPattern(file, pattern))\n          );\n\n          const visibleFiles = matchingFiles.filter(file => !this.isFileHidden(file, bundleName));\n          const hiddenFiles = matchingFiles.length - visibleFiles.length;\n\n          stats[bundleName] = {\n            total: matchingFiles.length,\n            visible: visibleFiles.length,\n            hidden: hiddenFiles,\n            patterns: bundle.patterns\n          };\n        });\n\n        res.end(JSON.stringify(stats));\n\n      } else if (url.pathname === '/api/reset-hidden-files') {\n        if (req.method === 'POST') {\n          let body = '';\n          req.on('data', chunk => body += chunk);\n          req.on('end', () => {\n            try {\n              const { scope, bundleName } = JSON.parse(body);\n\n              if (scope === 'global') {\n                this.hiddenFilesConfig.globalHidden = [];\n              } else if (scope === 'bundle' && bundleName) {\n                delete this.hiddenFilesConfig.bundleSpecific[bundleName];\n              } else if (scope === 'all') {\n                this.hiddenFilesConfig.globalHidden = [];\n                this.hiddenFilesConfig.bundleSpecific = {};\n              }\n\n              this.saveHiddenFilesConfig();\n              this.generateAllBundles();\n              this.broadcastUpdate();\n\n              res.writeHead(200, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ success: true }));\n            } catch (e) {\n              res.writeHead(400, { 'Content-Type': 'application/json' });\n              res.end(JSON.stringify({ error: e.message }));\n            }\n          });\n        }\n\n      } else {\n        res.writeHead(404);\n        res.end('Not found');\n      }\n    });\n\n    const wss = new WebSocketServer({ server });\n    wss.on('connection', (ws) => {\n      this.clients.add(ws);\n      ws.on('close', () => this.clients.delete(ws));\n      this.sendUpdate(ws);\n    });\n\n    server.listen(port, () => {\n      console.log(`🚀 cntx-ui API running at http://localhost:${port}`);\n      console.log(`📁 Watching: ${this.CWD}`);\n      console.log(`📦 Bundles: ${Array.from(this.bundles.keys()).join(', ')}`);\n    });\n\n    return server;\n  }\n\n  broadcastUpdate() {\n    this.clients.forEach(client => this.sendUpdate(client));\n  }\n\n  sendUpdate(client) {\n    if (client.readyState === 1) {\n      const bundleData = Array.from(this.bundles.entries()).map(([name, bundle]) => ({\n        name,\n        changed: bundle.changed,\n        fileCount: bundle.files.length,\n        content: bundle.content.substring(0, 2000) + (bundle.content.length > 2000 ? '...' : ''),\n        files: bundle.files,\n        lastGenerated: bundle.lastGenerated,\n        size: bundle.size\n      }));\n      client.send(JSON.stringify(bundleData));\n    }\n  }\n\n  cleanup() {\n    this.watchers.forEach(watcher => watcher.close());\n    this.saveBundleStates();\n  }\n}\n\nexport function startServer(options = {}) {\n  const server = new CntxServer(options.cwd);\n  server.init();\n  return server.startServer(options.port);\n}\n\nexport function startMCPServer(options = {}) {\n  const server = new CntxServer(options.cwd);\n  server.init();\n  startMCPTransport(server);\n  return server;\n}\n\nexport function generateBundle(name = 'master', cwd = process.cwd()) {\n  const server = new CntxServer(cwd);\n  server.init();\n  server.generateBundle(name);\n  server.saveBundleStates();\n}\n\nexport function initConfig(cwd = process.cwd()) {\n  console.log('🚀 Starting initConfig...');\n  console.log('📂 Working directory:', cwd);\n\n  const server = new CntxServer(cwd);\n  console.log('📁 CNTX_DIR:', server.CNTX_DIR);\n  console.log('📄 CONFIG_FILE path:', server.CONFIG_FILE);\n\n  const defaultConfig = {\n    bundles: {\n      master: ['**/*']\n    }\n  };\n\n  try {\n    // Create .cntx directory\n    console.log('🔍 Checking if .cntx directory exists...');\n    if (!existsSync(server.CNTX_DIR)) {\n      console.log('📁 Creating .cntx directory...');\n      mkdirSync(server.CNTX_DIR, { recursive: true });\n      console.log('✅ .cntx directory created');\n    } else {\n      console.log('✅ .cntx directory already exists');\n    }\n\n    // List directory contents before writing config\n    console.log('📋 Directory contents before writing config:');\n    const beforeFiles = readdirSync(server.CNTX_DIR);\n    console.log('Files:', beforeFiles);\n\n    // Write config.json\n    console.log('📝 Writing config.json...');\n    console.log('📄 Config content:', JSON.stringify(defaultConfig, null, 2));\n    console.log('📍 Writing to path:', server.CONFIG_FILE);\n\n    writeFileSync(server.CONFIG_FILE, JSON.stringify(defaultConfig, null, 2));\n    console.log('✅ writeFileSync completed');\n\n    // Verify file was created\n    console.log('🔍 Checking if config.json exists...');\n    const configExists = existsSync(server.CONFIG_FILE);\n    console.log('Config exists?', configExists);\n\n    if (configExists) {\n      const configContent = readFileSync(server.CONFIG_FILE, 'utf8');\n      console.log('✅ Config file created successfully');\n      console.log('📖 Config content:', configContent);\n    } else {\n      console.log('❌ Config file was NOT created');\n    }\n\n    // List directory contents after writing config\n    console.log('📋 Directory contents after writing config:');\n    const afterFiles = readdirSync(server.CNTX_DIR);\n    console.log('Files:', afterFiles);\n\n  } catch (error) {\n    console.error('❌ Error in initConfig:', error);\n    console.error('Stack trace:', error.stack);\n    throw error;\n  }\n\n  // Create cursor rules if they don't exist\n  try {\n    if (!existsSync(server.CURSOR_RULES_FILE)) {\n      console.log('📋 Creating cursor rules...');\n      const cursorRules = server.getDefaultCursorRules();\n      server.saveCursorRules(cursorRules);\n      console.log(`📋 Created ${relative(cwd, server.CURSOR_RULES_FILE)} with project-specific rules`);\n    }\n  } catch (error) {\n    console.error('❌ Error creating cursor rules:', error);\n  }\n\n  console.log('✅ cntx-ui initialized');\n  console.log(`📝 Edit ${relative(cwd, server.CONFIG_FILE)} to customize bundles`);\n  console.log(`🚫 Edit ${relative(cwd, server.IGNORE_FILE)} to customize ignored files`);\n  console.log(`🤖 Edit ${relative(cwd, server.CURSOR_RULES_FILE)} to customize AI assistant rules`);\n  console.log(`🎯 Use AI to suggest bundle configurations: run 'cntx-ui bundle master' then use the setup guide`);\n}\n\nexport function getStatus(cwd = process.cwd()) {\n  const server = new CntxServer(cwd);\n  server.init();\n\n  console.log(`📁 Working directory: ${server.CWD}`);\n  console.log(`📦 Bundles configured: ${server.bundles.size}`);\n  server.bundles.forEach((bundle, name) => {\n    const status = bundle.changed ? '🔄 CHANGED' : '✅ SYNCED';\n    console.log(`  ${name}: ${bundle.files.length} files ${status}`);\n  });\n\n  const hasCursorRules = existsSync(server.CURSOR_RULES_FILE);\n  console.log(`🤖 Cursor rules: ${hasCursorRules ? '✅ Configured' : '❌ Not found'}`);\n}\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.688Z",
    "size": 47353
  },
  "frontend": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"frontend\" generated=\"2025-06-18T12:10:52.691Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"20\">\n    <cntx:file path=\"web/index.html\" ext=\".html\">\n      <cntx:meta size=\"366\" modified=\"2025-06-06T22:55:53.331Z\" />\n      <cntx:content><![CDATA[<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/vite.svg\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Vite + React + TS</title>\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/BundleConfig.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"25321\" modified=\"2025-06-07T04:44:57.973Z\" />\n      <cntx:content><![CDATA[import { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Input } from './ui/input'\nimport { Badge } from './ui/badge'\nimport { Textarea } from './ui/textarea'\nimport { Trash2, Plus, Save, Eye, AlertTriangle, Settings, X } from 'lucide-react'\nimport { useButtonFeedback } from '../hooks/useButtonFeedback'\nimport { getButtonIcon, getButtonClassName } from '../utils/buttonHelpers'\nimport { toast } from 'sonner'\n\n// Extend Window interface for timeout\ndeclare global {\n  interface Window {\n    patternChangeTimeout?: NodeJS.Timeout\n  }\n}\n\ninterface BundleConfig {\n  bundles: Record<string, string[]>\n}\n\ninterface Bundle {\n  name: string\n  files: string[]\n  size: number\n}\n\nconst fetchConfig = async (): Promise<BundleConfig> => {\n  const response = await fetch('http://localhost:3333/api/config')\n  if (!response.ok) throw new Error('Failed to fetch config')\n  return response.json()\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nconst saveConfig = async (config: BundleConfig): Promise<void> => {\n  const response = await fetch('http://localhost:3333/api/config', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(config)\n  })\n  if (!response.ok) throw new Error('Failed to save config')\n}\n\nconst testPattern = async (pattern: string): Promise<string[]> => {\n  const response = await fetch('http://localhost:3333/api/test-pattern', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ pattern })\n  })\n  if (!response.ok) throw new Error('Failed to test pattern')\n  return response.json()\n}\n\nexport function BundleConfig() {\n  const queryClient = useQueryClient()\n  const [editingConfig, setEditingConfig] = useState<BundleConfig | null>(null)\n  const [testingPattern, setTestingPattern] = useState('')\n  const [testResults, setTestResults] = useState<string[]>([])\n  const [pasteConfigText, setPasteConfigText] = useState('')\n\n  // New bundle creation state\n  const [showAddBundle, setShowAddBundle] = useState(false)\n  const [newBundleName, setNewBundleName] = useState('')\n  const [newBundlePatterns, setNewBundlePatterns] = useState('**/*')\n\n  const { setButtonState, getButtonState, isLoading } = useButtonFeedback()\n\n  const { data: config, isLoading: configLoading } = useQuery({\n    queryKey: ['config'],\n    queryFn: fetchConfig\n  })\n\n  const { data: bundles } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000\n  })\n\n  const saveMutation = useMutation({\n    mutationFn: saveConfig,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      setEditingConfig(null)\n      setButtonState('save', 'success')\n      toast.success('Configuration saved successfully!')\n    },\n    onError: (error) => {\n      setButtonState('save', 'error')\n      toast.error(`Failed to save config: ${error.message}`)\n    }\n  })\n\n  useEffect(() => {\n    if (config && !editingConfig) {\n      setEditingConfig(config)\n    }\n  }, [config])\n\n  const handleSave = () => {\n    if (editingConfig) {\n      setButtonState('save', 'loading')\n      saveMutation.mutate(editingConfig)\n    }\n  }\n\n  const handleTestPattern = async () => {\n    if (!testingPattern.trim()) return\n\n    setButtonState('test', 'loading')\n    try {\n      const results = await testPattern(testingPattern)\n      setTestResults(results)\n      setButtonState('test', 'success')\n      toast.success(`Pattern matched ${results.length} files`)\n    } catch (error) {\n      console.error('Pattern test failed:', error)\n      setTestResults([])\n      setButtonState('test', 'error')\n      toast.error('Failed to test pattern')\n    }\n  }\n\n  const handlePasteConfig = async () => {\n    if (!pasteConfigText.trim()) return\n\n    setButtonState('paste', 'loading')\n    try {\n      const parsed = JSON.parse(pasteConfigText)\n      if (!parsed.bundles || typeof parsed.bundles !== 'object') {\n        throw new Error('Configuration must have a \"bundles\" object')\n      }\n\n      // Ensure master bundle exists\n      if (!parsed.bundles.master) {\n        parsed.bundles.master = ['**/*']\n      }\n\n      setEditingConfig({\n        bundles: Object.fromEntries(\n          Object.entries(parsed.bundles).map(([name, patterns]) => [\n            name,\n            Array.isArray(patterns) ? patterns : [patterns]\n          ])\n        )\n      })\n\n      const bundleCount = Object.keys(parsed.bundles).length\n      setPasteConfigText('')\n      setButtonState('paste', 'success')\n      toast.success(`Applied ${bundleCount} bundles successfully`)\n    } catch (error) {\n      setButtonState('paste', 'error')\n      toast.error(`Invalid configuration: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  // Handle adding new bundle - immediately save to system\n  const handleAddBundle = async () => {\n    if (!editingConfig || !newBundleName.trim()) return\n\n    const trimmedName = newBundleName.trim()\n\n    if (editingConfig.bundles[trimmedName]) {\n      toast.error(`Bundle \"${trimmedName}\" already exists`)\n      return\n    }\n\n    // Parse patterns (split by newlines, filter empty)\n    const patterns = newBundlePatterns\n      .split('\\n')\n      .map(p => p.trim())\n      .filter(p => p.length > 0)\n\n    if (patterns.length === 0) {\n      toast.error('At least one pattern is required')\n      return\n    }\n\n    const newConfig = {\n      ...editingConfig,\n      bundles: {\n        ...editingConfig.bundles,\n        [trimmedName]: patterns\n      }\n    }\n\n    try {\n      // Immediately save to system\n      setButtonState('create-bundle', 'loading')\n      await saveConfig(newConfig)\n\n      // Update local state\n      setEditingConfig(newConfig)\n\n      // Reset form\n      setNewBundleName('')\n      setNewBundlePatterns('**/*')\n      setShowAddBundle(false)\n\n      // Force refresh ALL bundle-related queries\n      await queryClient.invalidateQueries({ queryKey: ['config'] })\n      await queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      await queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n\n      // Also force refetch to ensure immediate update\n      queryClient.refetchQueries({ queryKey: ['bundles'] })\n\n      setButtonState('create-bundle', 'success')\n      toast.success(`Bundle \"${trimmedName}\" created and saved!`)\n    } catch (error) {\n      setButtonState('create-bundle', 'error')\n      toast.error(`Failed to create bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handleDeleteBundle = async (bundleName: string) => {\n    if (!editingConfig || bundleName === 'master') return\n    if (!confirm(`Delete bundle \"${bundleName}\"?`)) return\n\n    try {\n      setButtonState(`delete-${bundleName}`, 'loading')\n\n      // Create new config without the deleted bundle\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { [bundleName]: deleted, ...rest } = editingConfig.bundles\n      const newConfig = { ...editingConfig, bundles: rest }\n\n      // Immediately save to system\n      await saveConfig(newConfig)\n\n      // Update local state\n      setEditingConfig(newConfig)\n\n      // Wait a moment for server to process\n      await new Promise(resolve => setTimeout(resolve, 500))\n\n      // Force clear all cache and refetch\n      queryClient.removeQueries({ queryKey: ['bundles'] })\n      queryClient.removeQueries({ queryKey: ['config'] })\n      queryClient.removeQueries({ queryKey: ['bundle-visibility-stats'] })\n\n      // Force immediate refetch\n      await queryClient.refetchQueries({ queryKey: ['bundles'] })\n      await queryClient.refetchQueries({ queryKey: ['config'] })\n\n      setButtonState(`delete-${bundleName}`, 'success')\n      toast.success(`Bundle \"${bundleName}\" deleted successfully!`)\n    } catch (error) {\n      setButtonState(`delete-${bundleName}`, 'error')\n      toast.error(`Failed to delete bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handlePatternChange = async (bundleName: string, index: number, newPattern: string) => {\n    if (!editingConfig) return\n\n    const newPatterns = [...editingConfig.bundles[bundleName]]\n    newPatterns[index] = newPattern\n    const newConfig = {\n      ...editingConfig,\n      bundles: { ...editingConfig.bundles, [bundleName]: newPatterns }\n    }\n\n    setEditingConfig(newConfig)\n\n    // Debounced save - only save after user stops typing for 1 second\n    clearTimeout(window.patternChangeTimeout)\n    window.patternChangeTimeout = setTimeout(async () => {\n      try {\n        await saveConfig(newConfig)\n        queryClient.invalidateQueries({ queryKey: ['config'] })\n        queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      } catch (error) {\n        toast.error(`Failed to save pattern change: ${error instanceof Error ? error.message : 'Unknown error'}`)\n      }\n    }, 1000)\n  }\n\n  const handleAddPattern = async (bundleName: string) => {\n    if (!editingConfig) return\n\n    const newConfig = {\n      ...editingConfig,\n      bundles: {\n        ...editingConfig.bundles,\n        [bundleName]: [...editingConfig.bundles[bundleName], '']\n      }\n    }\n\n    try {\n      await saveConfig(newConfig)\n      setEditingConfig(newConfig)\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Pattern added')\n    } catch (error) {\n      toast.error(`Failed to add pattern: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const handleRemovePattern = async (bundleName: string, index: number) => {\n    if (!editingConfig || editingConfig.bundles[bundleName].length === 1) return\n\n    const newPatterns = editingConfig.bundles[bundleName].filter((_, i) => i !== index)\n    const newConfig = {\n      ...editingConfig,\n      bundles: { ...editingConfig.bundles, [bundleName]: newPatterns }\n    }\n\n    try {\n      await saveConfig(newConfig)\n      setEditingConfig(newConfig)\n      queryClient.invalidateQueries({ queryKey: ['config'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Pattern removed')\n    } catch (error) {\n      toast.error(`Failed to remove pattern: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const getBundleStats = (bundleName: string) => {\n    const bundle = bundles?.find(b => b.name === bundleName)\n    return bundle ? { files: bundle.files.length, size: bundle.size } : { files: 0, size: 0 }\n  }\n\n  const formatSize = (bytes: number) => {\n    if (bytes === 0) return '0 B'\n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n  }\n\n  if (configLoading) return <div>Loading configuration...</div>\n  if (!editingConfig) return <div>No configuration found</div>\n\n  const hasChanges = JSON.stringify(config) !== JSON.stringify(editingConfig)\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-lg font-semibold\">Bundle Configuration</h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Define patterns for each bundle. Use glob patterns like *.js, src/**/*.tsx, etc.\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setEditingConfig(config || null)}\n            disabled={!hasChanges}\n          >\n            Reset\n          </Button>\n          <Button\n            onClick={handleSave}\n            disabled={!hasChanges || isLoading('save')}\n            className={getButtonClassName(getButtonState('save'))}\n          >\n            {getButtonIcon(getButtonState('save'), <Save className=\"w-4 h-4\" />)}\n            <span className=\"ml-1\">Save Changes</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Paste Configuration */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Settings className=\"w-4 h-4\" />\n            Paste Bundle Configuration\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Textarea\n            placeholder=\"Paste bundle configuration JSON here...\"\n            value={pasteConfigText}\n            onChange={(e) => setPasteConfigText(e.target.value)}\n            className=\"min-h-32 font-mono text-sm\"\n          />\n          <div className=\"flex gap-2\">\n            <Button\n              onClick={handlePasteConfig}\n              disabled={!pasteConfigText.trim() || isLoading('paste')}\n              className={getButtonClassName(getButtonState('paste'))}\n            >\n              {getButtonIcon(getButtonState('paste'), <Settings className=\"w-4 h-4\" />)}\n              <span className=\"ml-1\">Apply Configuration</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => setPasteConfigText('')}\n              disabled={!pasteConfigText.trim()}\n            >\n              Clear\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Pattern Tester */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Eye className=\"w-4 h-4\" />\n            Pattern Tester\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-2\">\n            <Input\n              placeholder=\"Test a glob pattern (e.g., src/**/*.ts)\"\n              value={testingPattern}\n              onChange={(e) => setTestingPattern(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && handleTestPattern()}\n            />\n            <Button\n              onClick={handleTestPattern}\n              disabled={!testingPattern.trim() || isLoading('test')}\n              className={getButtonClassName(getButtonState('test'))}\n            >\n              {getButtonIcon(getButtonState('test'), <Eye className=\"w-4 h-4\" />)}\n              <span className=\"ml-1\">Test</span>\n            </Button>\n          </div>\n\n          {testResults.length > 0 && (\n            <div className=\"space-y-2\">\n              <div className=\"text-sm font-medium\">\n                Matches {testResults.length} files:\n              </div>\n              <div className=\"max-h-40 overflow-y-auto bg-muted p-3 rounded-md\">\n                {testResults.slice(0, 20).map((file, i) => (\n                  <div key={i} className=\"text-sm font-mono\">{file}</div>\n                ))}\n                {testResults.length > 20 && (\n                  <div className=\"text-sm text-muted-foreground\">\n                    ... and {testResults.length - 20} more files\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Bundle Enhancement Options - NEW SECTION */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Settings className=\"w-4 h-4\" />\n            Bundle Enhancement Options\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {/* Structure & Context */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-sm\">Structure & Context</h4>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Directory Tree</div>\n                    <div className=\"text-xs text-muted-foreground\">Include project structure overview</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+10%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">File Types</div>\n                    <div className=\"text-xs text-muted-foreground\">Auto-detect file purposes</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+5%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Dependencies</div>\n                    <div className=\"text-xs text-muted-foreground\">Import/export mapping</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+25%</Badge>\n                </label>\n              </div>\n            </div>\n\n            {/* AI Instructions */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-sm\">AI Instructions</h4>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" defaultChecked className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Bundle Purpose</div>\n                    <div className=\"text-xs text-muted-foreground\">What this bundle is for</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+2%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" defaultChecked className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Cursor Rules</div>\n                    <div className=\"text-xs text-muted-foreground\">Include .cursorrules content</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+15%</Badge>\n                </label>\n\n                <label className=\"flex items-center gap-3\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm\">Custom Instructions</div>\n                    <div className=\"text-xs text-muted-foreground\">Bundle-specific AI guidance</div>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">+5%</Badge>\n                </label>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-blue-50 p-3 rounded-md\">\n            <div className=\"text-sm text-blue-800\">\n              <strong>Coming Soon:</strong> These enhancement options will add rich context to your bundles,\n              making them more useful for AI agents. Enable features based on your needs vs. bundle size preferences.\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Bundle Configurations */}\n      <div className=\"space-y-4\">\n        {Object.entries(editingConfig.bundles).map(([bundleName, patterns]) => {\n          const stats = getBundleStats(bundleName)\n          const isLarge = stats.size > 10 * 1024 * 1024\n\n          return (\n            <Card key={bundleName} className={isLarge ? 'border-yellow-500' : ''}>\n              <CardHeader>\n                <div className=\"flex justify-between items-center\">\n                  <div className=\"flex items-center gap-3\">\n                    <CardTitle>{bundleName}</CardTitle>\n                    <Badge variant=\"outline\">\n                      {stats.files} files • {formatSize(stats.size)}\n                    </Badge>\n                    {isLarge && (\n                      <Badge variant=\"destructive\" className=\"flex items-center gap-1\">\n                        <AlertTriangle className=\"w-3 h-3\" />\n                        Large\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleAddPattern(bundleName)}\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                      Add Pattern\n                    </Button>\n                    {bundleName !== 'master' && (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteBundle(bundleName)}\n                        disabled={isLoading(`delete-${bundleName}`)}\n                        className={getButtonClassName(getButtonState(`delete-${bundleName}`))}\n                      >\n                        {getButtonIcon(getButtonState(`delete-${bundleName}`), <Trash2 className=\"w-4 h-4\" />)}\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {patterns.map((pattern, index) => (\n                  <div key={index} className=\"flex gap-2\">\n                    <Input\n                      value={pattern}\n                      onChange={(e) => handlePatternChange(bundleName, index, e.target.value)}\n                      placeholder=\"Glob pattern (e.g., src/**/*.ts)\"\n                      className=\"font-mono\"\n                    />\n                    {patterns.length > 1 && (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleRemovePattern(bundleName, index)}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    )}\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          )\n        })}\n      </div>\n\n      {/* Add New Bundle */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          {!showAddBundle ? (\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowAddBundle(true)}\n              className=\"w-full\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add New Bundle\n            </Button>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between items-center\">\n                <h3 className=\"text-lg font-medium\">Create New Bundle</h3>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => {\n                    setShowAddBundle(false)\n                    setNewBundleName('')\n                    setNewBundlePatterns('**/*')\n                  }}\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div>\n                  <label className=\"text-sm font-medium\">Bundle Name</label>\n                  <Input\n                    placeholder=\"e.g., frontend, backend, tests\"\n                    value={newBundleName}\n                    onChange={(e) => setNewBundleName(e.target.value)}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-medium\">Patterns (one per line)</label>\n                  <Textarea\n                    placeholder=\"src/components/**/*&#10;src/pages/**/*&#10;*.jsx\"\n                    value={newBundlePatterns}\n                    onChange={(e) => setNewBundlePatterns(e.target.value)}\n                    className=\"font-mono text-sm\"\n                    rows={4}\n                  />\n                  <div className=\"text-xs text-muted-foreground mt-1\">\n                    Examples: <code>src/**/*.ts</code>, <code>**/*.test.*</code>, <code>docs/**/*</code>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  onClick={handleAddBundle}\n                  disabled={!newBundleName.trim() || isLoading('create-bundle')}\n                  className={getButtonClassName(getButtonState('create-bundle'))}\n                >\n                  {getButtonIcon(getButtonState('create-bundle'), <Plus className=\"w-4 h-4\" />)}\n                  <span className=\"ml-1\">Create Bundle</span>\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setShowAddBundle(false)\n                    setNewBundleName('')\n                    setNewBundlePatterns('**/*')\n                  }}\n                  disabled={isLoading('create-bundle')}\n                >\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/BundleList.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"10870\" modified=\"2025-06-07T04:25:04.875Z\" />\n      <cntx:content><![CDATA[// web/src/components/BundleList.tsx\nimport { useQuery } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Copy, RefreshCw, ChevronDown, ChevronRight, Loader2, CheckCircle, AlertCircle, Download } from 'lucide-react'\nimport { useState } from 'react'\nimport { toast } from 'sonner'\n\ninterface Bundle {\n  name: string\n  changed: boolean\n  fileCount: number\n  content: string\n  files: string[]\n  lastGenerated: string\n  size: number\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nexport function BundleList() {\n  const { data: bundles, isLoading, refetch } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000,\n  })\n\n  const [expandedBundles, setExpandedBundles] = useState<Set<string>>(new Set())\n  const [loadingButtons, setLoadingButtons] = useState<Set<string>>(new Set())\n  const [successButtons, setSuccessButtons] = useState<Set<string>>(new Set())\n  const [errorButtons, setErrorButtons] = useState<Set<string>>(new Set())\n\n  const toggleExpanded = (bundleName: string) => {\n    const newExpanded = new Set(expandedBundles)\n    if (newExpanded.has(bundleName)) {\n      newExpanded.delete(bundleName)\n    } else {\n      newExpanded.add(bundleName)\n    }\n    setExpandedBundles(newExpanded)\n  }\n\n  const setButtonState = (key: string, state: 'loading' | 'success' | 'error' | 'idle') => {\n    setLoadingButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'loading') newSet.add(key)\n      else newSet.delete(key)\n      return newSet\n    })\n\n    setSuccessButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'success') {\n        newSet.add(key)\n        // Auto-clear success state after 2 seconds\n        setTimeout(() => setSuccessButtons(current => {\n          const updated = new Set(current)\n          updated.delete(key)\n          return updated\n        }), 2000)\n      } else {\n        newSet.delete(key)\n      }\n      return newSet\n    })\n\n    setErrorButtons(prev => {\n      const newSet = new Set(prev)\n      if (state === 'error') {\n        newSet.add(key)\n        // Auto-clear error state after 3 seconds\n        setTimeout(() => setErrorButtons(current => {\n          const updated = new Set(current)\n          updated.delete(key)\n          return updated\n        }), 3000)\n      } else {\n        newSet.delete(key)\n      }\n      return newSet\n    })\n  }\n\n  const copyBundle = async (bundleName: string) => {\n    const key = `copy-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/bundles/${bundleName}`)\n      if (!response.ok) throw new Error('Failed to fetch bundle content')\n\n      const content = await response.text()\n      await navigator.clipboard.writeText(content)\n\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" copied to clipboard!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to copy bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const downloadBundle = async (bundleName: string) => {\n    const key = `download-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/bundles/${bundleName}`)\n      if (!response.ok) throw new Error('Failed to fetch bundle content')\n\n      const content = await response.text()\n      const blob = new Blob([content], { type: 'application/xml' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `${bundleName}-bundle.xml`\n      a.click()\n      URL.revokeObjectURL(url)\n\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" downloaded!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to download bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  const regenerateBundle = async (bundleName: string) => {\n    const key = `regen-${bundleName}`\n    setButtonState(key, 'loading')\n\n    try {\n      const response = await fetch(`http://localhost:3333/api/regenerate/${bundleName}`, {\n        method: 'POST'\n      })\n      if (!response.ok) throw new Error('Failed to regenerate bundle')\n\n      await refetch()\n      setButtonState(key, 'success')\n      toast.success(`Bundle \"${bundleName}\" regenerated successfully!`)\n    } catch (error) {\n      setButtonState(key, 'error')\n      toast.error(`Failed to regenerate bundle: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  if (isLoading) return <div>Loading bundles...</div>\n  if (!bundles) return <div>No bundles found</div>\n\n  return (\n    <div className=\"space-y-4\">\n      {bundles.map((bundle) => {\n        const copyKey = `copy-${bundle.name}`\n        const downloadKey = `download-${bundle.name}`\n        const regenKey = `regen-${bundle.name}`\n        const isCopyLoading = loadingButtons.has(copyKey)\n        const isDownloadLoading = loadingButtons.has(downloadKey)\n        const isRegenLoading = loadingButtons.has(regenKey)\n        const isCopySuccess = successButtons.has(copyKey)\n        const isDownloadSuccess = successButtons.has(downloadKey)\n        const isRegenSuccess = successButtons.has(regenKey)\n        const isCopyError = errorButtons.has(copyKey)\n        const isDownloadError = errorButtons.has(downloadKey)\n        const isRegenError = errorButtons.has(regenKey)\n\n        return (\n          <Card key={bundle.name} className={bundle.changed ? 'border-yellow-500' : ''}>\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  {bundle.name}\n                  <Badge variant={bundle.changed ? 'destructive' : 'secondary'}>\n                    {bundle.changed ? 'CHANGED' : 'SYNCED'}\n                  </Badge>\n                </CardTitle>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => regenerateBundle(bundle.name)}\n                    disabled={isRegenLoading}\n                    className={`transition-all duration-200 ${isRegenSuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isRegenError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isRegenLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isRegenLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isRegenSuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isRegenError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <RefreshCw className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Regenerate\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => copyBundle(bundle.name)}\n                    disabled={isCopyLoading}\n                    className={`transition-all duration-200 ${isCopySuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isCopyError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isCopyLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isCopyLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isCopySuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isCopyError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <Copy className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Copy XML\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => downloadBundle(bundle.name)}\n                    disabled={isDownloadLoading}\n                    className={`transition-all duration-200 ${isDownloadSuccess ? 'border-green-500 bg-green-50 text-green-700' :\n                      isDownloadError ? 'border-red-500 bg-red-50 text-red-700' :\n                        isDownloadLoading ? 'opacity-75' : ''\n                      }`}\n                  >\n                    {isDownloadLoading ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-1\" />\n                    ) : isDownloadSuccess ? (\n                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-600\" />\n                    ) : isDownloadError ? (\n                      <AlertCircle className=\"w-4 h-4 mr-1 text-red-600\" />\n                    ) : (\n                      <Download className=\"w-4 h-4 mr-1\" />\n                    )}\n                    Download\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-sm text-muted-foreground mb-3\">\n                {bundle.fileCount} files • {(bundle.size / 1024).toFixed(1)}kb\n                {bundle.lastGenerated &&\n                  ` • Generated ${new Date(bundle.lastGenerated).toLocaleTimeString()}`\n                }\n              </div>\n\n              <div className=\"space-y-2\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => toggleExpanded(bundle.name)}\n                  className=\"p-0 h-auto font-normal\"\n                >\n                  {expandedBundles.has(bundle.name) ? (\n                    <ChevronDown className=\"w-4 h-4 mr-1\" />\n                  ) : (\n                    <ChevronRight className=\"w-4 h-4 mr-1\" />\n                  )}\n                  View Files ({bundle.files.length})\n                </Button>\n\n                {expandedBundles.has(bundle.name) && (\n                  <div className=\"ml-5 space-y-1 max-h-40 overflow-y-auto\">\n                    {bundle.files.map((file) => (\n                      <div key={file} className=\"text-sm font-mono text-muted-foreground\">\n                        {file}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        )\n      })}\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/CursorRulesManager.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"15259\" modified=\"2025-06-07T01:48:54.713Z\" />\n      <cntx:content><![CDATA[// Updated CursorRulesManager.tsx\nimport { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Textarea } from './ui/textarea'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs'\nimport { Save, RefreshCw, Copy, Download, Upload, Sparkles, FileText, Info } from 'lucide-react'\nimport { useButtonFeedback } from '../hooks/useButtonFeedback'\nimport { getButtonIcon, getButtonClassName } from '../utils/buttonHelpers'\nimport { toast } from 'sonner'\n\ninterface CursorRulesTemplates {\n  react: string\n  node: string\n  general: string\n}\n\nconst fetchCursorRules = async (): Promise<string> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules')\n  if (!response.ok) throw new Error('Failed to fetch cursor rules')\n  return response.text()\n}\n\nconst saveCursorRules = async (content: string): Promise<void> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ content })\n  })\n  if (!response.ok) throw new Error('Failed to save cursor rules')\n}\n\nconst fetchTemplates = async (): Promise<CursorRulesTemplates> => {\n  const response = await fetch('http://localhost:3333/api/cursor-rules/templates')\n  if (!response.ok) throw new Error('Failed to fetch templates')\n  return response.json()\n}\n\nexport function CursorRulesManager() {\n  const queryClient = useQueryClient()\n  const [editingRules, setEditingRules] = useState<string>('')\n  const [selectedTemplate, setSelectedTemplate] = useState<string>('')\n\n  const { setButtonState, getButtonState, isLoading } = useButtonFeedback()\n\n  const { data: currentRules, isLoading: rulesLoading } = useQuery({\n    queryKey: ['cursor-rules'],\n    queryFn: fetchCursorRules\n  })\n\n  const { data: templates } = useQuery({\n    queryKey: ['cursor-templates'],\n    queryFn: fetchTemplates\n  })\n\n  const saveMutation = useMutation({\n    mutationFn: saveCursorRules,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['cursor-rules'] })\n      setButtonState('save', 'success')\n      toast.success('Cursor rules saved successfully!')\n    },\n    onError: (error) => {\n      setButtonState('save', 'error')\n      toast.error(`Failed to save cursor rules: ${error.message}`)\n    }\n  })\n\n  useEffect(() => {\n    if (currentRules && !editingRules) {\n      setEditingRules(currentRules)\n    }\n  }, [currentRules])\n\n  const handleSave = () => {\n    if (editingRules) {\n      setButtonState('save', 'loading')\n      saveMutation.mutate(editingRules)\n    }\n  }\n\n  const handleReset = () => {\n    setEditingRules(currentRules || '')\n    toast.info('Reset to last saved version')\n  }\n\n  const handleLoadTemplate = (templateType: keyof CursorRulesTemplates) => {\n    if (templates && templates[templateType]) {\n      setEditingRules(templates[templateType])\n      setSelectedTemplate(templateType)\n      toast.success(`Loaded ${templateType} template`)\n    }\n  }\n\n  const copyToClipboard = async () => {\n    if (!editingRules) return\n\n    setButtonState('copy', 'loading')\n    try {\n      await navigator.clipboard.writeText(editingRules)\n      setButtonState('copy', 'success')\n      toast.success('Cursor rules copied to clipboard!')\n    } catch (error) {\n      setButtonState('copy', 'error')\n      toast.error('Failed to copy to clipboard')\n    }\n  }\n\n  const downloadRules = () => {\n    setButtonState('download', 'loading')\n    try {\n      const blob = new Blob([editingRules], { type: 'text/plain' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = '.cursorrules'\n      a.click()\n      URL.revokeObjectURL(url)\n      setButtonState('download', 'success')\n      toast.success('Cursor rules downloaded!')\n    } catch (error) {\n      setButtonState('download', 'error')\n      toast.error('Failed to download file')\n    }\n  }\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n\n    setButtonState('upload', 'loading')\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      const content = e.target?.result as string\n      setEditingRules(content)\n      setButtonState('upload', 'success')\n      toast.success('Cursor rules uploaded successfully!')\n    }\n    reader.onerror = () => {\n      setButtonState('upload', 'error')\n      toast.error('Failed to read file')\n    }\n    reader.readAsText(file)\n  }\n\n  if (rulesLoading) return <div>Loading cursor rules...</div>\n\n  const hasChanges = currentRules !== editingRules\n  const wordCount = editingRules.split(/\\s+/).filter(word => word.length > 0).length\n  const lineCount = editingRules.split('\\n').length\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-start\">\n        <div>\n          <h2 className=\"text-lg font-semibold flex items-center gap-2\">\n            <Sparkles className=\"w-5 h-5\" />\n            Cursor Rules Management\n          </h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Configure AI assistant behavior and project context for Cursor IDE\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={handleReset}\n            disabled={!hasChanges}\n          >\n            <RefreshCw className=\"w-4 h-4 mr-1\" />\n            Reset\n          </Button>\n          <Button\n            onClick={handleSave}\n            disabled={!hasChanges || isLoading('save')}\n            className={`bg-purple-600 hover:bg-purple-700 ${getButtonClassName(getButtonState('save'))}`}\n          >\n            {getButtonIcon(getButtonState('save'), <Save className=\"w-4 h-4\" />)}\n            <span className=\"ml-1\">Save Rules</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Status Info */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <FileText className=\"w-4 h-4 text-muted-foreground\" />\n                <span className=\"text-sm text-muted-foreground\">\n                  {lineCount} lines • {wordCount} words\n                </span>\n              </div>\n              {currentRules && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-green-700\">.cursorrules file exists</span>\n                </div>\n              )}\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={copyToClipboard}\n                disabled={isLoading('copy')}\n                className={getButtonClassName(getButtonState('copy'))}\n              >\n                {getButtonIcon(getButtonState('copy'), <Copy className=\"w-4 h-4\" />)}\n                <span className=\"ml-1\">Copy</span>\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={downloadRules}\n                disabled={isLoading('download')}\n                className={getButtonClassName(getButtonState('download'))}\n              >\n                {getButtonIcon(getButtonState('download'), <Download className=\"w-4 h-4\" />)}\n                <span className=\"ml-1\">Download</span>\n              </Button>\n              <label className=\"cursor-pointer\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  asChild\n                  className={getButtonClassName(getButtonState('upload'))}\n                >\n                  <span>\n                    {getButtonIcon(getButtonState('upload'), <Upload className=\"w-4 h-4\" />)}\n                    <span className=\"ml-1\">Upload</span>\n                  </span>\n                </Button>\n                <input\n                  type=\"file\"\n                  accept=\".cursorrules,.txt,.md\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                />\n              </label>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Tabs defaultValue=\"editor\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"editor\">Rules Editor</TabsTrigger>\n          <TabsTrigger value=\"templates\">Templates</TabsTrigger>\n          <TabsTrigger value=\"help\">Help & Examples</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"editor\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Edit Cursor Rules</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {hasChanges && (\n                <Alert className=\"border-yellow-200 bg-yellow-50\">\n                  <Info className=\"w-4 h-4\" />\n                  <AlertDescription>\n                    You have unsaved changes. Click \"Save Rules\" to apply them to your .cursorrules file.\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              <Textarea\n                value={editingRules}\n                onChange={(e) => setEditingRules(e.target.value)}\n                placeholder=\"Enter your cursor rules here...\"\n                className=\"min-h-96 font-mono text-sm\"\n              />\n\n              {selectedTemplate && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">\n                    Template: {selectedTemplate}\n                  </span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setSelectedTemplate('')}\n                  >\n                    Clear\n                  </Button>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"templates\">\n          <div className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Templates</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Choose a template that matches your project type. You can customize it after loading.\n                </p>\n                <div className=\"grid gap-3\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('react')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">React Application</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Modern React with TypeScript, hooks, and Tailwind CSS\n                      </div>\n                    </div>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('node')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">Node.js Backend</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Express/Fastify backend with ES modules and TypeScript\n                      </div>\n                    </div>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleLoadTemplate('general')}\n                    className=\"justify-start h-auto p-4\"\n                  >\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">General Project</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Basic template for any type of project\n                      </div>\n                    </div>\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"help\">\n          <div className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>What are Cursor Rules?</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Cursor rules (.cursorrules) provide context and guidelines to AI assistants like Cursor IDE's AI.\n                  They help the AI understand your project structure, coding preferences, and best practices.\n                </p>\n\n                <div className=\"space-y-3\">\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Best Practices</h4>\n                    <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside\">\n                      <li>Include project context and technology stack</li>\n                      <li>Specify coding standards and naming conventions</li>\n                      <li>Document file organization patterns</li>\n                      <li>Mention important dependencies and frameworks</li>\n                      <li>Include team preferences and architectural decisions</li>\n                    </ul>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Example Sections</h4>\n                    <div className=\"bg-gray-50 p-3 rounded text-xs font-mono\">\n                      # Project Context<br />\n                      # Development Guidelines<br />\n                      # Code Style<br />\n                      # File Organization<br />\n                      # Bundle Context<br />\n                      # AI Assistant Instructions\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Integration with cntx-ui</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-muted-foreground mb-3\">\n                  Your cursor rules automatically include information about your cntx-ui bundle configuration,\n                  helping AI assistants understand your project structure and file organization.\n                </p>\n\n                <Alert>\n                  <Sparkles className=\"w-4 h-4\" />\n                  <AlertDescription>\n                    When you change your bundle configuration, consider updating your cursor rules\n                    to reflect the new project structure and help AI assistants provide better suggestions.\n                  </AlertDescription>\n                </Alert>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/FileTree.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"8572\" modified=\"2025-06-07T02:09:52.648Z\" />\n      <cntx:content><![CDATA[import { useQuery } from '@tanstack/react-query'\nimport { useState } from 'react'\nimport { ChevronDown, ChevronRight, File, Folder, FolderOpen } from 'lucide-react'\nimport { Button } from './ui/button'\nimport { Badge } from './ui/badge'\nimport { Card } from './ui/card'\n\ninterface FileNode {\n  name: string\n  path: string\n  type: 'file' | 'directory'\n  size?: number\n  children?: FileNode[]\n  bundles?: string[]\n}\n\ninterface Bundle {\n  name: string\n  files: string[]\n}\n\nconst fetchBundles = async (): Promise<Bundle[]> => {\n  const response = await fetch('http://localhost:3333/api/bundles')\n  if (!response.ok) throw new Error('Failed to fetch bundles')\n  return response.json()\n}\n\nconst buildFileTree = (bundles: Bundle[]): FileNode => {\n  const root: FileNode = { name: '', path: '', type: 'directory', children: [] }\n  const allFiles = new Set<string>()\n  const fileBundleMap = new Map<string, string[]>()\n\n  // Collect all files and their bundle associations\n  bundles.forEach(bundle => {\n    bundle.files.forEach(file => {\n      allFiles.add(file)\n      if (!fileBundleMap.has(file)) {\n        fileBundleMap.set(file, [])\n      }\n      fileBundleMap.get(file)!.push(bundle.name)\n    })\n  })\n\n  // Build tree structure\n  allFiles.forEach(filePath => {\n    const parts = filePath.split('/')\n    let current = root\n\n    parts.forEach((part, index) => {\n      const isFile = index === parts.length - 1\n      const currentPath = parts.slice(0, index + 1).join('/')\n\n      if (!current.children) current.children = []\n\n      let existing = current.children.find(child => child.name === part)\n\n      if (!existing) {\n        existing = {\n          name: part,\n          path: currentPath,\n          type: isFile ? 'file' : 'directory',\n          children: isFile ? undefined : [],\n          bundles: isFile ? fileBundleMap.get(filePath) : undefined\n        }\n        current.children.push(existing)\n      }\n\n      if (!isFile) {\n        current = existing\n      }\n    })\n  })\n\n  // Sort: directories first, then files, alphabetically\n  const sortChildren = (node: FileNode) => {\n    if (node.children) {\n      node.children.sort((a, b) => {\n        if (a.type !== b.type) {\n          return a.type === 'directory' ? -1 : 1\n        }\n        return a.name.localeCompare(b.name)\n      })\n      node.children.forEach(sortChildren)\n    }\n  }\n\n  sortChildren(root)\n  return root\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\ninterface FileTreeNodeProps {\n  node: FileNode\n  level: number\n  expandedDirs: Set<string>\n  onToggleDir: (path: string) => void\n}\n\nfunction FileTreeNode({ node, level, expandedDirs, onToggleDir }: FileTreeNodeProps) {\n  const isExpanded = expandedDirs.has(node.path)\n  const indent = level * 16\n\n  if (node.type === 'directory') {\n    return (\n      <div>\n        <div\n          className=\"flex items-center gap-2 py-1 px-2 hover:bg-muted/50 rounded cursor-pointer\"\n          style={{ paddingLeft: `${indent + 8}px` }}\n          onClick={() => onToggleDir(node.path)}\n        >\n          {isExpanded ? (\n            <ChevronDown className=\"w-4 h-4 text-muted-foreground\" />\n          ) : (\n            <ChevronRight className=\"w-4 h-4 text-muted-foreground\" />\n          )}\n          {isExpanded ? (\n            <FolderOpen className=\"w-4 h-4 text-blue-500\" />\n          ) : (\n            <Folder className=\"w-4 h-4 text-blue-500\" />\n          )}\n          <span className=\"text-sm font-medium\">{node.name}</span>\n          {node.children && (\n            <span className=\"text-xs text-muted-foreground ml-auto\">\n              {node.children.length} items\n            </span>\n          )}\n        </div>\n\n        {isExpanded && node.children && (\n          <div>\n            {node.children.map((child) => (\n              <FileTreeNode\n                key={child.path}\n                node={child}\n                level={level + 1}\n                expandedDirs={expandedDirs}\n                onToggleDir={onToggleDir}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // File node\n  const getFileIcon = (filename: string) => {\n    const ext = filename.split('.').pop()?.toLowerCase()\n    const iconClass = \"w-4 h-4\"\n\n    switch (ext) {\n      case 'js':\n      case 'ts':\n      case 'jsx':\n      case 'tsx':\n        return <File className={`${iconClass} text-yellow-500`} />\n      case 'json':\n        return <File className={`${iconClass} text-green-500`} />\n      case 'md':\n        return <File className={`${iconClass} text-blue-400`} />\n      case 'css':\n      case 'scss':\n        return <File className={`${iconClass} text-pink-500`} />\n      case 'html':\n        return <File className={`${iconClass} text-orange-500`} />\n      default:\n        return <File className={`${iconClass} text-muted-foreground`} />\n    }\n  }\n\n  return (\n    <div\n      className=\"flex items-center gap-2 py-1 px-2 hover:bg-muted/50 rounded\"\n      style={{ paddingLeft: `${indent + 24}px` }}\n    >\n      {getFileIcon(node.name)}\n      <span className=\"text-sm font-mono\">{node.name}</span>\n\n      {node.bundles && node.bundles.length > 0 && (\n        <div className=\"flex gap-1 ml-2\">\n          {node.bundles.map(bundle => (\n            <Badge\n              key={bundle}\n              variant=\"outline\"\n              className=\"text-xs px-1 py-0\"\n            >\n              {bundle}\n            </Badge>\n          ))}\n        </div>\n      )}\n\n      {node.size && (\n        <span className=\"text-xs text-muted-foreground ml-auto\">\n          {formatFileSize(node.size)}\n        </span>\n      )}\n    </div>\n  )\n}\n\nexport function FileTree() {\n  const [expandedDirs, setExpandedDirs] = useState<Set<string>>(new Set(['']))\n  // wtf is this shit broseph? \n  // const [showUnbundled, setShowUnbundled] = useState(false)\n\n  const { data: bundles, isLoading } = useQuery({\n    queryKey: ['bundles'],\n    queryFn: fetchBundles,\n    refetchInterval: 5000,\n  })\n\n  const handleToggleDir = (path: string) => {\n    const newExpanded = new Set(expandedDirs)\n    if (newExpanded.has(path)) {\n      newExpanded.delete(path)\n    } else {\n      newExpanded.add(path)\n    }\n    setExpandedDirs(newExpanded)\n  }\n\n  const expandAll = () => {\n    if (!bundles) return\n    const tree = buildFileTree(bundles)\n    const allDirs = new Set<string>()\n\n    const collectDirs = (node: FileNode) => {\n      if (node.type === 'directory') {\n        allDirs.add(node.path)\n        node.children?.forEach(collectDirs)\n      }\n    }\n\n    collectDirs(tree)\n    setExpandedDirs(allDirs)\n  }\n\n  const collapseAll = () => {\n    setExpandedDirs(new Set(['']))\n  }\n\n  if (isLoading) return <div>Loading file tree...</div>\n  if (!bundles) return <div>No bundles found</div>\n\n  const tree = buildFileTree(bundles)\n  const totalFiles = bundles.reduce((acc, bundle) => acc + bundle.files.length, 0)\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Controls */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" size=\"sm\" onClick={expandAll}>\n            Expand All\n          </Button>\n          <Button variant=\"outline\" size=\"sm\" onClick={collapseAll}>\n            Collapse All\n          </Button>\n        </div>\n\n        <div className=\"text-sm text-muted-foreground\">\n          {totalFiles} files tracked\n        </div>\n      </div>\n\n      {/* File Tree */}\n      <Card className=\"p-4\">\n        <div className=\"space-y-1 max-h-96 overflow-y-auto\">\n          {tree.children && tree.children.length > 0 ? (\n            tree.children.map((child) => (\n              <FileTreeNode\n                key={child.path}\n                node={child}\n                level={0}\n                expandedDirs={expandedDirs}\n                onToggleDir={handleToggleDir}\n              />\n            ))\n          ) : (\n            <div className=\"text-center text-muted-foreground py-8\">\n              No files found\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Bundle Legend */}\n      <Card className=\"p-4\">\n        <h3 className=\"text-sm font-medium mb-2\">Bundle Legend</h3>\n        <div className=\"flex flex-wrap gap-2\">\n          {bundles.map(bundle => (\n            <Badge key={bundle.name} variant=\"outline\">\n              {bundle.name} ({bundle.files.length})\n            </Badge>\n          ))}\n        </div>\n      </Card>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/HiddenFilesManager.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"25316\" modified=\"2025-06-07T04:24:52.900Z\" />\n      <cntx:content><![CDATA[import { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Input } from './ui/input'\nimport { Badge } from './ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs'\nimport {\n  Eye,\n  EyeOff,\n  Search,\n  Plus,\n  Trash2,\n  RotateCcw,\n  FileText,\n  Settings,\n  AlertCircle,\n  CheckCircle,\n  Info,\n} from 'lucide-react'\nimport { toast } from 'sonner'\n\ninterface FileWithVisibility {\n  path: string\n  size: number\n  modified: string\n  visible: boolean\n  globallyHidden: boolean\n  bundleHidden: boolean\n  inBundles: string[]\n  matchesIgnorePattern: boolean\n}\n\ninterface IgnorePattern {\n  pattern: string\n  active: boolean\n}\n\ninterface IgnorePatterns {\n  system: IgnorePattern[]\n  user: IgnorePattern[]\n  file: IgnorePattern[]\n}\n\ninterface BundleStats {\n  total: number\n  visible: number\n  hidden: number\n  patterns: string[]\n}\n\n// API functions\nconst fetchFilesWithVisibility = async (bundleName: string | null = null): Promise<FileWithVisibility[]> => {\n  const url = bundleName\n    ? `http://localhost:3333/api/files-with-visibility?bundle=${bundleName}`\n    : 'http://localhost:3333/api/files-with-visibility'\n  const response = await fetch(url)\n  if (!response.ok) throw new Error('Failed to fetch files')\n  return response.json()\n}\n\nconst fetchIgnorePatterns = async (): Promise<IgnorePatterns> => {\n  const response = await fetch('http://localhost:3333/api/ignore-patterns')\n  if (!response.ok) throw new Error('Failed to fetch ignore patterns')\n  return response.json()\n}\n\nconst fetchBundleVisibilityStats = async (): Promise<Record<string, BundleStats>> => {\n  const response = await fetch('http://localhost:3333/api/bundle-visibility-stats')\n  if (!response.ok) throw new Error('Failed to fetch bundle stats')\n  return response.json()\n}\n\nconst toggleFileVisibility = async ({ filePath, bundleName = null, forceHide = null }: {\n  filePath: string\n  bundleName?: string | null\n  forceHide?: boolean | null\n}) => {\n  const response = await fetch('http://localhost:3333/api/hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      action: 'toggle',\n      filePath,\n      bundleName,\n      forceHide\n    })\n  })\n  if (!response.ok) throw new Error('Failed to toggle file visibility')\n  return response.json()\n}\n\nconst bulkToggleVisibility = async ({ filePaths, bundleName = null, forceHide }: {\n  filePaths: string[]\n  bundleName?: string | null\n  forceHide: boolean\n}) => {\n  const response = await fetch('http://localhost:3333/api/hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      action: 'bulk-toggle',\n      filePaths,\n      bundleName,\n      forceHide\n    })\n  })\n  if (!response.ok) throw new Error('Failed to bulk toggle visibility')\n  return response.json()\n}\n\nconst manageIgnorePattern = async ({ action, pattern }: {\n  action: 'add' | 'remove' | 'toggle-system'\n  pattern: string\n}) => {\n  const response = await fetch('http://localhost:3333/api/ignore-patterns', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ action, pattern })\n  })\n  if (!response.ok) throw new Error('Failed to manage ignore pattern')\n  return response.json()\n}\n\nconst resetHiddenFiles = async ({ scope, bundleName = null }: {\n  scope: 'global' | 'bundle' | 'all'\n  bundleName?: string | null\n}) => {\n  const response = await fetch('http://localhost:3333/api/reset-hidden-files', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ scope, bundleName })\n  })\n  if (!response.ok) throw new Error('Failed to reset hidden files')\n  return response.json()\n}\n\nexport function HiddenFilesManager() {\n  const queryClient = useQueryClient()\n  const [selectedBundle, setSelectedBundle] = useState<string | null>(null)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [showHidden, setShowHidden] = useState(false)\n  const [filterBy, setFilterBy] = useState('all') // all, hidden, visible\n  const [newPattern, setNewPattern] = useState('')\n  const [selectedFiles, setSelectedFiles] = useState<string[]>([])\n\n  // Queries\n  const { data: files = [], isLoading: filesLoading } = useQuery({\n    queryKey: ['files-with-visibility', selectedBundle],\n    queryFn: () => fetchFilesWithVisibility(selectedBundle),\n    refetchInterval: 5000\n  })\n\n  const { data: ignorePatterns = { system: [], user: [], file: [] }, isLoading: patternsLoading } = useQuery({\n    queryKey: ['ignore-patterns'],\n    queryFn: fetchIgnorePatterns,\n    refetchInterval: 10000\n  })\n\n  const { data: bundleStats = {}, isLoading: statsLoading } = useQuery({\n    queryKey: ['bundle-visibility-stats'],\n    queryFn: fetchBundleVisibilityStats,\n    refetchInterval: 5000\n  })\n\n  // Mutations\n  const toggleFileMutation = useMutation({\n    mutationFn: toggleFileVisibility,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('File visibility updated')\n    },\n    onError: (error: Error) => toast.error(`Failed to update file visibility: ${error.message}`)\n  })\n\n  const bulkToggleMutation = useMutation({\n    mutationFn: bulkToggleVisibility,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      setSelectedFiles([])\n      toast.success('Bulk visibility update completed')\n    },\n    onError: (error: Error) => toast.error(`Failed to bulk update visibility: ${error.message}`)\n  })\n\n  const patternMutation = useMutation({\n    mutationFn: manageIgnorePattern,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['ignore-patterns'] })\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Ignore pattern updated')\n    },\n    onError: (error: Error) => toast.error(`Failed to update ignore pattern: ${error.message}`)\n  })\n\n  const resetMutation = useMutation({\n    mutationFn: resetHiddenFiles,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['files-with-visibility'] })\n      queryClient.invalidateQueries({ queryKey: ['bundle-visibility-stats'] })\n      queryClient.invalidateQueries({ queryKey: ['bundles'] })\n      toast.success('Hidden files reset successfully')\n    },\n    onError: (error: Error) => toast.error(`Failed to reset hidden files: ${error.message}`)\n  })\n\n  // Filter files\n  const filteredFiles = files.filter(file => {\n    const matchesSearch = file.path.toLowerCase().includes(searchTerm.toLowerCase())\n    const matchesVisibility = filterBy === 'all' ||\n      (filterBy === 'hidden' && !file.visible) ||\n      (filterBy === 'visible' && file.visible)\n    const shouldShow = showHidden || file.visible\n\n    return matchesSearch && matchesVisibility && shouldShow\n  })\n\n  // Handlers\n  const handleToggleFile = (filePath: string) => {\n    toggleFileMutation.mutate({ filePath, bundleName: selectedBundle })\n  }\n\n  const handleBulkToggle = (forceHide: boolean) => {\n    bulkToggleMutation.mutate({\n      filePaths: selectedFiles,\n      bundleName: selectedBundle,\n      forceHide\n    })\n  }\n\n  const handleAddPattern = () => {\n    if (newPattern.trim()) {\n      patternMutation.mutate({ action: 'add', pattern: newPattern.trim() })\n      setNewPattern('')\n    }\n  }\n\n  const handleTogglePattern = (pattern: string, isSystem = false) => {\n    const action = isSystem ? 'toggle-system' : 'remove'\n    patternMutation.mutate({ action, pattern })\n  }\n\n  const allPatterns = [\n    ...(ignorePatterns.system || []).map(p => ({ ...p, source: 'system' as const })),\n    ...(ignorePatterns.user || []).map(p => ({ ...p, source: 'user' as const })),\n    ...(ignorePatterns.file || []).map(p => ({ ...p, source: 'file' as const }))\n  ]\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-lg font-semibold\">File Visibility & Ignore Management</h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Control which files appear in bundles and manage ignore patterns\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n            <Eye className=\"w-3 h-3\" />\n            {filteredFiles.filter(f => f.visible).length} visible\n          </Badge>\n          <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n            <EyeOff className=\"w-3 h-3\" />\n            {filteredFiles.filter(f => !f.visible).length} hidden\n          </Badge>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"files\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"files\">File Visibility</TabsTrigger>\n          <TabsTrigger value=\"patterns\">Ignore Patterns</TabsTrigger>\n          <TabsTrigger value=\"bundles\">Bundle Overview</TabsTrigger>\n        </TabsList>\n\n        {/* File Visibility Tab */}\n        <TabsContent value=\"files\" className=\"space-y-4\">\n          {/* Bundle Selector */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-4 mb-4\">\n                <div className=\"flex items-center gap-2\">\n                  <label className=\"text-sm font-medium\">Bundle:</label>\n                  <select\n                    value={selectedBundle || ''}\n                    onChange={(e) => setSelectedBundle(e.target.value || null)}\n                    className=\"px-3 py-2 border rounded-md text-sm\"\n                  >\n                    <option value=\"\">All Bundles (Global)</option>\n                    {Object.keys(bundleStats).map(bundleName => (\n                      <option key={bundleName} value={bundleName}>{bundleName}</option>\n                    ))}\n                  </select>\n                </div>\n\n                {selectedBundle && (\n                  <Badge variant=\"secondary\">\n                    Bundle-specific visibility for {selectedBundle}\n                  </Badge>\n                )}\n              </div>\n\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      placeholder=\"Search files...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-8\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setShowHidden(!showHidden)}\n                    className={showHidden ? 'bg-blue-50 border-blue-200' : ''}\n                  >\n                    {showHidden ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\n                    {showHidden ? 'Hide Hidden' : 'Show Hidden'}\n                  </Button>\n\n                  <select\n                    value={filterBy}\n                    onChange={(e) => setFilterBy(e.target.value)}\n                    className=\"px-3 py-2 border rounded-md text-sm\"\n                  >\n                    <option value=\"all\">All Files</option>\n                    <option value=\"visible\">Visible Only</option>\n                    <option value=\"hidden\">Hidden Only</option>\n                  </select>\n                </div>\n              </div>\n\n              {/* Bulk Actions */}\n              {selectedFiles.length > 0 && (\n                <div className=\"flex items-center gap-2 p-3 bg-blue-50 rounded-md border border-blue-200 mt-4\">\n                  <Info className=\"w-4 h-4 text-blue-600\" />\n                  <span className=\"text-sm text-blue-800\">\n                    {selectedFiles.length} files selected\n                  </span>\n                  <div className=\"flex gap-2 ml-auto\">\n                    <Button size=\"sm\" onClick={() => handleBulkToggle(false)}>\n                      <Eye className=\"w-4 h-4 mr-1\" />\n                      Show All\n                    </Button>\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => handleBulkToggle(true)}>\n                      <EyeOff className=\"w-4 h-4 mr-1\" />\n                      Hide All\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => setSelectedFiles([])}\n                    >\n                      Cancel\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* File List */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              {filesLoading ? (\n                <div className=\"text-center py-8\">Loading files...</div>\n              ) : (\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {filteredFiles.map((file) => (\n                    <div\n                      key={file.path}\n                      className={`flex items-center gap-3 p-2 rounded-md border transition-colors ${!file.visible ? 'opacity-60 bg-gray-50' : 'hover:bg-gray-50'\n                        }`}\n                    >\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedFiles.includes(file.path)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedFiles([...selectedFiles, file.path])\n                          } else {\n                            setSelectedFiles(selectedFiles.filter(f => f !== file.path))\n                          }\n                        }}\n                        className=\"rounded\"\n                      />\n\n                      <FileText className=\"w-4 h-4 text-muted-foreground flex-shrink-0\" />\n\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"font-mono text-sm truncate\">{file.path}</div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          {file.inBundles.map(bundle => (\n                            <Badge key={bundle} variant=\"outline\" className=\"text-xs\">\n                              {bundle}\n                            </Badge>\n                          ))}\n                          {file.globallyHidden && (\n                            <Badge variant=\"destructive\" className=\"text-xs\">\n                              Globally Hidden\n                            </Badge>\n                          )}\n                          {file.bundleHidden && selectedBundle && (\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              Hidden in {selectedBundle}\n                            </Badge>\n                          )}\n                          {file.matchesIgnorePattern && (\n                            <Badge variant=\"outline\" className=\"text-xs text-gray-500\">\n                              Ignored\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n\n                      <div className=\"text-xs text-muted-foreground\">\n                        {(file.size / 1024).toFixed(1)}kb\n                      </div>\n\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => handleToggleFile(file.path)}\n                        disabled={toggleFileMutation.isPending}\n                        className=\"flex-shrink-0\"\n                      >\n                        {file.visible ? (\n                          <>\n                            <EyeOff className=\"w-4 h-4 mr-1\" />\n                            Hide\n                          </>\n                        ) : (\n                          <>\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Show\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {filteredFiles.length === 0 && !filesLoading && (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  No files match your current filters\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Reset Options */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <RotateCcw className=\"w-4 h-4\" />\n                Reset Options\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => resetMutation.mutate({ scope: 'global' })}\n                  disabled={resetMutation.isPending}\n                >\n                  Reset Global Hidden Files\n                </Button>\n\n                {selectedBundle && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => resetMutation.mutate({ scope: 'bundle', bundleName: selectedBundle })}\n                    disabled={resetMutation.isPending}\n                  >\n                    Reset {selectedBundle} Bundle\n                  </Button>\n                )}\n\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => resetMutation.mutate({ scope: 'all' })}\n                  disabled={resetMutation.isPending}\n                  className=\"text-red-600 border-red-200 hover:bg-red-50\"\n                >\n                  Reset All Hidden Files\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Ignore Patterns Tab */}\n        <TabsContent value=\"patterns\" className=\"space-y-4\">\n          {/* Add New Pattern */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Add Ignore Pattern</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex gap-2\">\n                <Input\n                  placeholder=\"Enter glob pattern (e.g., *.log, src/debug/**)\"\n                  value={newPattern}\n                  onChange={(e) => setNewPattern(e.target.value)}\n                  className=\"flex-1\"\n                  onKeyDown={(e) => e.key === 'Enter' && handleAddPattern()}\n                />\n                <Button\n                  onClick={handleAddPattern}\n                  disabled={!newPattern.trim() || patternMutation.isPending}\n                >\n                  <Plus className=\"w-4 h-4 mr-1\" />\n                  Add Pattern\n                </Button>\n              </div>\n\n              <div className=\"text-sm text-muted-foreground\">\n                Examples: <code>*.log</code>, <code>node_modules/**</code>, <code>src/debug.ts</code>, <code>**/*.test.*</code>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Existing Patterns */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Current Ignore Patterns</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {patternsLoading ? (\n                <div className=\"text-center py-4\">Loading patterns...</div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {allPatterns.map((item, index) => (\n                    <div\n                      key={index}\n                      className={`flex items-center gap-3 p-3 rounded-md border ${!item.active ? 'opacity-60 bg-gray-50' : ''\n                        }`}\n                    >\n                      <div className=\"flex-1\">\n                        <div className=\"font-mono text-sm\">{item.pattern}</div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Badge\n                            variant={item.source === 'system' ? 'secondary' :\n                              item.source === 'user' ? 'default' : 'outline'}\n                            className=\"text-xs\"\n                          >\n                            {item.source === 'system' ? 'System Default' :\n                              item.source === 'user' ? 'User Added' : 'File Pattern'}\n                          </Badge>\n                          {item.active ? (\n                            <Badge variant=\"outline\" className=\"text-xs text-green-700\">\n                              <CheckCircle className=\"w-3 h-3 mr-1\" />\n                              Active\n                            </Badge>\n                          ) : (\n                            <Badge variant=\"outline\" className=\"text-xs text-gray-500\">\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\n                              Disabled\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        {item.source === 'system' ? (\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleTogglePattern(item.pattern, true)}\n                            disabled={patternMutation.isPending}\n                          >\n                            {item.active ? 'Disable' : 'Enable'}\n                          </Button>\n                        ) : (\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleTogglePattern(item.pattern, false)}\n                            disabled={patternMutation.isPending}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Bundle Overview Tab */}\n        <TabsContent value=\"bundles\" className=\"space-y-4\">\n          {statsLoading ? (\n            <div className=\"text-center py-8\">Loading bundle statistics...</div>\n          ) : (\n            <div className=\"grid gap-4\">\n              {Object.entries(bundleStats).map(([bundleName, stats]) => (\n                <Card key={bundleName}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-center\">\n                      <CardTitle>{bundleName}</CardTitle>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant=\"outline\">\n                          {stats.visible} / {stats.total} visible\n                        </Badge>\n                        {stats.hidden > 0 && (\n                          <Badge variant=\"secondary\">\n                            {stats.hidden} hidden\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                          <div\n                            className=\"bg-blue-600 h-2 rounded-full\"\n                            style={{\n                              width: `${stats.total > 0 ? (stats.visible / stats.total) * 100 : 0}%`\n                            }}\n                          />\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => setSelectedBundle(bundleName)}\n                        >\n                          <Settings className=\"w-4 h-4 mr-1\" />\n                          Manage Files\n                        </Button>\n                      </div>\n\n                      <div className=\"text-sm text-muted-foreground\">\n                        <div>Patterns: {stats.patterns.join(', ')}</div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/SetupComponents.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"11375\" modified=\"2025-06-07T04:10:05.940Z\" />\n      <cntx:content><![CDATA[// Updated SetupComponents.tsx with clearer CLI vs UI guidance\n\nimport { useQuery } from '@tanstack/react-query'\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card'\nimport { Button } from './ui/button'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { CheckCircle, AlertTriangle, Settings, Play, Terminal, FileText, Monitor, Command } from 'lucide-react'\n\ninterface SetupStatus {\n  hasConfig: boolean\n  hasIgnoreFile: boolean\n  bundleCount: number\n  hasCursorRules: boolean\n  isFirstTime: boolean\n}\n\nconst fetchSetupStatus = async (): Promise<SetupStatus> => {\n  try {\n    const [configResponse, bundlesResponse, cursorResponse] = await Promise.all([\n      fetch('http://localhost:3333/api/config'),\n      fetch('http://localhost:3333/api/bundles'),\n      fetch('http://localhost:3333/api/cursor-rules')\n    ])\n\n    const hasConfig = configResponse.ok\n    const bundles = bundlesResponse.ok ? await bundlesResponse.json() : []\n    const hasCursorRules = cursorResponse.ok\n\n    return {\n      hasConfig,\n      hasIgnoreFile: true, // We can assume this exists if config exists\n      bundleCount: bundles.length || 0,\n      hasCursorRules,\n      isFirstTime: !hasConfig || bundles.length === 0\n    }\n  } catch (error) {\n    return {\n      hasConfig: false,\n      hasIgnoreFile: false,\n      bundleCount: 0,\n      hasCursorRules: false,\n      isFirstTime: true\n    }\n  }\n}\n\ninterface SetupBannerProps {\n  onStartSetup: () => void\n}\n\nexport function SetupBanner({ onStartSetup }: SetupBannerProps) {\n  const { data: status, isLoading } = useQuery({\n    queryKey: ['setup-status'],\n    queryFn: fetchSetupStatus,\n    refetchInterval: 5000,\n  })\n\n  if (isLoading || !status?.isFirstTime) {\n    return null\n  }\n\n  return (\n    <Alert className=\"mb-6 border-blue-200 bg-blue-50\">\n      <Settings className=\"w-4 h-4\" />\n      <AlertDescription className=\"flex items-center justify-between\">\n        <div>\n          <strong>Welcome to cntx-ui!</strong> This looks like your first time.\n          The web interface is already running - let's help you get set up properly.\n        </div>\n        <Button onClick={onStartSetup} size=\"sm\">\n          Start Setup Guide\n        </Button>\n      </AlertDescription>\n    </Alert>\n  )\n}\n\ninterface SetupChecklistProps {\n  onOpenFullSetup: () => void\n}\n\nexport function SetupChecklist({ onOpenFullSetup }: SetupChecklistProps) {\n  const { data: status, isLoading } = useQuery({\n    queryKey: ['setup-status'],\n    queryFn: fetchSetupStatus,\n    refetchInterval: 10000,\n  })\n\n  if (isLoading) {\n    return <div>Checking setup status...</div>\n  }\n\n  const checks = [\n    {\n      label: 'Configuration file exists',\n      passed: status?.hasConfig || false,\n      description: '.cntx/config.json with bundle definitions'\n    },\n    {\n      label: 'Ignore patterns configured',\n      passed: status?.hasIgnoreFile || false,\n      description: '.cntxignore file to exclude unnecessary files'\n    },\n    {\n      label: 'Bundles generated',\n      passed: (status?.bundleCount || 0) > 0,\n      description: `${status?.bundleCount || 0} bundles currently configured`\n    },\n    {\n      label: 'Cursor rules created',\n      passed: status?.hasCursorRules || false,\n      description: '.cursorrules file for AI assistant context'\n    }\n  ]\n\n  const allPassed = checks.every(check => check.passed)\n\n  return (\n    <Card className={!allPassed ? 'border-yellow-200' : ''}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Settings className=\"w-5 h-5\" />\n          Setup Status\n          {allPassed ? (\n            <CheckCircle className=\"w-5 h-5 text-green-500\" />\n          ) : (\n            <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\n          )}\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          {checks.map((check, index) => (\n            <div key={index} className=\"flex items-start gap-3\">\n              <div className=\"flex-shrink-0 mt-0.5\">\n                {check.passed ? (\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                ) : (\n                  <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />\n                )}\n              </div>\n              <div className=\"flex-1\">\n                <div className={`font-medium ${check.passed ? 'text-green-700' : 'text-yellow-700'}`}>\n                  {check.label}\n                </div>\n                <div className=\"text-sm text-gray-600\">{check.description}</div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {!allPassed && (\n          <div className=\"mt-4 pt-4 border-t\">\n            <Button onClick={onOpenFullSetup} variant=\"outline\" className=\"w-full\">\n              <Play className=\"w-4 h-4 mr-2\" />\n              Complete Setup Guide\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\n// CLI vs UI guidance component\nexport function UsageGuidance() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Monitor className=\"w-5 h-5\" />\n          How to Use cntx-ui\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <Alert className=\"border-blue-200 bg-blue-50\">\n          <Terminal className=\"w-4 h-4\" />\n          <AlertDescription>\n            <strong>You're already running!</strong> The web interface provides full functionality.\n            CLI commands are available for automation and advanced workflows.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n              <Monitor className=\"w-4 h-4\" />\n              Web Interface (Recommended)\n            </h4>\n            <div className=\"text-sm text-gray-600 space-y-2\">\n              <p>Perfect for interactive use and project management:</p>\n              <div className=\"ml-4 space-y-1\">\n                <div>• <strong>Bundle Management:</strong> View, create, and manage bundles</div>\n                <div>• <strong>Configuration:</strong> Edit bundle patterns visually</div>\n                <div>• <strong>Hidden Files:</strong> Control file visibility per bundle</div>\n                <div>• <strong>Cursor Rules:</strong> Manage AI assistant context</div>\n                <div>• <strong>Real-time Updates:</strong> See changes immediately</div>\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n              <Command className=\"w-4 h-4\" />\n              Command Line Interface\n            </h4>\n            <div className=\"text-sm text-gray-600 space-y-2\">\n              <p>Great for automation, scripts, and CI/CD:</p>\n              <div className=\"ml-4 space-y-1\">\n                <div>• <strong>Quick bundle generation:</strong> <code className=\"bg-gray-100 px-1 rounded\">cntx-ui bundle master</code></div>\n                <div>• <strong>Status checking:</strong> <code className=\"bg-gray-100 px-1 rounded\">cntx-ui status</code></div>\n                <div>• <strong>Scripting workflows:</strong> Integrate with build processes</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Quick CLI reference for advanced users\nexport function QuickCliReference() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Terminal className=\"w-5 h-5\" />\n          CLI Reference\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3 text-sm font-mono\">\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui watch</code>\n            <span className=\"text-gray-600 text-xs\">Start server (already running)</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui status</code>\n            <span className=\"text-gray-600 text-xs\">Check configuration status</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <code className=\"bg-gray-100 px-2 py-1 rounded text-xs\">cntx-ui bundle [name]</code>\n            <span className=\"text-gray-600 text-xs\">Generate specific bundle</span>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Workflow instructions component\nexport function WorkflowInstructions() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <FileText className=\"w-5 h-5\" />\n          Common Workflows\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div>\n          <h4 className=\"font-medium mb-2\">🎯 For AI Development</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Create focused bundles (api, ui, core)</div>\n            <div>2. Hide debug/temp files from bundles</div>\n            <div>3. Copy bundle XML for AI context</div>\n            <div>4. Use Cursor Rules for project context</div>\n          </div>\n        </div>\n\n        <div>\n          <h4 className=\"font-medium mb-2\">📁 For Project Organization</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Configure ignore patterns for unwanted files</div>\n            <div>2. Create bundles by feature or responsibility</div>\n            <div>3. Use hidden files to trim bundle scope</div>\n            <div>4. Monitor bundle sizes and file counts</div>\n          </div>\n        </div>\n\n        <div>\n          <h4 className=\"font-medium mb-2\">🤖 For CI/CD Integration</h4>\n          <div className=\"text-sm text-gray-600 space-y-1\">\n            <div>1. Use CLI commands in build scripts</div>\n            <div>2. Generate bundles for automated testing</div>\n            <div>3. Export project context for deployment</div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Installation reminder for new users\nexport function InstallationReminder() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>First Time Setup</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <Alert className=\"border-green-200 bg-green-50\">\n          <CheckCircle className=\"w-4 h-4\" />\n          <AlertDescription>\n            <strong>You're all set!</strong> cntx-ui is installed and running.\n            Use this web interface for full functionality.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"text-sm text-gray-600\">\n          <p className=\"mb-2\"><strong>For new projects:</strong></p>\n          <div className=\"ml-4 space-y-1\">\n            <div>1. Install: <code className=\"bg-gray-100 px-1 rounded\">npm install -g cntx-ui</code></div>\n            <div>2. Initialize: <code className=\"bg-gray-100 px-1 rounded\">cntx-ui init</code></div>\n            <div>3. Start: <code className=\"bg-gray-100 px-1 rounded\">cntx-ui watch</code></div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Legacy components for backward compatibility\nexport const QuickSetupTips = QuickCliReference\nexport const UsageInstructions = WorkflowInstructions\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/SetupScreen.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"31165\" modified=\"2025-06-07T04:53:40.702Z\" />\n      <cntx:content><![CDATA[import { useState } from 'react'\nimport { CheckCircle, Circle, Copy, Monitor, FolderOpen, Settings, ArrowRight, ExternalLink, AlertTriangle, Play, Sparkles, Eye, FileText, Zap, Download } from 'lucide-react'\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\n\ninterface SetupStep {\n  id: string\n  title: string\n  description: string\n  completed: boolean\n  required: boolean\n}\n\nexport default function SetupScreen() {\n  const [currentStep, setCurrentStep] = useState(0)\n  const [setupSteps, setSetupSteps] = useState<SetupStep[]>([\n    {\n      id: 'welcome',\n      title: 'Welcome to cntx-ui',\n      description: 'Learn what you can do with the web interface',\n      completed: false,\n      required: true\n    },\n    {\n      id: 'ai-analysis',\n      title: 'AI Bundle Analysis',\n      description: 'Let AI analyze your code and suggest optimal bundles',\n      completed: false,\n      required: false\n    },\n    {\n      id: 'bundles',\n      title: 'Create & Manage Bundles',\n      description: 'Set up focused file collections for AI development',\n      completed: false,\n      required: true\n    },\n    {\n      id: 'optimization',\n      title: 'Fine-tune & Optimize',\n      description: 'Configure file visibility and AI assistant context',\n      completed: false,\n      required: false\n    },\n    {\n      id: 'workflows',\n      title: 'Explore Workflows',\n      description: 'Learn common patterns and best practices',\n      completed: false,\n      required: false\n    }\n  ])\n\n  const [aiPromptCopied, setAiPromptCopied] = useState(false)\n  const [masterBundleCopied, setMasterBundleCopied] = useState(false)\n\n  const copyAiPrompt = async () => {\n    const prompt = `Analyze this codebase bundle and suggest an optimal bundle configuration for cntx-ui.\n\nBased on the file structure and content, recommend 3-6 meaningful bundles with glob patterns that group related files logically.\n\nConsider these common bundle types:\n- Frontend/UI components and pages\n- Backend API routes and controllers  \n- Configuration files\n- Documentation\n- Tests\n- Utilities/helpers\n- Styles/assets\n\nReturn ONLY a JSON configuration in this exact format:\n{\n  \"bundles\": {\n    \"master\": [\"**/*\"],\n    \"frontend\": [\"src/components/**/*\", \"src/pages/**/*\", \"src/hooks/**/*\"],\n    \"api\": [\"src/api/**/*\", \"routes/**/*\", \"controllers/**/*\"],\n    \"config\": [\"*.config.*\", \"package.json\", \"tsconfig.json\"],\n    \"docs\": [\"README.md\", \"docs/**/*\", \"*.md\"],\n    \"tests\": [\"**/*.test.*\", \"**/*.spec.*\", \"__tests__/**/*\"]\n  }\n}\n\nPlease analyze the following master bundle and suggest appropriate bundles:\n\n[PASTE YOUR MASTER BUNDLE XML CONTENT HERE]`\n\n    try {\n      await navigator.clipboard.writeText(prompt)\n      setAiPromptCopied(true)\n      setTimeout(() => setAiPromptCopied(false), 3000)\n    } catch (err) {\n      console.error('Failed to copy AI prompt:', err)\n    }\n  }\n\n  const copyMasterBundle = async () => {\n    try {\n      const response = await fetch('http://localhost:3333/api/bundles/master')\n      if (!response.ok) throw new Error('Failed to fetch master bundle')\n\n      const xmlContent = await response.text()\n      await navigator.clipboard.writeText(xmlContent)\n      setMasterBundleCopied(true)\n      setTimeout(() => setMasterBundleCopied(false), 3000)\n    } catch (err) {\n      console.error('Failed to copy master bundle:', err)\n    }\n  }\n\n  const downloadMasterBundle = async () => {\n    try {\n      const response = await fetch('http://localhost:3333/api/bundles/master')\n      if (!response.ok) throw new Error('Failed to fetch master bundle')\n\n      const xmlContent = await response.text()\n      const blob = new Blob([xmlContent], { type: 'application/xml' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = 'master-bundle.xml'\n      a.click()\n      URL.revokeObjectURL(url)\n    } catch (err) {\n      console.error('Failed to download master bundle:', err)\n    }\n  }\n\n\n  const markStepComplete = (stepId: string) => {\n    setSetupSteps(prev => prev.map(step =>\n      step.id === stepId ? { ...step, completed: true } : step\n    ))\n  }\n\n  const StepIndicator = ({ step, isActive }: { step: SetupStep, isActive: boolean }) => (\n    <div className={`flex items-center gap-3 p-3 rounded-lg transition-colors ${isActive ? 'bg-blue-50 border border-blue-200' : 'hover:bg-gray-50'\n      }`}>\n      <div className=\"flex-shrink-0\">\n        {step.completed ? (\n          <CheckCircle className=\"w-6 h-6 text-green-500\" />\n        ) : (\n          <Circle className={`w-6 h-6 ${isActive ? 'text-blue-500' : 'text-gray-300'}`} />\n        )}\n      </div>\n      <div className=\"flex-1\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className={`font-medium ${isActive ? 'text-blue-900' : 'text-gray-900'}`}>\n            {step.title}\n          </h3>\n          {step.required && (\n            <Badge variant=\"outline\" className=\"text-xs\">Required</Badge>\n          )}\n        </div>\n        <p className=\"text-sm text-gray-600\">{step.description}</p>\n      </div>\n    </div>\n  )\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-2\">Welcome to cntx-ui</h1>\n          <p className=\"text-lg text-gray-600 max-w-2xl mx-auto\">\n            You're already up and running! Let's explore what you can do with the web interface.\n          </p>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-8 max-w-7xl mx-auto\">\n          {/* Steps Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Settings className=\"w-5 h-5\" />\n                  Quick Tour\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                {setupSteps.map((step, index) => (\n                  <div\n                    key={step.id}\n                    onClick={() => setCurrentStep(index)}\n                    className=\"cursor-pointer\"\n                  >\n                    <StepIndicator step={step} isActive={currentStep === index} />\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Step 1: Welcome */}\n            {currentStep === 0 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5\" />\n                    Welcome! You're Already Running\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <Alert className=\"border-green-200 bg-green-50\">\n                    <CheckCircle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Great news!</strong> cntx-ui is installed and the web interface is running.\n                      No command line setup needed - you can do everything from this interface.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <Card className=\"border-blue-200\">\n                      <CardContent className=\"pt-6\">\n                        <Monitor className=\"w-8 h-8 text-blue-600 mb-3\" />\n                        <h3 className=\"font-medium mb-2\">Web Interface</h3>\n                        <p className=\"text-sm text-gray-600\">\n                          Full-featured interface for managing bundles, files, and AI context. Perfect for interactive use.\n                        </p>\n                      </CardContent>\n                    </Card>\n\n                    <Card className=\"border-gray-200\">\n                      <CardContent className=\"pt-6\">\n                        <FileText className=\"w-8 h-8 text-gray-600 mb-3\" />\n                        <h3 className=\"font-medium mb-2\">Command Line</h3>\n                        <p className=\"text-sm text-gray-600\">\n                          Available for automation, scripts, and CI/CD workflows. Optional for advanced users.\n                        </p>\n                      </CardContent>\n                    </Card>\n                  </div>\n\n                  <div className=\"bg-blue-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-blue-900 mb-2\">What is cntx-ui?</h4>\n                    <p className=\"text-sm text-blue-800 mb-3\">\n                      cntx-ui helps you organize your codebase for AI development by creating focused file bundles.\n                      Think of it as intelligent project packaging for AI assistants like Claude, ChatGPT, or Cursor.\n                    </p>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm text-blue-800\">\n                      <div>• Bundle files by purpose or feature</div>\n                      <div>• Hide irrelevant files from AI context</div>\n                      <div>• Generate XML packages for AI tools</div>\n                      <div>• Manage project context efficiently</div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" disabled>Previous</Button>\n                    <Button onClick={() => { markStepComplete('welcome'); setCurrentStep(1); }}>\n                      Let's Start <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 2: AI Bundle Analysis */}\n            {currentStep === 1 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5\" />\n                    Let AI Analyze Your Code & Suggest Bundles\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Let AI examine your entire codebase and intelligently suggest\n                      the perfect bundle configuration based on your project structure.\n                    </p>\n\n                    <Alert className=\"border-purple-200 bg-purple-50\">\n                      <Sparkles className=\"w-4 h-4\" />\n                      <AlertDescription>\n                        <strong>🎯 AI-Powered Bundle Design:</strong> Instead of guessing what bundles to create,\n                        let AI analyze your code structure and suggest optimal groupings.\n                      </AlertDescription>\n                    </Alert>\n                  </div>\n\n                  <div className=\"bg-blue-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-blue-900 mb-3\">Here's the workflow:</h4>\n                    <ol className=\"text-sm text-blue-800 space-y-2 list-decimal list-inside\">\n                      <li><strong>Copy the AI analysis prompt</strong> (button below)</li>\n                      <li><strong>Go to Bundles tab</strong> → Copy the \"master\" bundle XML</li>\n                      <li><strong>Open Claude/ChatGPT</strong> → Paste the prompt</li>\n                      <li><strong>Paste your master bundle XML</strong> after the prompt</li>\n                      <li><strong>AI returns perfect bundle JSON</strong> tailored to your code!</li>\n                      <li><strong>Go to Config tab</strong> → Paste the JSON → Apply!</li>\n                    </ol>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Step 1: Copy AI Prompt & Master Bundle</h4>\n                    <div className=\"space-y-3\">\n                      <div className=\"bg-slate-900 rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <span className=\"text-green-400 text-sm\">🤖 Smart Bundle Analysis Prompt</span>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={copyAiPrompt}\n                            className=\"text-gray-400 hover:text-white\"\n                          >\n                            {aiPromptCopied ? (\n                              <>\n                                <CheckCircle className=\"w-4 h-4 mr-1\" />\n                                Copied!\n                              </>\n                            ) : (\n                              <>\n                                <Copy className=\"w-4 h-4 mr-1\" />\n                                Copy Prompt\n                              </>\n                            )}\n                          </Button>\n                        </div>\n                        <div className=\"text-gray-300 text-sm\">\n                          Intelligent prompt that guides AI to analyze your code structure\n                        </div>\n                      </div>\n\n                      <div className=\"bg-slate-900 rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <span className=\"text-blue-400 text-sm\">📦 Master Bundle XML</span>\n                          <div className=\"flex gap-2\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={copyMasterBundle}\n                              className=\"text-gray-400 hover:text-white\"\n                            >\n                              {masterBundleCopied ? (\n                                <>\n                                  <CheckCircle className=\"w-4 h-4 mr-1\" />\n                                  Copied!\n                                </>\n                              ) : (\n                                <>\n                                  <Copy className=\"w-4 h-4 mr-1\" />\n                                  Copy XML\n                                </>\n                              )}\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={downloadMasterBundle}\n                              className=\"text-gray-400 hover:text-white\"\n                            >\n                              <Download className=\"w-4 h-4 mr-1\" />\n                              Download\n                            </Button>\n                          </div>\n                        </div>\n                        <div className=\"text-gray-300 text-sm\">\n                          Your complete codebase bundle for AI analysis\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\n                    <h4 className=\"font-medium text-purple-900 mb-2\">🚀 Complete AI Workflow:</h4>\n                    <ol className=\"text-sm text-purple-800 space-y-1 list-decimal list-inside\">\n                      <li><strong>Copy the prompt above</strong> → Paste into Claude/ChatGPT</li>\n                      <li><strong>Copy/download master bundle</strong> → Add to your AI conversation</li>\n                      <li><strong>AI analyzes your code</strong> → Returns perfect bundle configuration</li>\n                      <li><strong>Go to Config tab</strong> → Paste AI's JSON → Apply configuration</li>\n                      <li><strong>🎉 Optimized bundles ready!</strong> → Tailored to your project structure</li>\n                    </ol>\n                  </div>\n\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium\">What AI Analyzes:</h4>\n                      <div className=\"text-sm space-y-1\">\n                        <div>🗂️ <strong>File organization patterns</strong></div>\n                        <div>🔗 <strong>Import/dependency relationships</strong></div>\n                        <div>⚙️ <strong>Technology stack detection</strong></div>\n                        <div>📁 <strong>Logical grouping opportunities</strong></div>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium\">AI Suggests Bundles Like:</h4>\n                      <div className=\"text-sm space-y-1\">\n                        <div>🎨 <strong>frontend</strong> - Components, pages, styles</div>\n                        <div>🔌 <strong>api</strong> - Routes, controllers, models</div>\n                        <div>🧪 <strong>tests</strong> - All test files</div>\n                        <div>⚙️ <strong>config</strong> - Configuration files</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <Alert>\n                    <AlertTriangle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Why this works so well:</strong> AI understands code patterns and can see relationships\n                      between files that aren't obvious. It creates bundles that actually make sense for your specific project.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(0)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('ai-analysis'); setCurrentStep(2); }}>\n                      Continue to Bundle Management <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 3: Create/Manage Bundles */}\n            {currentStep === 2 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <FolderOpen className=\"w-5 h-5\" />\n                    Create & Manage Your Bundles\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Whether you used AI suggestions or want to create bundles manually,\n                      here's how to manage your bundle collection.\n                    </p>\n\n                    <div className=\"bg-green-50 p-4 rounded-lg mb-4\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">If you used AI analysis:</h4>\n                      <ol className=\"text-sm text-green-800 space-y-1 list-decimal list-inside\">\n                        <li>Go to the <strong>Config</strong> tab above</li>\n                        <li>Scroll to <strong>\"Paste Bundle Configuration\"</strong></li>\n                        <li>Paste the AI-generated JSON</li>\n                        <li>Click <strong>\"Apply Configuration\"</strong></li>\n                        <li>🎉 Your optimized bundles are ready!</li>\n                      </ol>\n                    </div>\n\n                    <div className=\"bg-blue-50 p-4 rounded-lg mb-4\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">To create bundles manually:</h4>\n                      <ol className=\"text-sm text-blue-800 space-y-1 list-decimal list-inside\">\n                        <li>Go to the <strong>Config</strong> tab above</li>\n                        <li>Click <strong>\"Add New Bundle\"</strong> at the bottom</li>\n                        <li>Name it something meaningful (e.g., \"frontend\", \"api\", \"core\")</li>\n                        <li>Add patterns like <code className=\"bg-blue-100 px-1 rounded\">src/components/**/*</code></li>\n                        <li>Click <strong>\"Create Bundle\"</strong></li>\n                      </ol>\n                    </div>\n\n                    <Alert>\n                      <Sparkles className=\"w-4 h-4\" />\n                      <AlertDescription>\n                        <strong>Pro tip:</strong> You can test patterns before adding them!\n                        Use the \"Pattern Tester\" in the Config tab to see which files match.\n                      </AlertDescription>\n                    </Alert>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <h4 className=\"font-medium\">Popular Manual Bundle Examples:</h4>\n                    <div className=\"grid gap-3\">\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">Frontend Bundle</div>\n                        <code className=\"text-xs text-gray-600\">src/components/**/* • src/pages/**/* • *.css</code>\n                      </div>\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">API Bundle</div>\n                        <code className=\"text-xs text-gray-600\">src/api/**/* • src/routes/**/* • src/models/**/*</code>\n                      </div>\n                      <div className=\"bg-gray-50 p-3 rounded-md\">\n                        <div className=\"font-medium text-sm\">Tests Bundle</div>\n                        <code className=\"text-xs text-gray-600\">**/*.test.* • **/*.spec.* • __tests__/**/*</code>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(1)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('bundles'); setCurrentStep(3); }}>\n                      Continue to Optimization <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 4: Optimization */}\n            {currentStep === 3 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Zap className=\"w-5 h-5\" />\n                    Optimize for AI Development\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <p className=\"text-gray-600 mb-4\">\n                      Now let's make your bundles perfect for AI assistants by controlling what they see.\n                    </p>\n\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      <Card className=\"border-purple-200\">\n                        <CardContent className=\"pt-6\">\n                          <Eye className=\"w-8 h-8 text-purple-600 mb-3\" />\n                          <h3 className=\"font-medium mb-2\">Hidden Files Tab</h3>\n                          <div className=\"text-sm text-gray-600 space-y-1\">\n                            <div>• Hide debug files from AI context</div>\n                            <div>• Remove temp/generated files</div>\n                            <div>• Create clean, focused bundles</div>\n                          </div>\n                        </CardContent>\n                      </Card>\n\n                      <Card className=\"border-green-200\">\n                        <CardContent className=\"pt-6\">\n                          <Sparkles className=\"w-8 h-8 text-green-600 mb-3\" />\n                          <h3 className=\"font-medium mb-2\">Cursor Rules Tab</h3>\n                          <div className=\"text-sm text-gray-600 space-y-1\">\n                            <div>• Set coding standards</div>\n                            <div>• Define project context</div>\n                            <div>• Guide AI assistant behavior</div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-green-50 p-4 rounded-lg\">\n                    <h4 className=\"font-medium text-green-900 mb-2\">Try this workflow:</h4>\n                    <ol className=\"text-sm text-green-800 space-y-1 list-decimal list-inside\">\n                      <li>Go to <strong>Hidden Files</strong> tab</li>\n                      <li>Search for \"debug\" or \"test\" files</li>\n                      <li>Hide them from your main bundles</li>\n                      <li>Go to <strong>Cursor Rules</strong> tab</li>\n                      <li>Choose a template that matches your project</li>\n                      <li>Customize the rules for your team's preferences</li>\n                    </ol>\n                  </div>\n\n                  <Alert>\n                    <AlertTriangle className=\"w-4 h-4\" />\n                    <AlertDescription>\n                      <strong>Why this matters:</strong> Clean bundles = better AI responses.\n                      Removing noise helps AI focus on what's actually important in your code.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(2)}>Previous</Button>\n                    <Button onClick={() => { markStepComplete('optimization'); setCurrentStep(4); }}>\n                      Continue <ArrowRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Step 5: Workflows */}\n            {currentStep === 4 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Play className=\"w-5 h-5\" />\n                    Common Workflows & Next Steps\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"grid gap-4\">\n                    <div className=\"bg-blue-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">🤖 Using with AI Assistants</h4>\n                      <div className=\"text-sm text-blue-800 space-y-1\">\n                        <div>1. Create a focused bundle for your current task</div>\n                        <div>2. Copy the XML from the <strong>Bundles</strong> tab</div>\n                        <div>3. Paste into Claude, ChatGPT, or other AI tools</div>\n                        <div>4. Get more accurate, context-aware responses</div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-purple-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-purple-900 mb-2\">📁 Organizing Large Projects</h4>\n                      <div className=\"text-sm text-purple-800 space-y-1\">\n                        <div>1. Create bundles by feature or team responsibility</div>\n                        <div>2. Use hidden files to exclude work-in-progress code</div>\n                        <div>3. Monitor bundle sizes in the web interface</div>\n                        <div>4. Share specific bundles with team members</div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-green-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">⚡ Advanced Tips</h4>\n                      <div className=\"text-sm text-green-800 space-y-1\">\n                        <div>• Bundle-specific hiding: Hide files from specific bundles only</div>\n                        <div>• Pattern testing: Use the pattern tester in Config tab</div>\n                        <div>• Real-time updates: Changes appear immediately</div>\n                        <div>• CLI integration: Use commands for automation</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\n                    <h4 className=\"font-medium text-yellow-900 mb-2\">🎯 Quick Start Checklist</h4>\n                    <div className=\"text-sm text-yellow-800 space-y-1\">\n                      <div>✅ Create 2-3 focused bundles</div>\n                      <div>✅ Hide debug/temp files</div>\n                      <div>✅ Set up cursor rules</div>\n                      <div>✅ Copy a bundle and try it with an AI assistant</div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between\">\n                    <Button variant=\"outline\" onClick={() => setCurrentStep(3)}>Previous</Button>\n                    <Button onClick={() => markStepComplete('workflows')} className=\"bg-green-600 hover:bg-green-700\">\n                      Get Started! <ExternalLink className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Quick Reference Card */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Quick Reference</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid md:grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Web Interface Tabs</h4>\n                    <ul className=\"space-y-1 text-gray-600\">\n                      <li><strong>Bundles</strong> - View and copy bundle content</li>\n                      <li><strong>Files</strong> - Browse your project files</li>\n                      <li><strong>Config</strong> - Create and edit bundles</li>\n                      <li><strong>Hidden</strong> - Control file visibility</li>\n                      <li><strong>Cursor</strong> - Manage AI assistant rules</li>\n                    </ul>\n                  </div>\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Key Features</h4>\n                    <ul className=\"space-y-1 text-gray-600\">\n                      <li>Real-time file watching and updates</li>\n                      <li>Bundle-specific file hiding</li>\n                      <li>Pattern testing and validation</li>\n                      <li>AI assistant context management</li>\n                      <li>XML export for AI tools</li>\n                    </ul>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/alert.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1614\" modified=\"2025-06-06T23:18:00.618Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/badge.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1631\" modified=\"2025-06-06T23:02:18.357Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/button.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"2123\" modified=\"2025-06-06T23:02:18.326Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/card.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1989\" modified=\"2025-06-06T22:59:58.927Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/input.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"967\" modified=\"2025-06-06T23:18:00.535Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/label.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"597\" modified=\"2025-06-06T23:18:00.593Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/sonner.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"555\" modified=\"2025-06-07T02:10:25.582Z\" />\n      <cntx:content><![CDATA[import { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, type ToasterProps } from \"sonner\"\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      style={\n        {\n          \"--normal-bg\": \"var(--popover)\",\n          \"--normal-text\": \"var(--popover-foreground)\",\n          \"--normal-border\": \"var(--border)\",\n        } as React.CSSProperties\n      }\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/tabs.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1955\" modified=\"2025-06-06T22:59:58.902Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/textarea.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"759\" modified=\"2025-06-06T23:18:00.602Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/hooks/useButtonFeedback.ts\" ext=\".ts\">\n      <cntx:meta size=\"1123\" modified=\"2025-06-07T01:43:23.151Z\" />\n      <cntx:content><![CDATA[// hooks/useButtonFeedback.ts\nimport { useState } from 'react'\n\nexport type ButtonState = 'idle' | 'loading' | 'success' | 'error'\n\nexport function useButtonFeedback() {\n  const [buttonStates, setButtonStates] = useState<Record<string, ButtonState>>(\n    {}\n  )\n\n  const setButtonState = (key: string, state: ButtonState) => {\n    setButtonStates((prev) => ({ ...prev, [key]: state }))\n\n    // Auto-clear success/error states\n    if (state === 'success') {\n      setTimeout(() => {\n        setButtonStates((prev) => ({ ...prev, [key]: 'idle' }))\n      }, 2000)\n    } else if (state === 'error') {\n      setTimeout(() => {\n        setButtonStates((prev) => ({ ...prev, [key]: 'idle' }))\n      }, 3000)\n    }\n  }\n\n  const getButtonState = (key: string): ButtonState => {\n    return buttonStates[key] || 'idle'\n  }\n\n  const isLoading = (key: string) => getButtonState(key) === 'loading'\n  const isSuccess = (key: string) => getButtonState(key) === 'success'\n  const isError = (key: string) => getButtonState(key) === 'error'\n\n  return {\n    setButtonState,\n    getButtonState,\n    isLoading,\n    isSuccess,\n    isError,\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/lib/utils.ts\" ext=\".ts\">\n      <cntx:meta size=\"166\" modified=\"2025-06-06T22:59:49.030Z\" />\n      <cntx:content><![CDATA[import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/utils/buttonHelpers.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"883\" modified=\"2025-06-07T02:10:05.487Z\" />\n      <cntx:content><![CDATA[// utils/buttonHelpers.tsx\nimport { Loader2, CheckCircle, AlertCircle } from 'lucide-react'\nimport type { ButtonState } from '../hooks/useButtonFeedback'\n\nexport function getButtonIcon(state: ButtonState, defaultIcon: React.ReactNode) {\n  switch (state) {\n    case 'loading':\n      return <Loader2 className=\"w-4 h-4 animate-spin\" />\n    case 'success':\n      return <CheckCircle className=\"w-4 h-4 text-green-600\" />\n    case 'error':\n      return <AlertCircle className=\"w-4 h-4 text-red-600\" />\n    default:\n      return defaultIcon\n  }\n}\n\nexport function getButtonClassName(state: ButtonState, baseClassName = '') {\n  const stateClasses = {\n    loading: 'opacity-75',\n    success: 'border-green-500 bg-green-50 text-green-700',\n    error: 'border-red-500 bg-red-50 text-red-700',\n    idle: ''\n  }\n\n  return `transition-all duration-200 ${baseClassName} ${stateClasses[state]}`\n}\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.694Z",
    "size": 147005
  },
  "ui-components": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"ui-components\" generated=\"2025-06-18T12:10:52.697Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"9\">\n    <cntx:file path=\"web/src/components/ui/alert.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1614\" modified=\"2025-06-06T23:18:00.618Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/badge.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1631\" modified=\"2025-06-06T23:02:18.357Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/button.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"2123\" modified=\"2025-06-06T23:02:18.326Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/card.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1989\" modified=\"2025-06-06T22:59:58.927Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/input.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"967\" modified=\"2025-06-06T23:18:00.535Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/label.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"597\" modified=\"2025-06-06T23:18:00.593Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/sonner.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"555\" modified=\"2025-06-07T02:10:25.582Z\" />\n      <cntx:content><![CDATA[import { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, type ToasterProps } from \"sonner\"\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      style={\n        {\n          \"--normal-bg\": \"var(--popover)\",\n          \"--normal-text\": \"var(--popover-foreground)\",\n          \"--normal-border\": \"var(--border)\",\n        } as React.CSSProperties\n      }\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/tabs.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"1955\" modified=\"2025-06-06T22:59:58.902Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/src/components/ui/textarea.tsx\" ext=\".tsx\">\n      <cntx:meta size=\"759\" modified=\"2025-06-06T23:18:00.602Z\" />\n      <cntx:content><![CDATA[import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.698Z",
    "size": 14391
  },
  "config": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"config\" generated=\"2025-06-18T12:10:52.704Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"8\">\n    <cntx:file path=\"package.json\" ext=\".json\">\n      <cntx:meta size=\"1018\" modified=\"2025-06-18T12:09:54.744Z\" />\n      <cntx:content><![CDATA[{\n  \"name\": \"cntx-ui\",\n  \"type\": \"module\",\n  \"version\": \"2.0.3\",\n  \"description\": \"Minimal file bundling and tagging tool for AI development\",\n  \"keywords\": [\n    \"ai\",\n    \"bundling\",\n    \"file-management\",\n    \"development-tools\",\n    \"codebase\"\n  ],\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/nothingdao/cntx-ui.git\"\n  },\n  \"author\": \"whaleen\",\n  \"license\": \"MIT\",\n  \"bin\": {\n    \"cntx-ui\": \"./bin/cntx-ui.js\"\n  },\n  \"files\": [\n    \"bin/cntx-ui.js\",\n    \"server.js\",\n    \"lib/\",\n    \"README.md\",\n    \"web/dist\",\n    \"mcp-config-example.json\"\n  ],\n  \"engines\": {\n    \"node\": \">=18.0.0\"\n  },\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"cd web && npm install && npm run build\",\n    \"build:web\": \"cd web && npm install && npm run build\",\n    \"dev:web\": \"cd web && npm run dev\",\n    \"prebuild\": \"npm run build:web\",\n    \"prepublishOnly\": \"npm run build:web\",\n    \"test:local\": \"npm pack && npm install -g ./cntx-ui-2.0.0.tgz\"\n  },\n  \"dependencies\": {\n    \"ws\": \"^8.13.0\"\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/components.json\" ext=\".json\">\n      <cntx:meta size=\"423\" modified=\"2025-06-06T22:59:43.333Z\" />\n      <cntx:content><![CDATA[{\n  \"$schema\": \"https://ui.shadcn.com/schema.json\",\n  \"style\": \"new-york\",\n  \"rsc\": false,\n  \"tsx\": true,\n  \"tailwind\": {\n    \"config\": \"\",\n    \"css\": \"src/index.css\",\n    \"baseColor\": \"slate\",\n    \"cssVariables\": true,\n    \"prefix\": \"\"\n  },\n  \"aliases\": {\n    \"components\": \"@/components\",\n    \"utils\": \"@/lib/utils\",\n    \"ui\": \"@/components/ui\",\n    \"lib\": \"@/lib\",\n    \"hooks\": \"@/hooks\"\n  },\n  \"iconLibrary\": \"lucide\"\n}]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/eslint.config.js\" ext=\".js\">\n      <cntx:meta size=\"734\" modified=\"2025-06-06T22:55:53.330Z\" />\n      <cntx:content><![CDATA[import js from '@eslint/js'\nimport globals from 'globals'\nimport reactHooks from 'eslint-plugin-react-hooks'\nimport reactRefresh from 'eslint-plugin-react-refresh'\nimport tseslint from 'typescript-eslint'\n\nexport default tseslint.config(\n  { ignores: ['dist'] },\n  {\n    extends: [js.configs.recommended, ...tseslint.configs.recommended],\n    files: ['**/*.{ts,tsx}'],\n    languageOptions: {\n      ecmaVersion: 2020,\n      globals: globals.browser,\n    },\n    plugins: {\n      'react-hooks': reactHooks,\n      'react-refresh': reactRefresh,\n    },\n    rules: {\n      ...reactHooks.configs.recommended.rules,\n      'react-refresh/only-export-components': [\n        'warn',\n        { allowConstantExport: true },\n      ],\n    },\n  },\n)\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/package.json\" ext=\".json\">\n      <cntx:meta size=\"1138\" modified=\"2025-06-07T01:37:11.847Z\" />\n      <cntx:content><![CDATA[{\n  \"name\": \"web\",\n  \"private\": true,\n  \"version\": \"0.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc -b && vite build\",\n    \"lint\": \"eslint .\",\n    \"preview\": \"vite preview\"\n  },\n  \"dependencies\": {\n    \"@radix-ui/react-label\": \"^2.1.7\",\n    \"@radix-ui/react-slot\": \"^1.2.3\",\n    \"@radix-ui/react-tabs\": \"^1.1.12\",\n    \"@tailwindcss/vite\": \"^4.1.8\",\n    \"@tanstack/react-query\": \"^5.80.6\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"lucide-react\": \"^0.513.0\",\n    \"next-themes\": \"^0.4.6\",\n    \"react\": \"^19.1.0\",\n    \"react-dom\": \"^19.1.0\",\n    \"sonner\": \"^2.0.5\",\n    \"tailwind-merge\": \"^3.3.0\",\n    \"tailwindcss\": \"^4.1.8\"\n  },\n  \"devDependencies\": {\n    \"@eslint/js\": \"^9.25.0\",\n    \"@types/node\": \"^22.15.30\",\n    \"@types/react\": \"^19.1.2\",\n    \"@types/react-dom\": \"^19.1.2\",\n    \"@vitejs/plugin-react\": \"^4.4.1\",\n    \"eslint\": \"^9.25.0\",\n    \"eslint-plugin-react-hooks\": \"^5.2.0\",\n    \"eslint-plugin-react-refresh\": \"^0.4.19\",\n    \"globals\": \"^16.0.0\",\n    \"tw-animate-css\": \"^1.3.4\",\n    \"typescript\": \"~5.8.3\",\n    \"typescript-eslint\": \"^8.30.1\",\n    \"vite\": \"^6.3.5\"\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.app.json\" ext=\".json\">\n      <cntx:meta size=\"753\" modified=\"2025-06-06T22:58:44.187Z\" />\n      <cntx:content><![CDATA[{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\n        \"./src/*\"\n      ]\n    },\n    \"tsBuildInfoFile\": \"./node_modules/.tmp/tsconfig.app.tsbuildinfo\",\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"verbatimModuleSyntax\": true,\n    \"moduleDetection\": \"force\",\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"noUncheckedSideEffectImports\": true\n  },\n  \"include\": [\"src\"]\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.json\" ext=\".json\">\n      <cntx:meta size=\"214\" modified=\"2025-06-06T22:58:20.358Z\" />\n      <cntx:content><![CDATA[{\n  \"files\": [],\n  \"references\": [\n    { \"path\": \"./tsconfig.app.json\" },\n    { \"path\": \"./tsconfig.node.json\" }\n  ],\n   \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  }\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/tsconfig.node.json\" ext=\".json\">\n      <cntx:meta size=\"598\" modified=\"2025-06-07T02:03:31.047Z\" />\n      <cntx:content><![CDATA[{\n  \"compilerOptions\": {\n    \"tsBuildInfoFile\": \"./node_modules/.tmp/tsconfig.node.tsbuildinfo\",\n    \"target\": \"ES2022\",\n    \"lib\": [\"ES2023\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"verbatimModuleSyntax\": true,\n    \"moduleDetection\": \"force\",\n    \"noEmit\": true,\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"noUncheckedSideEffectImports\": true\n  },\n  \"include\": [\"vite.config.ts\"]\n}\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/vite.config.ts\" ext=\".ts\">\n      <cntx:meta size=\"833\" modified=\"2025-06-07T02:03:25.557Z\" />\n      <cntx:content><![CDATA[import path from 'path'\nimport tailwindcss from '@tailwindcss/vite'\nimport react from '@vitejs/plugin-react'\nimport { defineConfig } from 'vite'\n\n// https://vite.dev/config/\nexport default defineConfig({\n  plugins: [react(), tailwindcss()],\n  base: './', // Important: Use relative paths for serving from any location\n  build: {\n    outDir: 'dist',\n    assetsDir: 'assets',\n    sourcemap: false, // Reduce bundle size\n    rollupOptions: {\n      output: {\n        manualChunks: undefined, // Keep everything in one chunk for simplicity\n      },\n    },\n  },\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5173,\n    proxy: {\n      // Proxy API calls during development\n      '/api': {\n        target: 'http://localhost:3333',\n        changeOrigin: true,\n      },\n    },\n  },\n})\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.705Z",
    "size": 7602
  },
  "docs": {
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<cntx:bundle xmlns:cntx=\"https://cntx.dev/schema\" name=\"docs\" generated=\"2025-06-18T12:10:52.708Z\">\n  <cntx:project>\n    <cntx:name>cntx-ui</cntx:name>\n    <cntx:version>2.0.3</cntx:version>\n    <cntx:description>Minimal file bundling and tagging tool for AI development</cntx:description>\n  </cntx:project>\n  <cntx:files count=\"2\">\n    <cntx:file path=\"README.md\" ext=\".md\">\n      <cntx:meta size=\"4970\" modified=\"2025-06-18T11:45:07.370Z\" />\n      <cntx:content><![CDATA[# cntx-ui\n\nMinimal file bundling and tagging tool for AI development with web interface.\n\n## Features\n\n- File bundling and organization for AI development workflows\n- Web-based UI for managing bundles and configurations\n- Hidden files management\n- Cursor rules integration\n- WebSocket-based real-time updates\n- CLI tools for automation\n\n## Installation\n\n### Global Installation (Recommended)\n\n```bash\nnpm install -g cntx-ui\n```\n\n### Local Development Installation\n\n```bash\ngit clone https://github.com/nothingdao/cntx-ui.git\ncd cntx-ui\nnpm install\n```\n\n## Usage\n\n### Initialize a Project\n\n```bash\n# Initialize cntx-ui in your project\ncntx-ui init\n\n# Start the web interface\ncntx-ui watch\n\n# Visit http://localhost:3333 to access the web UI\n```\n\n### CLI Commands\n\n```bash\n# Generate bundles\ncntx-ui bundle <name>\n\n# Check project status\ncntx-ui status\n\n# Start web server on custom port\ncntx-ui watch [port]\n```\n\n## Development\n\n### Prerequisites\n\n- Node.js >= 18.0.0\n- npm\n\n### Setup Development Environment\n\n1. **Clone and install dependencies:**\n   ```bash\n   git clone https://github.com/nothingdao/cntx-ui.git\n   cd cntx-ui\n   npm install\n   ```\n\n2. **Install web dependencies:**\n   ```bash\n   cd web\n   npm install\n   cd ..\n   ```\n\n### Development Workflow\n\n#### Running in Development Mode\n\n1. **Start the backend server:**\n   ```bash\n   npm run dev\n   ```\n\n2. **Start the frontend development server:**\n   ```bash\n   npm run dev:web\n   ```\n   \n   The web interface will be available at `http://localhost:5173` (Vite dev server)\n\n#### Building the Project\n\n1. **Build web interface only:**\n   ```bash\n   npm run build:web\n   ```\n\n2. **Build entire project:**\n   ```bash\n   npm run build\n   ```\n\n3. **Automated build with validation:**\n   ```bash\n   ./build.sh\n   ```\n\n### Project Structure\n\n```\ncntx-ui/\n├── bin/                    # CLI executable\n├── web/                    # React frontend\n│   ├── src/\n│   │   ├── components/     # React components\n│   │   ├── hooks/          # Custom hooks\n│   │   ├── utils/          # Utility functions\n│   │   └── lib/            # Libraries and configurations\n│   ├── dist/               # Built frontend (generated)\n│   └── package.json        # Frontend dependencies\n├── server.js               # WebSocket server\n├── package.json            # Main package configuration\n├── build.sh                # Build automation script\n└── test-local.sh           # Local testing script\n```\n\n### Available Scripts\n\n| Script | Description |\n|--------|-------------|\n| `npm run dev` | Start backend server |\n| `npm run dev:web` | Start frontend dev server |\n| `npm run build` | Build entire project |\n| `npm run build:web` | Build frontend only |\n| `npm test:local` | Install and test package locally |\n\n## Testing\n\n### Local Testing\n\n1. **Run automated test suite:**\n   ```bash\n   ./test-local.sh\n   ```\n\n2. **Manual testing:**\n   ```bash\n   # Build and pack\n   npm run build\n   npm pack\n   \n   # Install globally for testing\n   npm install -g ./cntx-ui-*.tgz\n   \n   # Test in a new project\n   mkdir test-project && cd test-project\n   cntx-ui init\n   cntx-ui watch\n   ```\n\n### Test Coverage\n\nThe test suite covers:\n- Project initialization\n- Bundle generation\n- Web server functionality\n- API endpoints\n- File management operations\n\n## Publishing\n\n### Prerequisites for Publishing\n\n- npm account with publish permissions\n- Clean git working directory\n- All tests passing\n\n### Publishing Steps\n\n1. **Update version:**\n   ```bash\n   npm version patch  # or minor/major\n   ```\n\n2. **Build and validate:**\n   ```bash\n   ./build.sh\n   ```\n\n3. **Test locally:**\n   ```bash\n   ./test-local.sh\n   ```\n\n4. **Publish to npm:**\n   ```bash\n   # Stable release\n   npm publish\n   \n   # Beta release\n   npm publish --tag beta\n   ```\n\n### Automated Publishing Workflow\n\nUse the build script for a complete workflow:\n\n```bash\n./build.sh\n# Follow prompts for local testing\n# If tests pass, run: npm publish\n```\n\n## Configuration\n\n### Environment Variables\n\n- `PORT` - Override default server port (default: 3333)\n- `NODE_ENV` - Set environment (development/production)\n\n### Project Configuration\n\ncntx-ui creates these files in your project:\n- `.cntx/config.json` - Main configuration\n- `.cntxignore` - Files to ignore\n- `.cursorrules` - Cursor editor rules\n\n## Contributing\n\n1. Fork the repository\n2. Create a feature branch\n3. Make changes following the existing code style\n4. Run tests: `./test-local.sh`\n5. Submit a pull request\n\n## Technology Stack\n\n- **Backend:** Node.js, WebSocket (ws)\n- **Frontend:** React 19, TypeScript, Vite\n- **UI:** Tailwind CSS, Radix UI\n- **State Management:** TanStack Query\n- **Build Tools:** Vite, TypeScript compiler\n\n## License\n\nMIT\n\n## Support\n\n- GitHub Issues: [Report bugs or request features](https://github.com/nothingdao/cntx-ui/issues)\n- Documentation: Check the web interface for detailed usage guides\n]]></cntx:content>\n    </cntx:file>\n    <cntx:file path=\"web/README.md\" ext=\".md\">\n      <cntx:meta size=\"1942\" modified=\"2025-06-06T22:55:53.329Z\" />\n      <cntx:content><![CDATA[# React + TypeScript + Vite\n\nThis template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.\n\nCurrently, two official plugins are available:\n\n- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) for Fast Refresh\n- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh\n\n## Expanding the ESLint configuration\n\nIf you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:\n\n```js\nexport default tseslint.config({\n  extends: [\n    // Remove ...tseslint.configs.recommended and replace with this\n    ...tseslint.configs.recommendedTypeChecked,\n    // Alternatively, use this for stricter rules\n    ...tseslint.configs.strictTypeChecked,\n    // Optionally, add this for stylistic rules\n    ...tseslint.configs.stylisticTypeChecked,\n  ],\n  languageOptions: {\n    // other options...\n    parserOptions: {\n      project: ['./tsconfig.node.json', './tsconfig.app.json'],\n      tsconfigRootDir: import.meta.dirname,\n    },\n  },\n})\n```\n\nYou can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:\n\n```js\n// eslint.config.js\nimport reactX from 'eslint-plugin-react-x'\nimport reactDom from 'eslint-plugin-react-dom'\n\nexport default tseslint.config({\n  plugins: {\n    // Add the react-x and react-dom plugins\n    'react-x': reactX,\n    'react-dom': reactDom,\n  },\n  rules: {\n    // other rules...\n    // Enable its recommended typescript rules\n    ...reactX.configs['recommended-typescript'].rules,\n    ...reactDom.configs.recommended.rules,\n  },\n})\n```\n]]></cntx:content>\n    </cntx:file>\n  </cntx:files>\n</cntx:bundle>",
    "lastGenerated": "2025-06-18T12:10:52.709Z",
    "size": 7670
  }
}